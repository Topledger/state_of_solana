"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1093,3055],{43055:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var a=n(95155),r=n(12115),l=n(79111),i=n(45191),o=n(4904),s=n(71734),c=n(41995),u=n(72630),d=n(58888),h=n(50109),f=n(51078),m=n(7545),g=n(81838),p=n(52594),x=n(96565),b=n(42028),v=n(51093);let k=e=>{let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},y=e=>{let{isModalOpen:t=!1,onModalClose:n=()=>{},legendsChanged:y}=e,[S,j]=(0,r.useState)([]),[w,D]=(0,r.useState)([]),[_,N]=(0,r.useState)([]),[L,A]=(0,r.useState)(!0),[M,C]=(0,r.useState)(null),[U,O]=(0,r.useState)([]),E=(0,r.useRef)(null),F=(0,r.useRef)(null),[T,I]=(0,r.useState)(!1),[Y,B]=(0,r.useState)(null),[P,R]=(0,r.useState)(!1),[W,G]=(0,r.useState)(null),[q,z]=(0,r.useState)({visible:!1,date:"",items:[],left:0,top:0}),$=(0,r.useCallback)(e=>Object.values(e.reduce((e,t)=>(e[t.block_date]||(e[t.block_date]={block_date:t.block_date,date:t.date||new Date(t.block_date)}),e[t.block_date][t.mint_name]=t.token_supply,e),{})).sort((e,t)=>new Date(e.block_date).getTime()-new Date(t.block_date).getTime()),[]),V=(0,r.useCallback)(async()=>{A(!0),C(null);try{let e=await (0,v.fetchStablecoinUsageData)();if(0===e.length)C("No data available for stablecoin usage."),j([]),D([]),N([]),O([]);else{let t=e.map(e=>({...e,date:new Date(e.block_date)})),n={};t.forEach(e=>{n[e.mint_name]||(n[e.mint_name]=0),n[e.mint_name]+=e.token_supply});let a=Object.entries(n).sort((e,t)=>t[1]-e[1]).map(e=>{let[t]=e;return t});O(a),j(t);let r=$(t);if(D(r),N(r),I(!0),B(null),y){let e=a.map(e=>({label:e,color:(0,v.Gy)(e),value:n[e]}));y(e)}}}catch(e){C(e instanceof Error?e.message:"Failed to load data."),j([]),D([]),N([]),O([])}finally{A(!1)}},[y,$]);(0,r.useEffect)(()=>{V()},[V]),(0,r.useEffect)(()=>{if(0===w.length){_.length>0&&N([]);return}if(!Y&&T)return void N(w);if(!Y||!T){_.length!==w.length&&N(w);return}let[e,t]=Y,n=w.filter(n=>{let a=n.date instanceof Date?n.date:new Date(n.block_date);return a>=e&&a<=t});N(n.length>0?n:w)},[Y,w,T,_.length]),(0,r.useEffect)(()=>{t&&(G(Y),R(T))},[t,Y,T]);let J=(0,r.useCallback)(e=>{if(!e||0===w.length)return w;let[t,n]=e,a=w.filter(e=>{let a=e.date instanceof Date?e.date:new Date(e.block_date);return a>=t&&a<=n});return a.length>0?a:w},[w]),Q=(0,r.useCallback)(function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=null==(t=(n?F:E).current)?void 0:t.getBoundingClientRect();if(!a)return;let r=e.clientX-a.left,l=n?P:T,i=n?W:Y,o=l?n?J(i):_:w;if(0===o.length)return;let s={right:20,left:90},c=(a.width-s.left-s.right)/o.length,u=Math.floor((r-s.left)/c);if(u<0||u>=o.length){q.visible&&z(e=>({...e,visible:!1}));return}let d=o[u];if(!q.visible||q.date!==d.block_date){let t=U.filter(e=>d[e]>0).map(e=>({mintName:e,value:d[e],color:(0,v.Gy)(e)})).sort((e,t)=>t.value-e.value);z({visible:!0,date:d.block_date,items:t,left:r,top:e.clientY-a.top})}},[w,_,T,q.visible,q.date,U,P,W,Y,J]),Z=(0,r.useCallback)(()=>{q.visible&&z(e=>({...e,visible:!1}))},[q.visible]),H=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),K=(0,r.useCallback)(e=>{if(!e){T&&(B(null),I(!1));return}let{x0:t,x1:n}=e;B([new Date(t),new Date(n)]),T||I(!0)},[T]),X=(0,r.useCallback)(e=>{if(!e){P&&(G(null),R(!1));return}let{x0:t,x1:n}=e;G([new Date(t),new Date(n)]),P||R(!0)},[P]),ee=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(L)return(0,a.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,a.jsx)(f.A,{size:"sm"})});if(M||0===w.length)return(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,a.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:M||"No data available"}),(0,a.jsx)(m.A,{onClick:V,children:(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(k,{className:"w-3.5 h-3.5"}),(0,a.jsx)("span",{children:"Refresh"})]})})]});let r=n?W:Y,p=n?P:T;return(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[q.visible&&q.items.length>0&&(0,a.jsx)(g.A,{title:H(q.date),items:q.items.map(e=>({color:e.color,label:e.mintName,value:(0,v.vv)(e.value),shape:"square"})),top:q.top,left:q.left,isModal:n}),(0,a.jsx)("div",{className:"h-[85%] w-full overflow-hidden relative",ref:n?F:E,onMouseMove:e=>Q(e,n),onMouseLeave:Z,children:(0,a.jsx)(l.A,{children:e=>{let{width:t,height:l}=e;if(t<=0||l<=0)return null;let f={top:10,right:20,bottom:50,left:90},m=t-f.left-f.right,g=l-f.top-f.bottom;if(m<=0||g<=0)return null;let x=p?n?J(r):_:w,b=(0,i.A)({domain:x.map(e=>e.block_date),range:[0,m],padding:.2}),k=(()=>{let e=m<500?5:10;if(x.length<=e)return x.map(e=>e.block_date);{let t=Math.ceil(x.length/(e-1));return x.filter((e,n)=>n%t==0||n===x.length-1).map(e=>e.block_date)}})(),y=Math.max(...x.map(e=>U.reduce((t,n)=>t+(e[n]||0),0))),S=(0,o.A)({domain:[0,1.1*y],range:[g,0],nice:!0}),j=b.bandwidth();return(0,a.jsx)("svg",{width:t,height:l,children:(0,a.jsxs)(c.A,{left:f.left,top:f.top,children:[(0,a.jsx)(h.A,{scale:S,width:m,stroke:"#1f2937",strokeOpacity:.5,strokeDasharray:"2,3"}),x.map((e,t)=>{let n=b(e.block_date)||0,r=g,l=[];return U.filter(t=>e[t]>0).sort((t,n)=>e[t]-e[n]).forEach(i=>{let o=g-S(e[i]||0);r-=o,l.push((0,a.jsx)(s.A,{x:n,y:r,width:j,height:o,fill:(0,v.Gy)(i),opacity:q.date===e.block_date?1:.8,rx:2},"bar-".concat(t,"-").concat(i)))}),(0,a.jsx)(c.A,{children:l},"date-".concat(t))}),(0,a.jsx)(u.A,{top:g,scale:b,stroke:"#374151",strokeWidth:.5,tickStroke:"transparent",hideAxisLine:!1,tickLength:0,tickValues:k,tickLabelProps:()=>({fill:"#6b7280",fontSize:11,fontWeight:300,textAnchor:"middle",dy:"0.5em"}),tickFormat:e=>new Date(e).toLocaleDateString("en-US",{month:"numeric",day:"numeric"})}),(0,a.jsx)(d.A,{scale:S,stroke:"#374151",strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,numTicks:5,tickFormat:e=>(0,v.vv)(e),tickLabelProps:()=>({fill:"#6b7280",fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"end",dy:"0.33em",dx:"-0.5em"})})]})})}})}),(0,a.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,a.jsx)(l.A,{children:e=>{let{width:t,height:r}=e;return t<=0||r<=0?null:(0,a.jsx)(b.A,{data:S,isModal:n,activeBrushDomain:n?W:Y,onBrushChange:n?X:K,onClearBrush:()=>{n?(G(null),R(!1)):(B(null),I(!1))},getDate:e=>e.date?e.date.toISOString():e.block_date,getValue:e=>e.token_supply,lineColor:"#2775ca",margin:{top:5,right:20,bottom:10,left:90}})}})})]})};return(0,a.jsxs)("div",{className:"h-full w-full relative",children:[ee(0,0),(0,a.jsx)(p.A,{isOpen:t,onClose:n,title:"Stablecoin Supply",subtitle:"Token supply of stablecoins on Solana over time",children:(0,a.jsx)("div",{className:"h-[70vh]",children:(0,a.jsxs)("div",{className:"flex h-full",children:[(0,a.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:ee(0,0,!0)}),(0,a.jsxs)("div",{className:"w-[10%] h-full pl-3 flex flex-col justify-start items-start",children:[(0,a.jsx)("div",{className:"text-[10px] text-gray-400 mb-2",children:"STABLECOINS"}),L?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{label:"Loading...",color:"#2775ca",isLoading:!0}),(0,a.jsx)(x.A,{label:"Loading...",color:"#26a17b",isLoading:!0}),(0,a.jsx)(x.A,{label:"Loading...",color:"#fa7a35",isLoading:!0})]}):(0,a.jsx)("div",{className:"flex flex-col gap-1 overflow-y-auto max-h-[500px] pr-1",children:U.map(e=>{let t=S.filter(t=>t.mint_name===e).reduce((e,t)=>Math.max(e,t.token_supply),0);return(0,a.jsx)(x.A,{label:e,color:(0,v.Gy)(e),shape:"square",tooltipText:(0,v.vv)(t)},e)})})]})]})})})]})}},45191:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(28749),r=n(95442),l=(0,n(70222).A)("domain","range","reverse","align","padding","round");function i(e){return l(function e(){var t,n,l=(0,r.A)().unknown(void 0),i=l.domain,o=l.range,s=0,c=1,u=!1,d=0,h=0,f=.5;function m(){var e=i().length,a=c<s,r=a?c:s,l=a?s:c;t=(l-r)/Math.max(1,e-d+2*h),u&&(t=Math.floor(t)),r+=(l-r-t*(e-d))*f,n=t*(1-d),u&&(r=Math.round(r),n=Math.round(n));var m=(function(e,t,n){e*=1,t*=1,n=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+n;for(var a=-1,r=0|Math.max(0,Math.ceil((t-e)/n)),l=Array(r);++a<r;)l[a]=e+a*n;return l})(e).map(function(e){return r+t*e});return o(a?m.reverse():m)}return delete l.unknown,l.domain=function(e){return arguments.length?(i(e),m()):i()},l.range=function(e){return arguments.length?([s,c]=e,s*=1,c*=1,m()):[s,c]},l.rangeRound=function(e){return[s,c]=e,s*=1,c*=1,u=!0,m()},l.bandwidth=function(){return n},l.step=function(){return t},l.round=function(e){return arguments.length?(u=!!e,m()):u},l.padding=function(e){return arguments.length?(d=Math.min(1,h=+e),m()):d},l.paddingInner=function(e){return arguments.length?(d=Math.min(1,e),m()):d},l.paddingOuter=function(e){return arguments.length?(h=+e,m()):h},l.align=function(e){return arguments.length?(f=Math.max(0,Math.min(1,e)),m()):f},l.copy=function(){return e(i(),[s,c]).round(u).paddingInner(d).paddingOuter(h).align(f)},a.C.apply(m(),arguments)}(),e)}},51093:(e,t,n)=>{n.d(t,{Gy:()=>r,ZV:()=>i,fetchStablecoinUsageData:()=>o,vv:()=>l});let a={USDC:"#2775ca",USDT:"#26a17b",PYUSD:"#fa7a35",USDe:"#1c94f4",FDUSD:"#01964c",USDY:"#8a5fb9",USDS:"#f7b84b",EURC:"#0066cf",sUSD:"#1e1e1e",EUROe:"#0d47a1",AUSD:"#c78f42",USDG:"#5a5a5a",default:"#6b7280"},r=e=>a[e]||a.default,l=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(e),i=e=>new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(e);async function o(){try{var e,t;let n=await fetch("https://analytics.topledger.xyz/tl/api/queries/12781/results.json?api_key=i1EMrmekV6vqSiyxWx3o8ncTbKqEIBBJ6Me3mwRu",{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(!n.ok)throw Error("API request failed with status ".concat(n.status));let a=await n.json();if(!(null==a||null==(t=a.query_result)||null==(e=t.data)?void 0:e.rows))throw Error("Invalid data structure received from API");return a.query_result.data.rows.map(e=>({block_date:e.block_date,mint:e.mint,holders:parseInt(e.holders)||0,token_supply:parseFloat(e.token_supply)||0,mint_name:e.mint_name})).sort((e,t)=>new Date(e.block_date).getTime()-new Date(t.block_date).getTime())}catch(e){throw console.error("Error fetching stablecoin usage data:",e),Error("Failed to fetch stablecoin usage data")}}},81838:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(95155);n(12115);let r=e=>{let{type:t,color:n}=e;return"circle"===t?(0,a.jsx)("div",{className:"h-2 w-2 rounded-full mr-1.5",style:{backgroundColor:n}}):(0,a.jsx)("div",{className:"h-2 w-2 rounded-sm mr-1.5",style:{backgroundColor:n}})},l=(e,t)=>{if(/^\d{4}-\d{2}-\d{2}/.test(e)||/^\d{2}\/\d{2}\/\d{4}/.test(e)){let n=new Date(e);if(!isNaN(n.getTime())){if("W"===t)return"Week of ".concat(n.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"}));if("M"===t)return n.toLocaleDateString("en-US",{month:"short",year:"numeric"});if("Q"===t){let e=Math.floor(n.getMonth()/3)+1;return"Q".concat(e,", ").concat(n.getFullYear())}else if("Y"===t)return n.getFullYear().toString();return n.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})}}return/^[A-Za-z]{3}\s\d{4}$/.test(e)||/^Q[1-4]\s\d{4}$/.test(e)||/^\d{4}$/.test(e),e},i=(e,t)=>{if("string"==typeof e){if(t){let n={USD:"$",EUR:"€",GBP:"\xa3",JPY:"\xa5",CNY:"\xa5",SOL:"SOL"},a=n[t]||t;if("SOL"===t){if(e.includes("SOL"))return e;for(let[t,a]of Object.entries(n))if("SOL"!==t&&e.startsWith(a))return"".concat(e.substring(a.length)," SOL");return"".concat(e," SOL")}for(let[r,l]of Object.entries(n))if(e.startsWith(l)&&r!==t)return e.replace(l,a)}return e}if("number"==typeof e){if(t)switch(t){case"USD":return"$".concat(e.toLocaleString());case"EUR":return"€".concat(e.toLocaleString());case"GBP":return"\xa3".concat(e.toLocaleString());case"JPY":case"CNY":return"\xa5".concat(e.toLocaleString());case"SOL":return"".concat(e.toLocaleString()," SOL");default:return"".concat(t).concat(e.toLocaleString())}return e.toLocaleString()}return String(e)},o=e=>{let{title:t,items:n,top:o,left:s,isModal:c=!1,timeFilter:u,currencyFilter:d}=e,h=n.some(e=>e.axis),f=l(t,u);return(0,a.jsxs)("div",{className:"absolute z-10 pointer-events-none bg-gray-900/95 shadow-lg border border-gray-800 rounded-md p-2 text-xs min-w-[120px]",style:{top:"".concat(o,"px"),left:s>(c?500:250)?"".concat(s-160,"px"):"".concat(s+10,"px"),transform:"translateY(-100%)"},children:[(0,a.jsx)("div",{className:"text-gray-400 text-[10px] font-normal pb-1 mb-1 border-b border-gray-800",children:f}),(0,a.jsx)("div",{className:"space-y-1",children:n.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,a.jsx)(r,{type:e.shape||"circle",color:e.color}),(0,a.jsx)("span",{className:"text-gray-400 font-normal ml-2",children:e.label}),h&&e.axis&&(0,a.jsxs)("span",{className:"ml-1 text-[9px] text-gray-500",children:["(",e.axis," axis)"]})]}),(0,a.jsx)("span",{className:"text-gray-300 font-normal ml-4",children:i(e.value,d)})]},"tooltip-item-".concat(t)))})]})}},95442:(e,t,n)=>{n.d(t,{A:()=>function e(){var t=new a,n=[],r=[],l=o;function s(e){let a=t.get(e);if(void 0===a){if(l!==o)return l;t.set(e,a=n.push(e)-1)}return r[a%r.length]}return s.domain=function(e){if(!arguments.length)return n.slice();for(let r of(n=[],t=new a,e))t.has(r)||t.set(r,n.push(r)-1);return s},s.range=function(e){return arguments.length?(r=Array.from(e),s):r.slice()},s.unknown=function(e){return arguments.length?(l=e,s):l},s.copy=function(){return e(n,r).unknown(l)},i.C.apply(s,arguments),s}});class a extends Map{constructor(e,t=l){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(let[t,n]of e)this.set(t,n)}get(e){return super.get(r(this,e))}has(e){return super.has(r(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},n){let a=t(n);return e.has(a)?e.get(a):(e.set(a,n),n)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},n){let a=t(n);return e.has(a)&&(n=e.get(a),e.delete(a)),n}(this,e))}}function r({_intern:e,_key:t},n){let a=t(n);return e.has(a)?e.get(a):n}function l(e){return null!==e&&"object"==typeof e?e.valueOf():e}var i=n(28749);let o=Symbol("implicit")}}]);