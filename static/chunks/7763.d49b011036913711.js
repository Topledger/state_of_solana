"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3679,7763,8483],{27763:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var l=a(95155),r=a(12115),n=a(79111),i=a(30832),s=a(4904),o=a(76167),c=a(13600),m=a(41995),u=a(72630),d=a(58888),f=a(50109),h=a(43356),p=a(51078),x=a(7545),g=a(52594),b=a(96565),v=a(42028),y=a(58483),N=a(60194),j=a(59722);let k=e=>{let{className:t="w-4 h-4"}=e;return(0,l.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},_=e=>{let{isModalOpen:t=!1,onModalClose:a=()=>{},legendsChanged:_}=e,[S,w]=(0,r.useState)([]),[D,A]=(0,r.useState)([]),[C,L]=(0,r.useState)([]),[U,V]=(0,r.useState)(!0),[T,E]=(0,r.useState)(null),[F,G]=(0,r.useState)([]),[M,z]=(0,r.useState)(null),[P,O]=(0,r.useState)(null),[W,B]=(0,r.useState)(null),q=(0,r.useRef)(null),I=(0,r.useRef)(null),[R,H]=(0,r.useState)(!1),[Y,Z]=(0,r.useState)(null),[X,J]=(0,r.useState)(!1),[K,Q]=(0,r.useState)(null),$=(0,r.useCallback)(e=>e.map(e=>({date:e.date||new Date(e.month),mintName:e.mint_name,p2pVelocity:e.p2p_velocity})).filter(e=>e.p2pVelocity>0&&!isNaN(e.p2pVelocity)),[]),ee=(0,r.useCallback)(async()=>{V(!0),E(null);try{let e=await (0,y.fetchLiquidityVelocityData)();if(0===e.length)E("No data available for stablecoin P2P velocity."),w([]),A([]),L([]),G([]);else{let t={};e.forEach(e=>{e.p2p_velocity>0&&!isNaN(e.p2p_velocity)&&(t[e.mint_name]||(t[e.mint_name]={total:0,count:0}),t[e.mint_name].total+=e.p2p_velocity,t[e.mint_name].count+=1)});let a=Object.entries(t).map(e=>{let[t,a]=e;return{mint:t,average:a.total/a.count}}),l=a.sort((e,t)=>t.average-e.average).map(e=>e.mint);G(l),w(e);let r=$(e);if(A(r),L(r),H(!1),Z(null),_){let e=l.map(e=>{var t;let l=(null==(t=a.find(t=>t.mint===e))?void 0:t.average)||0;return{label:e,color:(0,y.G)(e),value:l}});_(e)}}}catch(e){E(e instanceof Error?e.message:"Failed to load data."),w([]),A([]),L([]),G([])}finally{V(!1)}},[_,$]);(0,r.useEffect)(()=>{ee()},[ee]),(0,r.useEffect)(()=>{if(0===D.length){C.length>0&&L([]);return}if(!Y&&R)return void L(D);if(!Y||!R){C.length!==D.length&&L(D);return}let[e,t]=Y,a=D.filter(a=>a.date>=e&&a.date<=t);L(a.length>0?a:D)},[Y,D,R,C.length]),(0,r.useEffect)(()=>{t&&(Q(Y),J(R))},[t,Y,R]);let et=(0,r.useCallback)(e=>{if(!e||0===D.length)return D;let[t,a]=e,l=D.filter(e=>e.date>=t&&e.date<=a);return l.length>0?l:D},[D]),ea=(0,r.useCallback)(e=>{if(!e){R&&(Z(null),H(!1));return}let{x0:t,x1:a}=e;Z([new Date(t),new Date(a)]),R||H(!0)},[R]),el=(0,r.useCallback)(e=>{if(!e){X&&(Q(null),J(!1));return}let{x0:t,x1:a}=e;Q([new Date(t),new Date(a)]),X||J(!0)},[X]),er=(0,r.useCallback)((e,t,a,l,r)=>{let{x:n}=(0,j.A)(e)||{x:0},i=a.invert(n-r.left),s=null,o=1/0;if(t.forEach(e=>{let t=Math.abs(e.date.getTime()-i.getTime());t<o&&(o=t,s=e,e.mintName)}),s){let n=t.filter(e=>e.date.getTime()===s.date.getTime()),{y:i}=(0,j.A)(e)||{y:0},o=n.reduce((e,t)=>{let a=Math.abs(l(t.p2pVelocity)+r.top-i);return a<e.distance?{distance:a,point:t}:e},{distance:1/0,point:n[0]}).point||s;z({date:o.date,mintName:o.mintName,p2pVelocity:o.p2pVelocity,color:(0,y.G)(o.mintName)}),O(a(o.date)+r.left),B(l(o.p2pVelocity)+r.top)}else z(null),O(null),B(null)},[]),en=e=>e.toLocaleDateString("en-US",{month:"short",year:"numeric"}),ei=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(U)return(0,l.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,l.jsx)(p.A,{size:"sm"})});if(T||0===D.length)return(0,l.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,l.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:T||"No data available"}),(0,l.jsx)(x.A,{onClick:ee,children:(0,l.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,l.jsx)(k,{className:"w-3.5 h-3.5"}),(0,l.jsx)("span",{children:"Refresh"})]})})]});let r=a?K:Y,g=a?X:R;return(0,l.jsxs)("div",{className:"flex flex-col h-full",children:[(0,l.jsx)("div",{className:"h-[85%] w-full overflow-hidden relative",ref:a?I:q,children:(0,l.jsx)(n.A,{children:e=>{let{width:t,height:n}=e;if(t<=0||n<=0)return null;let p={top:10,right:20,bottom:50,left:80},x=t-p.left-p.right,b=n-p.top-p.bottom;if(x<=0||b<=0)return null;let v=g?a?et(r):C:D;if(0===v.length)return(0,l.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,l.jsx)("div",{className:"text-gray-400/80 text-xs",children:"No data available for the selected time range"})});let j=(0,N.A)(v,e=>e.date),k=(0,i.A)({domain:j,range:[0,x]}),_=Math.max(...v.map(e=>e.p2pVelocity)),S=(0,s.A)({domain:[0,1.1*_],range:[b,0],nice:!0}),w=F.reduce((e,t)=>{let a=v.filter(e=>e.mintName===t);return a.length>0&&(e[t]=a.sort((e,t)=>e.date.getTime()-t.date.getTime())),e},{});return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("svg",{width:t,height:n,children:(0,l.jsxs)(m.A,{left:p.left,top:p.top,children:[(0,l.jsx)(f.A,{scale:S,width:x,stroke:"#1f2937",strokeOpacity:.5,strokeDasharray:"2,3"}),Object.entries(w).map(e=>{let[t,a]=e;return(0,l.jsx)(c.A,{data:a,x:e=>k(e.date),y:e=>S(e.p2pVelocity),stroke:(0,y.G)(t),strokeWidth:2.5,strokeOpacity:.8,curve:o.G},"line-".concat(t))}),(0,l.jsx)(u.A,{top:b,scale:k,stroke:"#374151",strokeWidth:.5,tickStroke:"transparent",hideAxisLine:!1,tickLength:0,numTicks:t<500?5:10,tickLabelProps:()=>({fill:"#6b7280",fontSize:11,fontWeight:300,textAnchor:"middle",dy:"0.5em"}),tickFormat:e=>e.toLocaleDateString("en-US",{month:"numeric",year:"2-digit"})}),(0,l.jsx)(d.A,{scale:S,stroke:"#374151",strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,numTicks:5,tickFormat:e=>(0,y.formatNumber)(e),tickLabelProps:()=>({fill:"#6b7280",fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"end",dy:"0.33em",dx:"-0.5em"})}),(0,l.jsx)("rect",{width:x,height:b,fill:"transparent",onMouseMove:e=>er(e,v,k,S,p),onMouseLeave:()=>{z(null),O(null),B(null)}})]})}),M&&null!=P&&null!=W&&(0,l.jsxs)(h.A,{left:P,top:W,style:{...h.k,backgroundColor:"#1f2937",color:"white",border:"1px solid #374151",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06)"},children:[(0,l.jsx)("div",{className:"text-xs font-medium mb-1",children:en(M.date)}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:M.color}}),(0,l.jsx)("div",{className:"text-xs",children:M.mintName}),(0,l.jsx)("div",{className:"text-xs font-medium",children:(0,y.formatNumber)(M.p2pVelocity)})]})]})]})}})}),(0,l.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,l.jsx)(n.A,{children:e=>{let{width:t,height:r}=e;return t<=0||r<=0?null:(0,l.jsx)(v.A,{data:D,isModal:a,activeBrushDomain:a?K:Y,onBrushChange:a?el:ea,onClearBrush:()=>{a?(Q(null),J(!1)):(Z(null),H(!1))},getDate:e=>e.date.toISOString(),getValue:e=>e.p2pVelocity,lineColor:"#2775ca",margin:{top:5,right:20,bottom:10,left:80}})}})})]})};return(0,l.jsxs)("div",{className:"h-full w-full relative",children:[ei(0,0),(0,l.jsx)(g.A,{isOpen:t,onClose:a,title:"Stablecoin P2P Velocity",subtitle:"Monthly peer-to-peer velocity indicators of stablecoins on Solana",children:(0,l.jsx)("div",{className:"h-[70vh]",children:(0,l.jsxs)("div",{className:"flex h-full",children:[(0,l.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:ei(0,0,!0)}),(0,l.jsxs)("div",{className:"w-[10%] h-full pl-3 flex flex-col justify-start items-start",children:[(0,l.jsx)("div",{className:"text-[10px] text-gray-400 mb-2",children:"STABLECOINS"}),U?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(b.A,{label:"Loading...",color:"#2775ca",isLoading:!0}),(0,l.jsx)(b.A,{label:"Loading...",color:"#26a17b",isLoading:!0}),(0,l.jsx)(b.A,{label:"Loading...",color:"#fa7a35",isLoading:!0})]}):(0,l.jsx)("div",{className:"flex flex-col gap-1 overflow-y-auto max-h-[500px] pr-1",children:F.map(e=>{let t=D.filter(t=>t.mintName===e),a=t.length>0?t.reduce((e,t)=>e+t.p2pVelocity,0)/t.length:0;return(0,l.jsx)(b.A,{label:e,color:(0,y.G)(e),shape:"square",tooltipText:(0,y.formatNumber)(a)},e)})})]})]})})})]})}},58483:(e,t,a)=>{a.d(t,{G:()=>l.G,fetchLiquidityVelocityData:()=>l.fetchTransactionActivityData,formatNumber:()=>l.formatNumber});var l=a(93679)},93679:(e,t,a)=>{a.d(t,{G:()=>r,fetchTransactionActivityData:()=>i,formatNumber:()=>n});let l={USDC:"#2775ca",USDT:"#26a17b",PYUSD:"#8a2be2",USDe:"#ffa500",EURC:"#4169e1",EUROe:"#007bff",USDY:"#20b2aa",FDUSD:"#ff6347",sUSD:"#ff69b4",USDS:"#4b0082",AUSD:"#8b4513",USDG:"#708090"};function r(e){return l[e]||"#999999"}function n(e){return new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(e)}async function i(){try{let e=await fetch("https://analytics.topledger.xyz/tl/api/queries/12792/results.json?api_key=fD12Ml2PxWabxyFbBlzgubpIx91G20rkN6ADNZXs");if(!e.ok)throw Error("API responded with status: ".concat(e.status));return(await e.json()).query_result.data.rows.map(e=>({month:e.month,mint:e.mint||"",mint_name:e.mint_name||"Unknown",token_supply:Number(e.token_supply)||0,fee_payer:Number(e.fee_payer)||0,p2p_fee_payer:Number(e.p2p_fee_payer)||0,transfers:Number(e.transfers)||0,p2p_transfers:Number(e.p2p_transfers)||0,volume:Number(e.volume)||0,p2p_volume:Number(e.p2p_volume)||0,avg_transfer_size:Number(e.avg_transfer_size)||0,p2p_avg_transfer_size:Number(e.p2p_avg_transfer_size)||0,velocity:Number(e.velocity)||0,p2p_velocity:Number(e.p2p_velocity)||0,program_interacted:Number(e.program_interacted)||0,date:new Date(e.month)})).sort((e,t)=>{let a=new Date(e.month).getTime()-new Date(t.month).getTime();return 0!==a?a:e.mint_name.localeCompare(t.mint_name)})}catch(e){throw console.error("Error fetching transaction activity data:",e),Error("Failed to fetch stablecoin transaction activity data")}}}}]);