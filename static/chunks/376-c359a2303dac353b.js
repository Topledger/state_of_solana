"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[376],{81838:(e,t,r)=>{r.d(t,{A:()=>s});var a=r(95155);r(12115);let o=e=>{let{type:t,color:r}=e;return"circle"===t?(0,a.jsx)("div",{className:"h-2 w-2 rounded-full mr-1.5",style:{backgroundColor:r}}):(0,a.jsx)("div",{className:"h-2 w-2 rounded-sm mr-1.5",style:{backgroundColor:r}})},n=(e,t)=>{if(/^\d{4}-\d{2}-\d{2}/.test(e)||/^\d{2}\/\d{2}\/\d{4}/.test(e)){let r=new Date(e);if(!isNaN(r.getTime())){if("W"===t)return"Week of ".concat(r.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"}));if("M"===t)return r.toLocaleDateString("en-US",{month:"short",year:"numeric"});if("Q"===t){let e=Math.floor(r.getMonth()/3)+1;return"Q".concat(e,", ").concat(r.getFullYear())}else if("Y"===t)return r.getFullYear().toString();return r.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})}}return/^[A-Za-z]{3}\s\d{4}$/.test(e)||/^Q[1-4]\s\d{4}$/.test(e)||/^\d{4}$/.test(e),e},l=(e,t)=>{if("string"==typeof e){if(t){let r={USD:"$",EUR:"€",GBP:"\xa3",JPY:"\xa5",CNY:"\xa5",SOL:"SOL"},a=r[t]||t;if("SOL"===t){if(e.includes("SOL"))return e;for(let[t,a]of Object.entries(r))if("SOL"!==t&&e.startsWith(a))return"".concat(e.substring(a.length)," SOL");return"".concat(e," SOL")}for(let[o,n]of Object.entries(r))if(e.startsWith(n)&&o!==t)return e.replace(n,a)}return e}if("number"==typeof e){if(t)switch(t){case"USD":return"$".concat(e.toLocaleString());case"EUR":return"€".concat(e.toLocaleString());case"GBP":return"\xa3".concat(e.toLocaleString());case"JPY":case"CNY":return"\xa5".concat(e.toLocaleString());case"SOL":return"".concat(e.toLocaleString()," SOL");default:return"".concat(t).concat(e.toLocaleString())}return e.toLocaleString()}return String(e)},s=e=>{let{title:t,items:r,top:s,left:i,isModal:c=!1,timeFilter:d,currencyFilter:u}=e,m=r.some(e=>e.axis),f=n(t,d);return(0,a.jsxs)("div",{className:"absolute z-10 pointer-events-none bg-gray-900/95 shadow-lg border border-gray-800 rounded-md p-2 text-xs min-w-[120px]",style:{top:"".concat(s,"px"),left:i>(c?500:250)?"".concat(i-160,"px"):"".concat(i+10,"px"),transform:"translateY(-100%)"},children:[(0,a.jsx)("div",{className:"text-gray-400 text-[10px] font-normal pb-1 mb-1 border-b border-gray-800",children:f}),(0,a.jsx)("div",{className:"space-y-1",children:r.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,a.jsx)(o,{type:e.shape||"circle",color:e.color}),(0,a.jsx)("span",{className:"text-gray-400 font-normal ml-2",children:e.label}),m&&e.axis&&(0,a.jsxs)("span",{className:"ml-1 text-[9px] text-gray-500",children:["(",e.axis," axis)"]})]}),(0,a.jsx)("span",{className:"text-gray-300 font-normal ml-4",children:l(e.value,u)})]},"tooltip-item-".concat(t)))})]})}},86009:(e,t,r)=>{r.d(t,{A:()=>i});var a=r(95155),o=r(12115);let n={indigo:{bg:"bg-indigo-500/10",text:"text-indigo-400",shadow:"hover:shadow-indigo-900/20"},blue:{bg:"bg-blue-500/10",text:"text-blue-400",shadow:"hover:shadow-blue-900/20"},purple:{bg:"bg-purple-500/10",text:"text-purple-400",shadow:"hover:shadow-purple-900/20"},emerald:{bg:"bg-emerald-500/10",text:"text-emerald-400",shadow:"hover:shadow-emerald-900/20"},amber:{bg:"bg-amber-500/10",text:"text-amber-400",shadow:"hover:shadow-amber-900/20"},rose:{bg:"bg-rose-500/10",text:"text-rose-400",shadow:"hover:shadow-rose-900/20"}},l=e=>{if(!e)return 0;let t=e.replace(/,/g,"").match(/\$?([\d.]+)([BMT])?/);if(!t)return 0;let r=parseFloat(t[1]);switch(t[2]){case"T":return 1e6*r;case"B":return 1e3*r;default:return r}},s=(e,t)=>{if(t.includes(",")&&!t.includes("$"))return Math.round(e).toLocaleString("en-US");if(t.includes("T"))return"$".concat((e/1e6).toFixed(2),"T");if(t.includes("B"))return"$".concat((e/1e3).toFixed(2),"B");if(t.includes("M"))return"".concat(e.toFixed(1),"M");if(t.includes("%"))return"".concat(e.toFixed(1),"%");else if(!isNaN(Number(t)))return Math.round(e).toString();return e.toString()};function i(e){let{title:t,value:r,trend:i,icon:c,variant:d="indigo",isLoading:u=!1}=e,m=n[d],[f,h]=(0,o.useState)("0"),[g,p]=(0,o.useState)(!1),x=(0,o.useRef)(r),b=(0,o.useRef)(0);return(0,o.useEffect)(()=>{i&&console.log('Counter "'.concat(t,'" trend value:'),i.value,"isLoading:",u)},[t,i,u]),(0,o.useEffect)(()=>{if("Loading..."===r||r===f)return;x.current=r;let e=l(f),t=l(r);if(e===t)return;b.current&&cancelAnimationFrame(b.current),p(!0);let a=performance.now(),o=n=>{let l=Math.min((n-a)/300,1);h(s(e+l*(2-l)*(t-e),r)),l<1?b.current=requestAnimationFrame(o):(h(r),p(!1))};return b.current=requestAnimationFrame(o),()=>{b.current&&cancelAnimationFrame(b.current)}},[r,f]),(0,a.jsxs)("div",{className:"bg-black/80 backdrop-blur-sm p-4 md:p-5 rounded-xl border border-gray-900 shadow-lg ".concat(m.shadow," transition-all duration-300 min-h-[90px]"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h2",{className:"text-xs md:text-sm font-normal text-gray-500",children:t}),(0,a.jsx)("div",{className:"p-1 md:p-1.5 ".concat(m.bg," rounded-md"),children:(0,a.jsx)("div",{className:"".concat(m.text," w-4 h-4 md:w-5 md:h-5"),children:c})})]}),(0,a.jsxs)("div",{className:"mt-1",children:[(0,a.jsx)("div",{className:"text-xl md:text-2xl font-medium text-gray-300 leading-relaxed truncate",children:"Loading..."===r||g?f:r}),i&&(0,a.jsxs)("div",{className:"flex items-center mt-1 text-xs md:text-sm",children:[(0,a.jsxs)("span",{className:"".concat(i.value>=0?"text-green-400":"text-red-400"," flex items-center"),children:[(0,a.jsx)("svg",{className:"w-3 h-3 md:w-3.5 md:h-3.5 mr-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:i.value>=0?"M5 10l7-7m0 0l7 7m-7-7v18":"M19 14l-7 7m0 0l-7-7m7 7V3"})}),Math.abs(i.value),"%"]}),(0,a.jsx)("span",{className:"text-gray-500 ml-1 md:ml-1.5",children:i.label})]})]})]})}},90874:(e,t,r)=>{r.d(t,{A:()=>S});var a=r(95155),o=r(12115),n=r(79111),l=r(41995),s=r(4503),i=r(45191),c=r(4904),d=r(78398),u=r(50109),m=r(72630),f=r(58888),h=r(51078),g=r(7545),p=r(52594),x=r(37918),b=r(81838),v=r(42028),j=r(93515),w=r(6828),y=r(85204);let k=e=>{let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},S=e=>{var t;let{timeFilter:r="M",isModalOpen:S=!1,onModalClose:A=()=>{},onTimeFilterChange:N,platformsChanged:T,displayMode:L,onDisplayModeChange:C}=e,[M,F]=(0,o.useState)([]),[P,O]=(0,o.useState)([]),[$,D]=(0,o.useState)(!0),[Y,E]=(0,o.useState)(null),[_,U]=(0,o.useState)(null),[Q,B]=(0,o.useState)([]),[W,I]=(0,o.useState)("absolute"),Z=L||W,[q,R]=(0,o.useState)({visible:!1,dataPoint:{},platforms:[],left:0,top:0}),G=(0,o.useRef)(null),z=e=>{if(e.startsWith("Q")&&e.includes(" ")){let t=e.match(/Q(\d+)\s+(\d{4})/);return t?"Q".concat(t[1]):e}if(/^\d{4}$/.test(e))return e;try{let t=new Date(e);if(isNaN(t.getTime()))return console.warn("Invalid date string: ".concat(e)),e;if("Q"===r){let e=Math.floor(t.getMonth()/3)+1;return"Q".concat(e)}if("Y"===r)return t.getFullYear().toString();if("M"===r)return t.toLocaleDateString("en-US",{month:"short"});else if("W"===r)return"".concat(t.toLocaleDateString("en-US",{month:"short",day:"numeric"}));return t.toLocaleDateString("en-US",{month:"short",year:"numeric"})}catch(t){return console.error("Error formatting date: ".concat(e),t),e}},J=e=>{if(e.startsWith("Q")&&e.includes(" ")||/^\d{4}$/.test(e))return e;try{let t=new Date(e);if(isNaN(t.getTime()))return e;if("Q"===r){let e=Math.floor(t.getMonth()/3)+1;return"Q".concat(e," ").concat(t.getFullYear())}if("Y"===r)return t.getFullYear().toString();if("W"===r)return"Week of ".concat(t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}));else if("M"===r)return t.toLocaleDateString("en-US",{month:"short",year:"numeric"});return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch(t){return e}},V=e=>{if(!e.length)return console.warn("No API data to process"),{data:[],keys:[]};console.log("Sample data from API:",e.slice(0,2));let t=new Map,a=new Set;if(console.log("Original platform names from API:",e.map(e=>e.platform)),e.forEach(e=>{let{block_date:o,platform:n,protocol_revenue_usd:l}=e;if(!o||!n||void 0===l)return void console.warn("Skipping invalid data point:",e);let s=o;if("Q"===r||"Y"===r)try{let e=new Date(o);if(isNaN(e.getTime()))console.warn("Invalid date: ".concat(o,", using original string"));else if("Q"===r){let t=Math.floor(e.getMonth()/3)+1;s="Q".concat(t," ").concat(e.getFullYear())}else"Y"===r&&(s=e.getFullYear().toString())}catch(e){console.error("Error processing date: ".concat(o),e)}a.add(n),t.has(s)||t.set(s,{});let i=t.get(s);i[n]=(i[n]||0)+l}),0===t.size)return console.warn("No valid data points after processing"),{data:[],keys:[]};console.log("Grouped data into ".concat(t.size," dates with ").concat(a.size," platforms"));let o={};Array.from(a).forEach(e=>{for(let[,r]of(o[e]=0,t.entries()))o[e]+=Number(r[e]||0)});let n=Object.entries(o).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).map(e=>{let[t]=e;return t});console.log("Sorted platforms:",n),n.forEach(e=>{let t=j.A6[e]||(0,j.Z$)(e);console.log("Platform ".concat(e," color: ").concat(t))});let l=Array.from(t.entries()).sort((e,t)=>{let[a]=e,[o]=t;if("Q"===r){let e=a.match(/Q(\d+)\s+(\d{4})/),t=o.match(/Q(\d+)\s+(\d{4})/);if(e&&t){let[,r,a]=e,[,o,n]=t;return a!==n?parseInt(a)-parseInt(n):parseInt(r)-parseInt(o)}}else if("Y"===r)return parseInt(a)-parseInt(o);return new Date(a).getTime()-new Date(o).getTime()}).map(e=>{let[t,r]=e,a={date:t};return n.forEach(e=>{a[e]=r[e]||0}),a});return T&&T(n.map(e=>({platform:e,color:j.A6[e]||(0,j.Z$)(e),revenue:o[e]||0}))),{data:l,keys:n}},H=(0,o.useCallback)(async()=>{D(!0),E(null);try{let e=await (0,j.Ub)(r);if(console.log("Fetched ".concat(e.length," data points for timeFilter: ").concat(r)),"Q"!==r&&"Y"!==r||e&&0!==e.length||(console.log("No data for ".concat(r,", falling back to monthly data")),e=await (0,j.Ub)("M"),console.log("Fallback: Fetched ".concat(e.length," monthly data points"))),e&&0!==e.length){let{data:t,keys:r}=V(e);console.log("Processed data has ".concat(t.length," points and ").concat(r.length," platforms")),t.length>0&&console.log("First data point:",t[0]),console.log("Platform colors mapping:"),r.forEach(e=>{let t=j.A6[e]||(0,j.Z$)(e);console.log("".concat(e,": ").concat(t))}),F(t),B(t),O(r)}else console.error("No data returned for timeFilter: ".concat(r)),E("No data available for ".concat("Q"===r?"Quarterly":"Y"===r?"Yearly":r," view")),F([]),O([]),B([])}catch(e){console.error("Error fetching data:",e),E("Failed to load data"),F([]),O([]),B([])}finally{D(!1)}},[r,T]);(0,o.useEffect)(()=>{console.log("Colors array:",w.Tj),console.log("platformColors mapping:",j.A6),H()},[H]),(0,o.useEffect)(()=>{if(!M.length)return;if(!_)return void B(M);let[e,t]=_,r=M.filter(r=>{let a=new Date(r.date).getTime();return a>=e.getTime()&&a<=t.getTime()});B(r.length>0?r:M)},[_,M]);let K=(0,o.useCallback)(e=>{if(!e)return void U(null);let{x0:t,x1:r}=e;U([new Date(t),new Date(r)])},[]),X=(0,o.useCallback)(()=>{q.visible&&R(e=>({...e,visible:!1}))},[q.visible]),ee=(0,o.useCallback)(e=>{let t=null;if(S){let r=e.target;for(;r&&!r.classList.contains("overflow-hidden");)r=r.parentElement;t=r}else t=G.current;if(!t)return;let r=t.getBoundingClientRect(),a=e.clientX-r.left,o=e.clientY-r.top,n={right:25,left:45},l=r.width-n.left-n.right;if(a<n.left||a>r.width-n.right){q.visible&&R(e=>({...e,visible:!1}));return}let s=l/Q.length,i=Math.floor((a-n.left)/s);i<0&&(i=0),i>=Q.length&&(i=Q.length-1);let c=Q[i];if(c){var d;let e=!(null==(d=q.dataPoint)?void 0:d.date)||q.dataPoint.date!==c.date;!q.visible||e?R({visible:!0,dataPoint:c,platforms:P,left:a,top:o}):R(e=>({...e,left:a,top:o}))}},[Q,P,q.visible,null==(t=q.dataPoint)?void 0:t.date,S]),et=(0,o.useCallback)(()=>"absolute"===Z?Q:Q.map(e=>{let t={date:e.date},r=P.reduce((t,r)=>t+(Number(e[r])||0),0);if(r>0){let a={},o=0;P.forEach(t=>{let n=(Number(e[t])||0)/r*100;a[t]=n,o+=n});let n=o>0?100/o:1;P.forEach(e=>{t[e]=a[e]*n})}else P.forEach(e=>{t[e]=0});return t}),[Z,Q,P]),er=e=>"absolute"!==Z?"".concat(Math.round(e),"%"):e>=1e9?"$".concat((e/1e9).toFixed(+(e%1e9!=0)),"B"):e>=1e6?"$".concat((e/1e6).toFixed(+(e%1e6!=0)),"M"):e>=1e3?"$".concat((e/1e3).toFixed(+(e%1e3!=0)),"K"):"$".concat(Math.round(e)),ea=()=>{if($)return(0,a.jsx)("div",{className:"flex justify-center items-center h-full w-full",children:(0,a.jsx)(h.A,{size:"sm"})});if(Y||!Q.length)return(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center h-full w-full",children:[(0,a.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:Y||"No data available"}),(0,a.jsx)(g.A,{onClick:H,children:(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(k,{className:"w-3.5 h-3.5"}),(0,a.jsx)("span",{children:"Refresh"})]})})]});let e=et();return(0,a.jsxs)("div",{className:"h-full w-full relative",children:[q.visible&&q.dataPoint&&!S&&(0,a.jsx)(b.A,{title:J(q.dataPoint.date),items:q.platforms.filter(e=>Number(q.dataPoint[e]||0)>0).filter((e,t,r)=>r.indexOf(e)===t).map(e=>{let t;if(j.A6[e])t=j.A6[e],console.log("Tooltip using platformColors for ".concat(e,": ").concat(t));else{let r=e.toLowerCase(),a=Object.keys(j.A6).find(e=>e.toLowerCase()===r);a?(t=j.A6[a],console.log("Tooltip using platformColors (case-insensitive) for ".concat(e," via ").concat(a,": ").concat(t))):(t=(0,j.Z$)(e),console.log("Tooltip using getPlatformColor for ".concat(e,": ").concat(t)))}return{color:t,label:(0,j.k$)(e),value:er(Number(q.dataPoint[e]||0)),shape:"square"}}),top:q.top,left:q.left}),(0,a.jsx)("div",{className:"h-[85%] w-full overflow-hidden relative",ref:S?null:G,onMouseMove:ee,onMouseLeave:X,children:(0,a.jsx)(n.A,{children:t=>{let{width:o,height:n}=t,h={top:5,right:25,bottom:30,left:45},g=o-h.left-h.right,p=n-h.top-h.bottom,x=(0,i.A)({domain:e.map(e=>e.date),padding:.2,range:[0,g]});console.log("X-axis domain values:",x.domain());let b=(0,c.A)({domain:"percent"===Z?[0,100]:[0,Math.max(...e.map(e=>P.reduce((t,r)=>t+(Number(e[r])||0),0)))],nice:!0,range:[p,0]});return(0,d.A)({domain:P,range:P.map(e=>j.A6[e]||(0,j.Z$)(e))}),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("svg",{width:o,height:n,children:(0,a.jsxs)(l.A,{left:h.left,top:h.top,children:[(0,a.jsx)(u.A,{scale:b,width:g,height:p,stroke:w.Vg,strokeOpacity:.5,strokeDasharray:"2,3",numTicks:4}),(0,a.jsx)(s.A,{data:e,keys:P,x:e=>e.date,xScale:x,yScale:b,color:e=>{if(console.log("Platform in BarStack: ".concat(e)),j.A6[e])return console.log("Using platformColors for ".concat(e,": ").concat(j.A6[e])),j.A6[e];let t=e.toLowerCase(),r=Object.keys(j.A6).find(e=>e.toLowerCase()===t);return r?(console.log("Using platformColors (case-insensitive) for ".concat(e," via ").concat(r,": ").concat(j.A6[r])),j.A6[r]):(console.log("Using getPlatformColor for ".concat(e)),(0,j.Z$)(e))},children:t=>t.map(t=>t.bars.map(r=>{var o;return r.height<=0?null:(0,a.jsx)("rect",{x:r.x,y:r.y,height:r.height,width:r.width,fill:(()=>{let e=t.key;if(console.log("Rendering bar for platform: ".concat(e)),j.A6[e])return console.log("Using platformColors for bar ".concat(e,": ").concat(j.A6[e])),j.A6[e];let a=e.toLowerCase(),o=Object.keys(j.A6).find(e=>e.toLowerCase()===a);return o?(console.log("Using platformColors (case-insensitive) for bar ".concat(e," via ").concat(o,": ").concat(j.A6[o])),j.A6[o]):(console.log("Using bar.color for ".concat(e,": ").concat(r.color)),r.color)})(),opacity:q.visible&&(null==(o=q.dataPoint)?void 0:o.date)===e[r.index].date?1:.75,rx:2},"bar-stack-".concat(t.index,"-").concat(r.index))}).filter(Boolean))}),(0,a.jsx)("rect",{x:0,y:0,width:g,height:p,fill:"transparent",onMouseMove:ee,onMouseLeave:X}),(0,a.jsx)(m.A,{top:p,scale:x,tickFormat:z,stroke:w.h5,strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,tickLabelProps:()=>({fill:w.Dc,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"middle",dy:"0.5em"}),tickValues:"Q"===r||"Y"===r?e.map(e=>e.date):e.length>10?e.filter((t,r)=>r%Math.ceil(e.length/10)==0).map(e=>e.date):e.map(e=>e.date)}),(0,a.jsx)(f.A,{scale:b,stroke:w.h5,strokeWidth:.5,tickStroke:"transparent",tickLength:0,tickFormat:e=>er(e),tickLabelProps:()=>({fill:w.Dc,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"end",dx:"-0.6em",dy:"0.25em"}),numTicks:4})]})})})}})}),(0,a.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,a.jsx)(v.A,{data:M,activeBrushDomain:_,onBrushChange:K,onClearBrush:()=>U(null),getDate:e=>e.date,getValue:e=>P.reduce((t,r)=>t+(Number(e[r])||0),0),lineColor:j.A6[P[0]||""]||(0,j.Z$)(P[0]||""),margin:{top:5,right:25,bottom:10,left:45}})})]})};return(0,a.jsxs)(a.Fragment,{children:[ea(),S&&(0,a.jsxs)(p.A,{isOpen:S,onClose:A,title:"Protocol Revenue by Platform",subtitle:"Stacked view of protocol revenue across platforms by time period",children:[(0,a.jsxs)("div",{className:"flex pl-1 py-0 mb-3",children:[(0,a.jsx)(x.A,{value:r,onChange:N||(()=>{}),options:[{value:"W",label:"W"},{value:"M",label:"M"},{value:"Q",label:"Q"},{value:"Y",label:"Y"}]}),(0,a.jsx)(y.A,{mode:Z,onChange:e=>{C?C(e):I(e)}})]}),(0,a.jsx)("div",{className:"h-px bg-gray-900 w-full mb-3"}),(0,a.jsx)("div",{className:"h-[60vh]",children:(0,a.jsxs)("div",{className:"flex h-full",children:[(0,a.jsxs)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900 relative",children:[S&&q.visible&&q.dataPoint&&(0,a.jsx)(b.A,{title:J(q.dataPoint.date),items:q.platforms.filter(e=>Number(q.dataPoint[e]||0)>0).filter((e,t,r)=>r.indexOf(e)===t).map(e=>{let t;if(j.A6[e])t=j.A6[e];else{let r=e.toLowerCase(),a=Object.keys(j.A6).find(e=>e.toLowerCase()===r);t=a?j.A6[a]:(0,j.Z$)(e)}return{color:t,label:(0,j.k$)(e),value:er(Number(q.dataPoint[e]||0)),shape:"square"}}),top:q.top,left:q.left,isModal:!0}),ea()]}),(0,a.jsx)("div",{className:"w-[10%] h-full pl-3 flex flex-col justify-start items-start",children:(0,a.jsx)(p.B,{items:P.map(e=>{let t;if(Q.reduce((t,r)=>t+(Number(r[e])||0),0),j.A6[e])t=j.A6[e];else{let r=e.toLowerCase(),a=Object.keys(j.A6).find(e=>e.toLowerCase()===r);t=a?j.A6[a]:(0,j.Z$)(e)}return{id:e,label:(0,j.k$)(e),color:t}}),maxHeight:600,maxItems:28})})]})})]})]})}},93515:(e,t,r)=>{r.d(t,{A6:()=>s,Ub:()=>o,Z$:()=>i,k$:()=>n,pf:()=>c,vv:()=>l});var a=r(6828);let o=async e=>{try{var t,r;let a=await fetch("https://analytics.topledger.xyz/solana/api/queries/12589/results?api_key=oiGI7qFLlC7o3etCqCywaqnYbY2Z2bGFxOOKdJwO",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({parameters:{"Date Part":e}})});if(!a.ok)throw Error("API request failed with status ".concat(a.status));let o=await a.json();if(!(null==(r=o.query_result)||null==(t=r.data)?void 0:t.rows))return[];return o.query_result.data.rows.map(e=>({block_date:e.block_date,platform:n(e.Platform||e.platform),protocol_revenue_usd:parseFloat(e.protocol_revenue_usd||0)}))}catch(e){throw console.error("Error fetching platform revenue data:",e),e}};function n(e){return e?e.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "):"Unknown"}let l=e=>e>=1e9?"$".concat((e/1e9).toFixed(1),"B"):e>=1e6?"$".concat((e/1e6).toFixed(1),"M"):e>=1e3?"$".concat((e/1e3).toFixed(1),"K"):"$".concat(e.toFixed(0)),s={Phantom:a.Tj[0],"Pump fun":a.Tj[1],Radium:a.Tj[2],"Pump.Fun AMM":a.Tj[3],Photon:a.Tj[1],Axiom:a.Tj[5],BullX:a.Tj[6],Orca:a.Tj[7],Trojan:a.Tj[8],GMGN:a.Tj[9],Jito:a.Tj[10],Metaplex:a.Tj[11],Other:a.Tj[12],Magiceden:a.Tj[13],Bloxroute:a.Tj[14],Tensorswap:a.Tj[15],Helio:a.Tj[16],"Banana Gun":a.Tj[17],"Sol Trading Bot":a.Tj[18],DexScreener:a.Tj[19],Lifinity:a.Tj[20],"Bloom trading bot":a.Tj[21],Gmgn:a.Tj[9],Raydium:a.Tj[2],Dexscreener:a.Tj[19],MEW:a.Tj[22],Jupiter:a.Tj[23],Drift:a.Tj[24],LFG:"#38bdf8",Kamino:"#fb7185",Marginfi:"#84cc16",Tensor:"#9333ea"},i=e=>{if("phantom"===e.toLowerCase())return a.Tj[0];if(s[e])return s[e];let t=e.toLowerCase(),r=Object.keys(s).find(e=>e.toLowerCase()===t);if(r)return s[r];let o=Array.from(e).reduce((e,t)=>e+t.charCodeAt(0),0);return a.Tj[o%a.Tj.length]},c=async e=>{try{let t=await o(e);if(!t||0===t.length)throw Error("No platform revenue data available");let r={};t.forEach(e=>{r[e.platform]||(r[e.platform]=0),r[e.platform]+=e.protocol_revenue_usd});let a=Object.entries(r).sort((e,t)=>t[1]-e[1]).map(e=>{let[t]=e;return t}),n=t.sort((e,t)=>{let r=a.indexOf(e.platform),o=a.indexOf(t.platform);return r!==o?r-o:new Date(e.block_date).getTime()-new Date(t.block_date).getTime()}).map(e=>[e.block_date,e.platform,e.protocol_revenue_usd.toFixed(2)]);return["block_date,Platform,protocol_revenue_usd",...n.map(e=>e.join(","))].join("\n")}catch(e){throw console.error("Error preparing platform revenue CSV:",e),e}}}}]);