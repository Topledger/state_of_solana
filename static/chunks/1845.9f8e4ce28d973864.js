"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1845,8119],{18119:(e,t,r)=>{r.d(t,{fetchUserActivityData:()=>n});async function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"M";try{let t=await fetch("https://analytics.topledger.xyz/tl/api/queries/12973/results?api_key=W0uxPWzEpwdowSGrlFGjUmFBxF4pR6bDVoVfBMDr",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({parameters:{"Date Part":e}}),cache:"no-store"});if(!t.ok)throw Error("API error: ".concat(t.status));let r=await t.json();if(!r||!r.query_result||!r.query_result.data||!r.query_result.data.rows)throw Error("Invalid API response structure");let n=r.query_result.data.rows;if(0===n.length)throw Error("Data is still processing. Please try again later.");return n.map(e=>({block_date:e.block_date,Active_Wallets:parseInt(e.Active_Wallets,10)||0,New_Wallets:parseInt(e.New_Wallets,10)||0}))}catch(e){throw console.error("Error fetching user activity data:",e),e}}},45191:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(28749),l=r(95442),a=(0,r(70222).A)("domain","range","reverse","align","padding","round");function s(e){return a(function e(){var t,r,a=(0,l.A)().unknown(void 0),s=a.domain,i=a.range,c=0,o=1,u=!1,d=0,h=0,f=.5;function m(){var e=s().length,n=o<c,l=n?o:c,a=n?c:o;t=(a-l)/Math.max(1,e-d+2*h),u&&(t=Math.floor(t)),l+=(a-l-t*(e-d))*f,r=t*(1-d),u&&(l=Math.round(l),r=Math.round(r));var m=(function(e,t,r){e*=1,t*=1,r=(l=arguments.length)<2?(t=e,e=0,1):l<3?1:+r;for(var n=-1,l=0|Math.max(0,Math.ceil((t-e)/r)),a=Array(l);++n<l;)a[n]=e+n*r;return a})(e).map(function(e){return l+t*e});return i(n?m.reverse():m)}return delete a.unknown,a.domain=function(e){return arguments.length?(s(e),m()):s()},a.range=function(e){return arguments.length?([c,o]=e,c*=1,o*=1,m()):[c,o]},a.rangeRound=function(e){return[c,o]=e,c*=1,o*=1,u=!0,m()},a.bandwidth=function(){return r},a.step=function(){return t},a.round=function(e){return arguments.length?(u=!!e,m()):u},a.padding=function(e){return arguments.length?(d=Math.min(1,h=+e),m()):d},a.paddingInner=function(e){return arguments.length?(d=Math.min(1,e),m()):d},a.paddingOuter=function(e){return arguments.length?(h=+e,m()):h},a.align=function(e){return arguments.length?(f=Math.max(0,Math.min(1,e)),m()):f},a.copy=function(){return e(s(),[c,o]).round(u).paddingInner(d).paddingOuter(h).align(f)},n.C.apply(m(),arguments)}(),e)}},61845:(e,t,r)=>{r.r(t),r.d(t,{default:()=>j});var n=r(95155),l=r(12115),a=r(79111),s=r(45191),i=r(4904),c=r(71734),o=r(41995),u=r(72630),d=r(58888),h=r(50109),f=r(51078),m=r(7545),g=r(81838),x=r(52594),p=r(42028),v=r(18119),b=r(37918);let y=e=>{let{className:t="w-4 h-4"}=e;return(0,n.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},w={Active_Wallets:"#3b82f6",New_Wallets:"#10b981",grid:"#1f2937",axisLines:"#374151",tickLabels:"#6b7280"},j=e=>{let{isModalOpen:t=!1,onModalClose:r=()=>{},timeView:j="M",onTimeViewChange:N,legendsChanged:S}=e,[k,A]=(0,l.useState)([]),[_,W]=(0,l.useState)([]),[M,L]=(0,l.useState)(!0),[O,D]=(0,l.useState)(null),[C,T]=(0,l.useState)(!1),[E,U]=(0,l.useState)(null),[Y,F]=(0,l.useState)([]),[P,R]=(0,l.useState)([]),[B,Q]=(0,l.useState)(!0),[z,I]=(0,l.useState)(null),[q,$]=(0,l.useState)(j),[G,J]=(0,l.useState)(!1),[V,H]=(0,l.useState)(null),[Z,K]=(0,l.useState)({visible:!1,date:"",items:[],left:0,top:0}),X=(0,l.useRef)(null),ee=(0,l.useRef)(!0),et=(0,l.useRef)(null),er=(0,l.useRef)(!0),en=(0,l.useRef)(null),el=(0,l.useRef)(null),ea=(0,l.useCallback)(async()=>{L(!0),D(null);try{let e=await (0,v.fetchUserActivityData)(j);if(0===e.length)D("No data available for user activity."),A([]),W([]);else{let t=e.map(e=>({...e,dateObj:new Date(e.block_date)})).sort((e,t)=>e.dateObj.getTime()-t.dateObj.getTime());A(t),W(t),T(!1),U(null)}}catch(e){D(e instanceof Error?e.message:"Failed to load data."),A([]),W([])}finally{L(!1)}},[j]),es=(0,l.useCallback)(async()=>{Q(!0),I(null);try{let e=await (0,v.fetchUserActivityData)(q);if(0===e.length)I("No data available for user activity."),F([]),R([]);else{let t=e.map(e=>({...e,dateObj:new Date(e.block_date)})).sort((e,t)=>e.dateObj.getTime()-t.dateObj.getTime());F(t),R(t),J(!1),H(null)}}catch(e){I(e instanceof Error?e.message:"Failed to load data."),F([]),R([])}finally{Q(!1)}},[q]);(0,l.useEffect)(()=>{ea()},[ea]),(0,l.useEffect)(()=>{t&&($(j),F(k),R(_.length>0?_:k),H(E),J(C),es())},[t,j,k,_,E,C,es]);let ei=(0,l.useCallback)(e=>{if(!e){C&&(U(null),T(!1)),X.current&&(clearTimeout(X.current),X.current=null,ee.current=!0);return}let{x0:t,x1:r}=e,n=new Date(t),l=new Date(r);!(isNaN(n.getTime())||isNaN(l.getTime()))&&(U([n,l]),C||T(!0))},[C]),ec=(0,l.useCallback)(e=>{if(!e){G&&(H(null),J(!1)),et.current&&(clearTimeout(et.current),et.current=null,er.current=!0);return}let{x0:t,x1:r}=e,n=new Date(t),l=new Date(r);!(isNaN(n.getTime())||isNaN(l.getTime()))&&(H([n,l]),G||J(!0))},[G]);(0,l.useEffect)(()=>{if(0===k.length){_.length>0&&W([]);return}if(!E&&C)return void W(k);if(!E||!C){_.length!==k.length&&W(k);return}if(!ee.current)return;let[e,t]=E,r=k.filter(r=>r.dateObj>=e&&r.dateObj<=t);W(r.length>0?r:k),ee.current=!1,X.current&&clearTimeout(X.current),X.current=setTimeout(()=>{ee.current=!0},100)},[E,k,C]),(0,l.useEffect)(()=>{if(0===Y.length){P.length>0&&R([]);return}if(!V&&G)return void R(Y);if(!V||!G){P.length!==Y.length&&R(Y);return}if(!er.current)return;let[e,t]=V,r=Y.filter(r=>r.dateObj>=e&&r.dateObj<=t);R(r.length>0?r:Y),er.current=!1,et.current&&clearTimeout(et.current),et.current=setTimeout(()=>{er.current=!0},100)},[V,Y,G]),(0,l.useEffect)(()=>()=>{X.current&&clearTimeout(X.current),et.current&&clearTimeout(et.current)},[]);let eo=(0,l.useCallback)(function(e){var t;let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=null==(t=(r?el:en).current)?void 0:t.getBoundingClientRect();if(!n)return;let l=e.clientX-n.left,a=e.clientY-n.top,s={left:60,right:20},i=n.width-s.left-s.right;if(l<s.left||l>i+s.left){Z.visible&&K(e=>({...e,visible:!1}));return}let c=r?P:_;if(0===c.length)return;let o=i/c.length,u=Math.min(Math.floor((l-s.left)/o),c.length-1);if(u<0||u>=c.length)return;let d=c[u];K({visible:!0,date:d.block_date,items:[{label:"Active Wallets",value:d.Active_Wallets,color:w.Active_Wallets},{label:"New Wallets",value:d.New_Wallets,color:w.New_Wallets}],left:l,top:a})},[_,P,Z.visible]),eu=(0,l.useCallback)(()=>{Z.visible&&K(e=>({...e,visible:!1}))},[Z.visible]),ed=e=>{let t="number"==typeof e?e:e.valueOf();return t>=1e6?"".concat((t/1e6).toFixed(1),"M"):t>=1e3?"".concat((t/1e3).toFixed(1),"K"):t.toString()},eh=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:j,r=new Date(e);if("W"===t)return r.toLocaleDateString("en-US",{month:"short",day:"numeric"});if("M"===t)return r.toLocaleDateString("en-US",{month:"short",year:"numeric"});if("Q"!==t)return r.getFullYear().toString();{let e=Math.floor(r.getMonth()/3)+1;return"Q".concat(e," ").concat(r.getFullYear())}},ef=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=r?q:j,x=r?G?P:Y:C?_:k,v=r?B:M,b=r?z:O;return v?(0,n.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,n.jsx)(f.A,{size:"sm"})}):b||0===x.length?(0,n.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,n.jsx)("p",{className:"text-red-400 mb-3 text-sm",children:b||"No data available"}),(0,n.jsx)(m.A,{onClick:r?es:ea,children:(0,n.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,n.jsx)(y,{className:"w-3.5 h-3.5"}),(0,n.jsx)("span",{children:"Retry"})]})})]}):(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[Z.visible&&(0,n.jsx)(g.A,{left:Z.left,top:Z.top,title:"Date: ".concat(eh(Z.date,l)),items:Z.items.map(e=>({...e,value:ed(e.value)})),isModal:r}),(0,n.jsx)("div",{className:"h-[85%] w-full overflow-hidden relative",ref:r?el:en,onMouseMove:e=>eo(e,r),onMouseLeave:eu,children:(0,n.jsx)(a.A,{children:e=>{let{width:t,height:r}=e;if(t<=0||r<=0)return null;let a={top:5,right:25,bottom:30,left:45},f=t-a.left-a.right,m=r-a.top-a.bottom;if(f<=0||m<=0)return null;let g=Math.max(Math.max(...x.map(e=>e.Active_Wallets)),Math.max(...x.map(e=>e.New_Wallets))),p=(0,s.A)({domain:x.map(e=>e.block_date),range:[0,f],padding:.2}),v=(0,i.A)({domain:[0,1.1*g],range:[m,0],nice:!0}),b=p.bandwidth()/2;return(0,n.jsx)("svg",{width:t,height:r-5,children:(0,n.jsxs)(o.A,{left:a.left,top:a.top,children:[(0,n.jsx)(h.A,{scale:v,width:f,height:m,stroke:w.grid,strokeOpacity:.5,strokeDasharray:"2,3",numTicks:5}),x.map((e,t)=>{let r=m-v(e.Active_Wallets),l=p(e.block_date)||0;return(0,n.jsx)(c.A,{x:l,y:m-r,width:b,height:r,fill:w.Active_Wallets,opacity:Z.date===e.block_date?1:.8,rx:2},"active-".concat(t))}),x.map((e,t)=>{let r=m-v(e.New_Wallets),l=(p(e.block_date)||0)+b;return(0,n.jsx)(c.A,{x:l,y:m-r,width:b,height:r,fill:w.New_Wallets,opacity:Z.date===e.block_date?1:.8,rx:2},"new-".concat(t))}),(0,n.jsx)(u.A,{top:m,scale:p,stroke:w.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,numTicks:Math.min(5,x.length),tickFormat:e=>{let t=new Date(e);switch(l){case"Y":return t.getFullYear().toString();case"Q":return"Q".concat(Math.floor(t.getMonth()/3)+1);case"M":return t.toLocaleDateString("en-US",{month:"short"});default:return t.toLocaleDateString("en-US",{month:"short",day:"numeric"})}},tickLabelProps:(e,t)=>({fill:w.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:0===t?"start":"middle",dy:"0.5em",dx:0===t?"0.5em":0})}),(0,n.jsx)(d.A,{scale:v,stroke:w.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickFormat:ed,tickLabelProps:()=>({fill:w.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"end",dx:"-0.6em",dy:"0.25em"})})]})})}})}),(0,n.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,n.jsx)(p.A,{data:r?Y:k,isModal:r,activeBrushDomain:r?V:E,onBrushChange:r?ec:ei,onClearBrush:r?()=>{H(null),J(!1)}:()=>{U(null),T(!1)},getDate:e=>e.dateObj,getValue:e=>e.Active_Wallets+e.New_Wallets,lineColor:w.Active_Wallets,margin:{top:5,right:25,bottom:10,left:45}})})]})};return(0,n.jsxs)("div",{className:"h-full w-full relative",children:[ef(0,0),(0,n.jsxs)(x.A,{isOpen:t,onClose:r,title:"User Activity",subtitle:"Tracking active and new wallets in the Solana ecosystem",children:[(0,n.jsx)("div",{className:"flex items-center justify-between pl-1 py-0 mb-3",children:(0,n.jsx)("div",{className:"flex space-x-4 items-center",children:(0,n.jsx)(b.A,{value:q,onChange:e=>{$(e),N&&N(e)},options:[{value:"W",label:"W"},{value:"M",label:"M"},{value:"Q",label:"Q"},{value:"Y",label:"Y"}]})})}),(0,n.jsx)("div",{className:"h-px bg-gray-900 w-full mb-3"}),(0,n.jsx)("div",{className:"h-[60vh]",children:(0,n.jsxs)("div",{className:"flex h-full",children:[(0,n.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:ef(0,0,!0)}),(0,n.jsxs)("div",{className:"w-[10%] h-full pl-3 flex flex-col justify-start items-start",children:[(0,n.jsx)("div",{className:"text-[10px] text-gray-400 mb-2",children:"WALLET TYPES"}),(0,n.jsxs)("div",{className:"flex items-center mb-1.5",children:[(0,n.jsx)("div",{className:"w-2.5 h-2.5 rounded-sm mr-1.5",style:{backgroundColor:w.Active_Wallets}}),(0,n.jsx)("span",{className:"text-[11px] text-gray-300",children:"Active Wallets"})]}),(0,n.jsxs)("div",{className:"flex items-center mb-1.5",children:[(0,n.jsx)("div",{className:"w-2.5 h-2.5 rounded-sm mr-1.5",style:{backgroundColor:w.New_Wallets}}),(0,n.jsx)("span",{className:"text-[11px] text-gray-300",children:"New Wallets"})]})]})]})})]})]})}},81838:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(95155);r(12115);let l=e=>{let{type:t,color:r}=e;return"circle"===t?(0,n.jsx)("div",{className:"h-2 w-2 rounded-full mr-1.5",style:{backgroundColor:r}}):(0,n.jsx)("div",{className:"h-2 w-2 rounded-sm mr-1.5",style:{backgroundColor:r}})},a=(e,t)=>{if(/^\d{4}-\d{2}-\d{2}/.test(e)||/^\d{2}\/\d{2}\/\d{4}/.test(e)){let r=new Date(e);if(!isNaN(r.getTime())){if("W"===t)return"Week of ".concat(r.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"}));if("M"===t)return r.toLocaleDateString("en-US",{month:"short",year:"numeric"});if("Q"===t){let e=Math.floor(r.getMonth()/3)+1;return"Q".concat(e,", ").concat(r.getFullYear())}else if("Y"===t)return r.getFullYear().toString();return r.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})}}return/^[A-Za-z]{3}\s\d{4}$/.test(e)||/^Q[1-4]\s\d{4}$/.test(e)||/^\d{4}$/.test(e),e},s=(e,t)=>{if("string"==typeof e){if(t){let r={USD:"$",EUR:"€",GBP:"\xa3",JPY:"\xa5",CNY:"\xa5",SOL:"SOL"},n=r[t]||t;if("SOL"===t){if(e.includes("SOL"))return e;for(let[t,n]of Object.entries(r))if("SOL"!==t&&e.startsWith(n))return"".concat(e.substring(n.length)," SOL");return"".concat(e," SOL")}for(let[l,a]of Object.entries(r))if(e.startsWith(a)&&l!==t)return e.replace(a,n)}return e}if("number"==typeof e){if(t)switch(t){case"USD":return"$".concat(e.toLocaleString());case"EUR":return"€".concat(e.toLocaleString());case"GBP":return"\xa3".concat(e.toLocaleString());case"JPY":case"CNY":return"\xa5".concat(e.toLocaleString());case"SOL":return"".concat(e.toLocaleString()," SOL");default:return"".concat(t).concat(e.toLocaleString())}return e.toLocaleString()}return String(e)},i=e=>{let{title:t,items:r,top:i,left:c,isModal:o=!1,timeFilter:u,currencyFilter:d}=e,h=r.some(e=>e.axis),f=a(t,u);return(0,n.jsxs)("div",{className:"absolute z-10 pointer-events-none bg-gray-900/95 shadow-lg border border-gray-800 rounded-md p-2 text-xs min-w-[120px]",style:{top:"".concat(i,"px"),left:c>(o?500:250)?"".concat(c-160,"px"):"".concat(c+10,"px"),transform:"translateY(-100%)"},children:[(0,n.jsx)("div",{className:"text-gray-400 text-[10px] font-normal pb-1 mb-1 border-b border-gray-800",children:f}),(0,n.jsx)("div",{className:"space-y-1",children:r.map((e,t)=>(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,n.jsx)(l,{type:e.shape||"circle",color:e.color}),(0,n.jsx)("span",{className:"text-gray-400 font-normal ml-2",children:e.label}),h&&e.axis&&(0,n.jsxs)("span",{className:"ml-1 text-[9px] text-gray-500",children:["(",e.axis," axis)"]})]}),(0,n.jsx)("span",{className:"text-gray-300 font-normal ml-4",children:s(e.value,d)})]},"tooltip-item-".concat(t)))})]})}},95442:(e,t,r)=>{r.d(t,{A:()=>function e(){var t=new n,r=[],l=[],a=i;function c(e){let n=t.get(e);if(void 0===n){if(a!==i)return a;t.set(e,n=r.push(e)-1)}return l[n%l.length]}return c.domain=function(e){if(!arguments.length)return r.slice();for(let l of(r=[],t=new n,e))t.has(l)||t.set(l,r.push(l)-1);return c},c.range=function(e){return arguments.length?(l=Array.from(e),c):l.slice()},c.unknown=function(e){return arguments.length?(a=e,c):a},c.copy=function(){return e(r,l).unknown(a)},s.C.apply(c,arguments),c}});class n extends Map{constructor(e,t=a){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(let[t,r]of e)this.set(t,r)}get(e){return super.get(l(this,e))}has(e){return super.has(l(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},r){let n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}(this,e))}}function l({_intern:e,_key:t},r){let n=t(r);return e.has(n)?e.get(n):r}function a(e){return null!==e&&"object"==typeof e?e.valueOf():e}var s=r(28749);let i=Symbol("implicit")}}]);