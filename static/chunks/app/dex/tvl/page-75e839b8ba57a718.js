(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4181],{4503:(e,t,r)=>{"use strict";r.d(t,{A:()=>k});var a=r(12115),l=r(29300),n=r.n(l),o=Array.prototype.slice,s=r(51884);function i(e,t){if((l=e.length)>1)for(var r,a,l,n=1,o=e[t[0]],s=o.length;n<l;++n)for(a=o,o=e[t[n]],r=0;r<s;++r)o[r][1]+=o[r][0]=isNaN(a[r][1])?a[r][0]:a[r][1]}function c(e){for(var t=e.length,r=Array(t);--t>=0;)r[t]=t;return r}function d(e,t){return e[t]}var u=r(41995);function h(e){return null==e?void 0:e[0]}function f(e){return null==e?void 0:e[1]}var g=r(2339);function m(e){var t=e.map(v);return c(e).sort(function(e,r){return t[e]-t[r]})}function v(e){for(var t,r=0,a=-1,l=e.length;++a<l;)(t=+e[a][1])&&(r+=t);return r}function x(e){for(var t,r=-1,a=0,l=e.length,n=-1/0;++r<l;)(t=+e[r][1])>n&&(n=t,a=r);return a}var p={ascending:m,descending:function(e){return m(e).reverse()},insideout:function(e){var t,r,a,l=e.length,n=e.map(v),o=(t=e.map(x),c(e).sort(function(e,r){return t[e]-t[r]})),s=0,i=0,d=[],u=[];for(r=0;r<l;++r)a=o[r],s<i?(s+=n[a],d.push(a)):(i+=n[a],u.push(a));return u.reverse().concat(d)},none:c,reverse:function(e){return c(e).reverse()}};Object.keys(p);var y={expand:function(e,t){if((a=e.length)>0){for(var r,a,l,n=0,o=e[0].length;n<o;++n){for(l=r=0;r<a;++r)l+=e[r][n][1]||0;if(l)for(r=0;r<a;++r)e[r][n][1]/=l}i(e,t)}},diverging:function(e,t){if((s=e.length)>0)for(var r,a,l,n,o,s,i=0,c=e[t[0]].length;i<c;++i)for(n=o=0,r=0;r<s;++r)(l=(a=e[t[r]][i])[1]-a[0])>0?(a[0]=n,a[1]=n+=l):l<0?(a[1]=o,a[0]=o+=l):(a[0]=0,a[1]=l)},none:i,silhouette:function(e,t){if((r=e.length)>0){for(var r,a=0,l=e[t[0]],n=l.length;a<n;++a){for(var o=0,s=0;o<r;++o)s+=e[o][a][1]||0;l[a][1]+=l[a][0]=-s/2}i(e,t)}},wiggle:function(e,t){if((l=e.length)>0&&(a=(r=e[t[0]]).length)>0){for(var r,a,l,n=0,o=1;o<a;++o){for(var s=0,c=0,d=0;s<l;++s){for(var u=e[t[s]],h=u[o][1]||0,f=(h-(u[o-1][1]||0))/2,g=0;g<s;++g){var m=e[t[g]];f+=(m[o][1]||0)-(m[o-1][1]||0)}c+=h,d+=f*h}r[o-1][1]+=r[o-1][0]=n,c&&(n-=d/c)}r[o-1][1]+=r[o-1][0]=n,i(e,t)}}};Object.keys(y);var w=r(71734),b=["data","className","top","left","x","y0","y1","xScale","yScale","color","keys","value","order","offset","children"];function j(){return(j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function k(e){var t=e.data,r=e.className,l=e.top,m=e.left,v=e.x,x=e.y0,k=void 0===x?h:x,T=e.y1,N=void 0===T?f:T,S=e.xScale,D=e.yScale,A=e.color,L=e.keys,M=e.value,E=e.order,C=e.offset,B=e.children,R=function(e,t){if(null==e)return{};var r,a,l={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||(l[r]=e[r]);return l}(e,b),F=function(){var e=(0,s.A)([]),t=c,r=i,a=d;function l(l){var n,o,s=e.apply(this,arguments),i=l.length,c=s.length,d=Array(c);for(n=0;n<c;++n){for(var u,h=s[n],f=d[n]=Array(i),g=0;g<i;++g)f[g]=u=[0,+a(l[g],h,g,l)],u.data=l[g];f.key=h}for(n=0,o=t(d);n<c;++n)d[o[n]].index=n;return r(d,o),d}return l.keys=function(t){return arguments.length?(e="function"==typeof t?t:(0,s.A)(o.call(t)),l):e},l.value=function(e){return arguments.length?(a="function"==typeof e?e:(0,s.A)(+e),l):a},l.order=function(e){return arguments.length?(t=null==e?c:"function"==typeof e?e:(0,s.A)(o.call(e)),l):t},l.offset=function(e){return arguments.length?(r=null==e?i:e,l):r},l}();L&&F.keys(L),M&&(0,g.A)(F.value,M),E&&F.order(E&&p[E]||p.none),C&&F.offset(C&&y[C]||y.none);var O=F(t),H=function(e){if("bandwidth"in e)return e.bandwidth();var t=e.range(),r=e.domain();return Math.abs(t[t.length-1]-t[0])/r.length}(S),P=O.map(function(e,t){var r=e.key;return{index:t,key:r,bars:e.map(function(t,a){var l=(D(k(t))||0)-(D(N(t))||0),n=D(N(t)),o="bandwidth"in S?S(v(t.data)):Math.max((S(v(t.data))||0)-H/2);return{bar:t,key:r,index:a,height:l,width:H,x:o||0,y:n||0,color:A(e.key,a)}})}});return B?a.createElement(a.Fragment,null,B(P)):a.createElement(u.A,{className:n()("visx-bar-stack",r),top:l,left:m},P.map(function(e){return e.bars.map(function(t){return a.createElement(w.A,j({key:"bar-stack-"+e.index+"-"+t.index,x:t.x,y:t.y,height:t.height,width:t.width,fill:t.color},R))})}))}},6828:(e,t,r)=>{"use strict";r.d(t,{$C:()=>p,Dc:()=>v,Tj:()=>a,Vg:()=>g,Vy:()=>x,Zp:()=>n,h5:()=>m,h8:()=>y,wL:()=>o,wv:()=>i,z1:()=>l});let a=["#60a5fa","#a78bfa","#34d399","#f97316","#f43f5e","#facc15","#10b981","#8b5cf6","#ec4899","#6b7280","#3b82f6","#059669","#93c5fd","#c4b5fd","#fb923c","#f87171","#fcd34d","#64748b","#0ea5e9","#1e40af","#4f46e5","#7c3aed","#be123c","#0891b2","#ea580c"],l=a[0],n=a[1],o=a[2],s=a[3],i=a[4],c=a[5],d=a[6],u=a[7],h=a[8],f=a[9];a[0],a[1],a[2],a[3];let g="#1f2937",m="#374151",v="#6b7280",x=e=>a[e%a.length],p={"1-3 transactions":l,"4-5 transactions":o,"6-10 transactions":n,"11-100 transactions":s,"101-1000 transactions":i,">1000 transactions":c},y=[l,n,o,s,i,c,h,u,d,f,a[10],a[11],a[12],a[13],a[14],a[15],a[16],a[17],a[18],a[19],a[20],a[21],a[22],a[23],a[24]]},21903:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(95155);r(12115);var l=r(30963),n=r(51078);let o=e=>{let{title:t,description:r,children:o,filterBar:s,legend:i,onExpandClick:c,onDownloadClick:d,isDownloading:u=!1,accentColor:h="blue",className:f="",legendWidth:g="1/5",isLoading:m=!1}=e,v={blue:{hover:"hover:shadow-blue-900/20",button:"bg-blue-500/10 text-blue-400 hover:bg-blue-500/20",border:"border-blue-400"},purple:{hover:"hover:shadow-purple-900/20",button:"bg-purple-500/10 text-purple-400 hover:bg-purple-500/20",border:"border-purple-400"},green:{hover:"hover:shadow-green-900/20",button:"bg-green-500/10 text-green-400 hover:bg-green-500/20",border:"border-green-400"},orange:{hover:"hover:shadow-orange-900/20",button:"bg-orange-500/10 text-orange-400 hover:bg-orange-500/20",border:"border-orange-400"},indigo:{hover:"hover:shadow-indigo-900/20",button:"bg-indigo-500/10 text-indigo-400 hover:bg-indigo-500/20",border:"border-indigo-400"}}[h];return(0,a.jsxs)("div",{className:"bg-black/80 backdrop-blur-sm p-4 rounded-xl border border-gray-900 shadow-lg ".concat(v.hover," transition-all duration-300 ").concat(f),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsxs)("div",{className:"-mt-1",children:[(0,a.jsx)("h2",{className:"text-[12px] font-normal text-gray-300 leading-tight mb-0.5",children:t}),r&&(0,a.jsx)("p",{className:"text-gray-500 text-[10px] tracking-wide",children:r})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[d&&(0,a.jsx)("button",{className:"p-1.5 ".concat(v.button," rounded-md transition-colors ").concat(u?"opacity-50 cursor-not-allowed":""),onClick:d,title:"Download CSV",disabled:u,children:u?(0,a.jsx)(n.A,{size:"xs",className:"w-4 h-4"}):(0,a.jsx)(l.s3,{className:"w-4 h-4"})}),c&&(0,a.jsx)("button",{className:"p-1.5 ".concat(v.button," rounded-md transition-colors"),onClick:c,title:"Expand Chart",children:(0,a.jsx)(l.mS,{className:"w-4 h-4"})})]})]}),(0,a.jsx)("div",{className:"h-px bg-gray-900 w-full"}),s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex items-center justify-start pl-1 py-2 overflow-visible relative",children:s}),(0,a.jsx)("div",{className:"h-px bg-gray-900 w-full"})]}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row mt-3 h-[360px] lg:h-[380px]",children:[(0,a.jsxs)("div",{className:"flex-grow ".concat(i?"lg:pr-4 lg:border-r lg:border-gray-900":""," h-80 lg:h-auto relative"),children:[m&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-10 rounded-md",children:(0,a.jsx)(n.A,{size:"md"})}),o]}),i&&(0,a.jsx)("div",{className:"w-full ".concat({"1/4":"lg:w-1/4","1/5":"lg:w-1/5","1/6":"lg:w-1/6"}[g]," mt-2 lg:mt-0 lg:pl-4 flex flex-row lg:flex-col"),children:(0,a.jsx)("div",{className:"flex flex-row lg:flex-col gap-2 lg:gap-2 pt-1 pb-0 h-full w-full overflow-hidden",children:(0,a.jsx)("div",{className:"flex flex-row lg:flex-col gap-2 lg:gap-2 w-full h-full overflow-y-auto overflow-x-auto lg:overflow-x-hidden [&::-webkit-scrollbar]:w-1.5  [&::-webkit-scrollbar-track]:bg-transparent  [&::-webkit-scrollbar-thumb]:bg-gray-700/40 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:hover:bg-gray-600/60 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-gray-700/40",children:i})})})]})]})}},30963:(e,t,r)=>{"use strict";r.d(t,{Kx:()=>c,WH:()=>s,c2:()=>o,it:()=>l,mS:()=>d,s3:()=>u,vv:()=>i,wH:()=>n});var a=r(95155);function l(e){let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}function n(e){let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}function o(e){let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}function s(e){let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}function i(e){let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}function c(e){let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})})}r(12115);let d=e=>{let{className:t}=e;return(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,a.jsx)("path",{d:"M15 3h6v6"}),(0,a.jsx)("path",{d:"M9 21H3v-6"}),(0,a.jsx)("path",{d:"M21 3l-7 7"}),(0,a.jsx)("path",{d:"M3 21l7-7"})]})},u=e=>{let{className:t}=e;return(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,a.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,a.jsx)("polyline",{points:"7 10 12 15 17 10"}),(0,a.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}},41545:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var a=r(12115),l=r(29300),n=r.n(l),o=r(41995),s=r(35083),i=["className","top","left","data","centroid","innerRadius","outerRadius","cornerRadius","startAngle","endAngle","padAngle","padRadius","pieSort","pieSortValues","pieValue","children","fill"];function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}function d(e){var t=e.className,r=e.top,l=e.left,d=e.data,u=e.centroid,h=e.innerRadius,f=e.outerRadius,g=e.cornerRadius,m=e.startAngle,v=e.endAngle,x=e.padAngle,p=e.padRadius,y=e.pieSort,w=e.pieSortValues,b=e.pieValue,j=e.children,k=e.fill,T=void 0===k?"":k,N=function(e,t){if(null==e)return{};var r,a,l={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||(l[r]=e[r]);return l}(e,i),S=(0,s.JL)({innerRadius:void 0===h?0:h,outerRadius:f,cornerRadius:g,padRadius:p}),D=(0,s.rL)({startAngle:m,endAngle:v,padAngle:x,value:b,sort:y,sortValues:w}),A=D(void 0===d?[]:d);return j?a.createElement(a.Fragment,null,j({arcs:A,path:S,pie:D})):a.createElement(o.A,{className:"visx-pie-arcs-group",top:r,left:l},A.map(function(e,r){return a.createElement("g",{key:"pie-arc-"+r},a.createElement("path",c({className:n()("visx-pie-arc",t),d:S(e)||"",fill:null==T||"string"==typeof T?T:T(e)},N)),null==u?void 0:u(S.centroid(e),e))}))}},45191:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(28749),l=r(95442),n=(0,r(70222).A)("domain","range","reverse","align","padding","round");function o(e){return n(function e(){var t,r,n=(0,l.A)().unknown(void 0),o=n.domain,s=n.range,i=0,c=1,d=!1,u=0,h=0,f=.5;function g(){var e=o().length,a=c<i,l=a?c:i,n=a?i:c;t=(n-l)/Math.max(1,e-u+2*h),d&&(t=Math.floor(t)),l+=(n-l-t*(e-u))*f,r=t*(1-u),d&&(l=Math.round(l),r=Math.round(r));var g=(function(e,t,r){e*=1,t*=1,r=(l=arguments.length)<2?(t=e,e=0,1):l<3?1:+r;for(var a=-1,l=0|Math.max(0,Math.ceil((t-e)/r)),n=Array(l);++a<l;)n[a]=e+a*r;return n})(e).map(function(e){return l+t*e});return s(a?g.reverse():g)}return delete n.unknown,n.domain=function(e){return arguments.length?(o(e),g()):o()},n.range=function(e){return arguments.length?([i,c]=e,i*=1,c*=1,g()):[i,c]},n.rangeRound=function(e){return[i,c]=e,i*=1,c*=1,d=!0,g()},n.bandwidth=function(){return r},n.step=function(){return t},n.round=function(e){return arguments.length?(d=!!e,g()):d},n.padding=function(e){return arguments.length?(u=Math.min(1,h=+e),g()):u},n.paddingInner=function(e){return arguments.length?(u=Math.min(1,e),g()):u},n.paddingOuter=function(e){return arguments.length?(h=+e,g()):h},n.align=function(e){return arguments.length?(f=Math.max(0,Math.min(1,e)),g()):f},n.copy=function(){return e(o(),[i,c]).round(d).paddingInner(u).paddingOuter(h).align(f)},a.C.apply(g(),arguments)}(),e)}},51078:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(95155);r(12115);let l=e=>{let{size:t="sm",className:r=""}=e;return(0,a.jsx)("div",{className:"flex justify-center items-center h-full ".concat(r),children:(0,a.jsx)("div",{className:"\n          animate-spin \n          ".concat({xs:"h-3 w-3 border-[1.5px]",sm:"h-4 w-4 border-[1.5px]",md:"h-5 w-5 border-2"}[t]," \n          border-gray-600/50 \n          rounded-full \n          border-t-transparent\n        ")})})}},60247:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>$});var a=r(95155),l=r(12115),n=r(79111),o=r(41545),s=r(41995),i=r(78398);async function c(){try{let t=await fetch("https://analytics.topledger.xyz/tl/api/queries/13225/results.json?api_key=6rNImjI05B6uxQzhrJcoOkrYN4Upw6oFkN1yqm76",{next:{revalidate:3600}});if(!t.ok)throw console.error("No data available for this period.",t.statusText),Error("API request failed: ".concat(t.status," - ").concat(t.statusText));var e=await t.json();let r=e.query_result.data.rows,a=r.reduce((e,t)=>e+t.TVL,0);return r.map(e=>({pool:e.pool,tvl:e.TVL,percentage:e.TVL/a*100}))}catch(e){throw console.error("Error fetching TVL by Pool data:",e),e}}let d=e=>e>=1e9?"$".concat((e/1e9).toFixed(1),"B"):e>=1e6?"$".concat((e/1e6).toFixed(1),"M"):e>=1e3?"$".concat((e/1e3).toFixed(1),"K"):"$".concat(e.toFixed(1));async function u(){try{return await c()}catch(e){throw console.error("Error fetching TVL by Pool data:",e),e}}var h=r(51078),f=r(52594),g=r(81838),m=r(7545),v=r(6828);let x=e=>{let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},p=e=>{let{isModalOpen:t=!1,onModalClose:r=()=>{}}=e,[c,p]=(0,l.useState)([]),[y,w]=(0,l.useState)(!0),[b,j]=(0,l.useState)(null),[k,T]=(0,l.useState)({}),[N,S]=(0,l.useState)([]),[D,A]=(0,l.useState)(!0),L=(0,l.useRef)(null),M=(0,l.useRef)(null),[E,C]=(0,l.useState)({visible:!1,data:null,x:0,y:0}),B=e=>k[e]||v.Tj[0],R=(0,l.useCallback)(async()=>{w(!0),j(null);try{let e=await u();p(e),F(e)}catch(e){console.error("Error loading TVL by Pool chart data:",e),j("No data available for this period."),p([])}finally{w(!1)}},[]),F=e=>{if(!e||0===e.length)return;let t=[...e].sort((e,t)=>t.tvl-e.tvl).map(e=>e.pool),r={};t.forEach((e,t)=>{r[e]=v.Tj[t%v.Tj.length]}),T(r)};(0,l.useEffect)(()=>{R()},[R]),(0,l.useEffect)(()=>{t&&(A(!0),c.length>0?(S(c),A(!1)):u().then(e=>{S(e),F(e)}).catch(e=>{console.error("Error loading modal chart data:",e)}).finally(()=>{A(!1)}))},[t,c]);let O=e=>(0,i.A)({domain:e.map(e=>e.pool),range:e.map(e=>B(e.pool))}),H=function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e&&t){let e=a?M.current:L.current;if(e){let a=e.getBoundingClientRect();C({visible:!0,data:t,x:r.clientX-a.left,y:r.clientY-a.top})}}else C(e=>({...e,visible:!1}))},P=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e?N:c;if(e?D:y)return(0,a.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,a.jsx)(h.A,{size:"sm"})});if(b||0===t.length)return(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,a.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:b||"No data available"}),(0,a.jsx)(m.A,{onClick:e?()=>{A(!0),u().then(e=>{S(e)}).catch(e=>{console.error("Error loading modal chart data:",e)}).finally(()=>{A(!1)})}:R,children:(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(x,{className:"w-3.5 h-3.5"}),(0,a.jsx)("span",{children:"Refresh"})]})})]});let r=O(t);return(0,a.jsxs)("div",{className:"h-full w-full relative",ref:e?M:L,children:[E.visible&&E.data&&(0,a.jsx)(g.A,{title:E.data.pool,items:[{color:r(E.data.pool),label:"TVL",value:d(E.data.tvl),shape:"square"},{color:r(E.data.pool),label:"Share",value:"".concat(E.data.percentage.toFixed(1),"%"),shape:"square"}],top:E.y,left:E.x,isModal:e}),(0,a.jsx)(n.A,{children:l=>{let{width:n,height:i}=l,c=Math.min(n,i)/2.5,d=n/2,u=i/2;return(0,a.jsx)("svg",{width:n,height:i,children:(0,a.jsx)(s.A,{top:u,left:d,children:(0,a.jsx)(o.A,{data:t,pieValue:e=>e.tvl,outerRadius:c,innerRadius:.3*c,cornerRadius:3,padAngle:.005,children:t=>t.arcs.map((l,n)=>{let{data:o}=l,[s,i]=t.path.centroid(l),c=o.percentage>5,d=r(o.pool);return(0,a.jsxs)("g",{onMouseMove:t=>H(!0,o,t,e),onMouseLeave:()=>H(!1,null,null,e),children:[(0,a.jsx)("path",{d:t.path(l)||"",fill:d,stroke:"#000",strokeWidth:.5,strokeOpacity:.3}),c&&(0,a.jsx)("text",{fill:"white",x:s,y:i,dy:".33em",fontSize:10,textAnchor:"middle",pointerEvents:"none",children:"".concat(o.percentage.toFixed(0),"%")})]},"arc-".concat(o.pool,"-").concat(n))})})})})}})]})};return(0,a.jsxs)("div",{className:"h-full w-full relative",ref:L,children:[P(!1),(0,a.jsx)(f.A,{isOpen:t,onClose:r,title:"TVL by Pool",subtitle:"Breakdown of Total Value Locked by liquidity pool",children:(0,a.jsx)("div",{className:"h-[60vh]",children:(0,a.jsxs)("div",{className:"flex h-full",children:[(0,a.jsx)("div",{className:"w-[80%] h-full pr-3 border-r border-gray-900 relative",children:P(!0)}),(0,a.jsx)("div",{className:"w-[20%] pl-3",children:(0,a.jsx)("div",{className:"flex flex-col gap-5 pt-1 h-full overflow-hidden",children:(0,a.jsx)("div",{className:"flex flex-col gap-2 max-h-[58vh] overflow-y-auto pr-1 [&::-webkit-scrollbar]:w-1.5  [&::-webkit-scrollbar-track]:bg-transparent  [&::-webkit-scrollbar-thumb]:bg-gray-700/40 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:hover:bg-gray-600/60 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-gray-700/40",children:D?(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 bg-purple-500 mr-2 rounded-sm mt-0.5 animate-pulse"}),(0,a.jsx)("span",{className:"text-[11px] text-gray-300",children:"Loading..."})]}):N.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 mr-2 rounded-sm mt-0.5",style:{backgroundColor:O(N)(e.pool)}}),(0,a.jsxs)("span",{className:"text-[11px] text-gray-300",children:[e.pool," ",(0,a.jsxs)("span",{className:"text-gray-400",children:["(",e.percentage.toFixed(1),"%)"]})]})]},"legend-".concat(t)))})})})]})})})]})};var y=r(50109),w=r(30832),b=r(4904),j=r(72630),k=r(58888),T=r(76167),N=r(13600);async function S(){console.log("[TvlHistory] Starting to fetch TVL history data...");try{let e="https://analytics.topledger.xyz/tl/api/queries/12435/results.json?api_key=QoHzXXunvuLg0rrTWyFTNzmIjIoqY5MJhHo3ltZg";console.log("[TvlHistory] Fetching from URL:",e);let t=null;for(let r=0;r<=2;r++){r>0&&(console.log("[TvlHistory] Retry attempt ".concat(r,"/").concat(2,"...")),await new Promise(e=>setTimeout(e,1e3*Math.pow(2,r-1))));let a=new AbortController,l=setTimeout(()=>a.abort(),2e4);try{let t=await fetch(e,{signal:a.signal,headers:{Accept:"application/json","Content-Type":"application/json"}});if(clearTimeout(l),console.log("[TvlHistory] Received response with status:",t.status),!t.ok)throw console.error("[TvlHistory] HTTP error with status:",t.status),Error("HTTP error! Status: ".concat(t.status));let r=await t.json();if(console.log("[TvlHistory] Successfully parsed JSON response, structure:",Object.keys(r).join(", ")),!r)throw console.error("[TvlHistory] No data received from API"),Error("No data received from API");if(!r.query_result)throw console.error("[TvlHistory] No query_result in response:",r),Error("Invalid API response format: missing query_result");if(!r.query_result.data)throw console.error("[TvlHistory] No data in query_result:",r.query_result),Error("Invalid API response format: missing query_result.data");if(!r.query_result.data.rows||!Array.isArray(r.query_result.data.rows))throw console.error("[TvlHistory] No rows array in data:",r.query_result.data),Error("Invalid API response format: missing rows array");console.log("[TvlHistory] Raw rows count:",r.query_result.data.rows.length),r.query_result.data.rows.length>0&&console.log("[TvlHistory] Sample raw row:",r.query_result.data.rows[0]),r.query_result.data.columns&&console.log("[TvlHistory] API columns:",r.query_result.data.columns.map(e=>e.name||e).join(", ")),console.log("[TvlHistory] Processing rows with block_date and TVL fields");let n=r.query_result.data.rows.filter(e=>!(!e.block_date||isNaN(parseFloat(e.TVL)))||(console.warn("[TvlHistory] Skipping row with missing block_date or TVL:",e),!1)).map(e=>({date:e.block_date,tvl:parseFloat(e.TVL)})),o=new Map;n.forEach(e=>{let t=o.get(e.date)||0;o.set(e.date,t+e.tvl)});let s=Array.from(o.entries()).map(e=>{let[t,r]=e;return{date:t,tvl:r}});if(0===s.length)throw console.error("[TvlHistory] No valid data points after aggregation"),Error("No valid data points received from API");return s.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),console.log("[TvlHistory] Successfully processed ".concat(s.length," data points")),console.log("[TvlHistory] First data point:",s[0]),console.log("[TvlHistory] Last data point:",s[s.length-1]),s}catch(e){if(clearTimeout(l),"AbortError"===e.name){if(console.warn("[TvlHistory] Fetch request timed out after ".concat(20," seconds (attempt ").concat(r+1,"/").concat(3,")")),2===r)throw Error("API request timed out after ".concat(3," attempts"));t=e;continue}if(t=e,r<2){console.warn("[TvlHistory] Fetch error (attempt ".concat(r+1,"/").concat(3,"):"),e.message);continue}throw e}}throw t||Error("Failed to fetch TVL history data after all retries")}catch(e){if(console.error("[TvlHistory] Error fetching TVL history data after all attempts:",e),e instanceof TypeError&&e.message.includes("Failed to fetch"))throw console.error("[TvlHistory] Network error: Unable to connect to the API"),Error("Network connectivity issue: Unable to reach the API");throw e}}let D=[{date:"2023-01-01",tvl:12e8},{date:"2023-01-15",tvl:125e7},{date:"2023-02-01",tvl:13e8},{date:"2023-02-15",tvl:135e7},{date:"2023-03-01",tvl:15e8},{date:"2023-03-15",tvl:145e7},{date:"2023-04-01",tvl:14e8},{date:"2023-04-15",tvl:155e7},{date:"2023-05-01",tvl:16e8},{date:"2023-05-15",tvl:165e7},{date:"2023-06-01",tvl:17e8},{date:"2023-06-15",tvl:175e7},{date:"2023-07-01",tvl:18e8},{date:"2023-07-15",tvl:185e7},{date:"2023-08-01",tvl:19e8},{date:"2023-08-15",tvl:195e7},{date:"2023-09-01",tvl:2e9},{date:"2023-09-15",tvl:205e7},{date:"2023-10-01",tvl:21e8},{date:"2023-10-15",tvl:215e7},{date:"2023-11-01",tvl:22e8},{date:"2023-11-15",tvl:225e7},{date:"2023-12-01",tvl:23e8},{date:"2023-12-15",tvl:235e7},{date:"2024-01-01",tvl:24e8},{date:"2024-01-15",tvl:245e7},{date:"2024-02-01",tvl:25e8},{date:"2024-02-15",tvl:255e7},{date:"2024-03-01",tvl:26e8},{date:"2024-03-15",tvl:265e7},{date:"2024-04-01",tvl:27e8},{date:"2024-04-15",tvl:275e7},{date:"2024-05-01",tvl:28e8}];async function A(){try{console.log("[TvlHistory] Attempting to fetch real data from API...");let e=await S();return console.log("[TvlHistory] Successfully fetched real data, returning",e.length,"points"),e}catch(t){console.error("[TvlHistory] Using fallback TVL history data due to error:",t);let e=[...D].map(e=>({date:e.date,tvl:Math.round(e.tvl*(.98+.04*Math.random()))}));return console.log("[TvlHistory] Returning",e.length,"fallback data points"),console.log("[TvlHistory] Sample fallback data - first point:",e[0]),console.log("[TvlHistory] Sample fallback data - last point:",e[e.length-1]),e}}async function L(){console.log("[TvlByDex] Starting to fetch TVL by DEX data...");try{let e="https://analytics.topledger.xyz/tl/api/queries/12435/results.json?api_key=QoHzXXunvuLg0rrTWyFTNzmIjIoqY5MJhHo3ltZg";console.log("[TvlByDex] Fetching from URL:",e);let t=null;for(let r=0;r<=2;r++){r>0&&(console.log("[TvlByDex] Retry attempt ".concat(r,"/").concat(2,"...")),await new Promise(e=>setTimeout(e,1e3*Math.pow(2,r-1))));let a=new AbortController,l=setTimeout(()=>a.abort(),2e4);try{let t=await fetch(e,{signal:a.signal,headers:{Accept:"application/json","Content-Type":"application/json"}});if(clearTimeout(l),console.log("[TvlByDex] Received response with status:",t.status),!t.ok)throw console.error("[TvlByDex] HTTP error with status:",t.status),Error("HTTP error! Status: ".concat(t.status));let r=await t.json();if(console.log("[TvlByDex] Successfully parsed JSON response, structure:",Object.keys(r).join(", ")),!r)throw console.error("[TvlByDex] No data received from API"),Error("No data received from API");if(!r.query_result)throw console.error("[TvlByDex] No query_result in response:",r),Error("Invalid API response format: missing query_result");if(!r.query_result.data)throw console.error("[TvlByDex] No data in query_result:",r.query_result),Error("Invalid API response format: missing query_result.data");if(!r.query_result.data.rows||!Array.isArray(r.query_result.data.rows))throw console.error("[TvlByDex] No rows array in data:",r.query_result.data),Error("Invalid API response format: missing rows array");console.log("[TvlByDex] Raw rows count:",r.query_result.data.rows.length),r.query_result.data.rows.length>0&&console.log("[TvlByDex] Sample raw row:",r.query_result.data.rows[0]);let n=r.query_result.data.rows.filter(e=>!(!e.block_date||!e.dex||isNaN(parseFloat(e.TVL)))||(console.warn("[TvlByDex] Skipping row with missing required fields:",e),!1)).map(e=>({date:e.block_date,dex:e.dex,tvl:parseFloat(e.TVL)})),o=new Map;n.forEach(e=>{o.has(e.date)||o.set(e.date,new Map);let t=o.get(e.date),r=t.get(e.dex)||0;t.set(e.dex,r+e.tvl)});let s=[];return o.forEach((e,t)=>{e.forEach((e,r)=>{s.push({date:t,dex:r,tvl:e})})}),s.sort((e,t)=>{let r=new Date(e.date).getTime()-new Date(t.date).getTime();return 0!==r?r:e.dex.localeCompare(t.dex)}),console.log("[TvlByDex] Successfully processed ".concat(s.length," data points")),s.length>0&&(console.log("[TvlByDex] First data point:",s[0]),console.log("[TvlByDex] Last data point:",s[s.length-1])),s}catch(e){if(clearTimeout(l),"AbortError"===e.name){if(console.warn("[TvlByDex] Fetch request timed out after ".concat(20," seconds (attempt ").concat(r+1,"/").concat(3,")")),2===r)throw Error("API request timed out after ".concat(3," attempts"));t=e;continue}if(t=e,r<2){console.warn("[TvlByDex] Fetch error (attempt ".concat(r+1,"/").concat(3,"):"),e.message);continue}throw e}}throw t||Error("Failed to fetch TVL by DEX data after all retries")}catch(e){if(console.error("[TvlByDex] Error fetching TVL by DEX data after all attempts:",e),e instanceof TypeError&&e.message.includes("Failed to fetch"))throw console.error("[TvlByDex] Network error: Unable to connect to the API"),Error("Network connectivity issue: Unable to reach the API");throw e}}(()=>{try{let e=new Date,t=e.getFullYear(),r=e.getMonth(),a=D[D.length-1],l=new Date(a.date);if(l.getFullYear()<t||l.getFullYear()===t&&l.getMonth()<r){let e=l.getFullYear(),n=l.getMonth()+1,o=a.tvl;for(;e<t||e===t&&n<=r;){let t=.1*Math.random()-.05;o*=1+t;let r="".concat(e,"-").concat((n+1).toString().padStart(2,"0"),"-01");D.push({date:r,tvl:Math.round(o)}),++n>11&&(n=0,e++)}}}catch(e){console.error("[TvlHistory] Error generating dynamic fallback data:",e)}})();let M=[{date:"2023-01-01",dex:"Raydium",tvl:6e8},{date:"2023-02-01",dex:"Raydium",tvl:65e7},{date:"2023-03-01",dex:"Raydium",tvl:7e8},{date:"2023-04-01",dex:"Raydium",tvl:75e7},{date:"2023-05-01",dex:"Raydium",tvl:8e8},{date:"2023-06-01",dex:"Raydium",tvl:85e7},{date:"2023-07-01",dex:"Raydium",tvl:9e8},{date:"2023-08-01",dex:"Raydium",tvl:95e7},{date:"2023-09-01",dex:"Raydium",tvl:1e9},{date:"2023-10-01",dex:"Raydium",tvl:105e7},{date:"2023-11-01",dex:"Raydium",tvl:11e8},{date:"2023-12-01",dex:"Raydium",tvl:115e7},{date:"2024-01-01",dex:"Raydium",tvl:1175e6},{date:"2024-02-01",dex:"Raydium",tvl:12e8},{date:"2024-03-01",dex:"Raydium",tvl:1225e6},{date:"2024-04-01",dex:"Raydium",tvl:125e7},{date:"2024-05-01",dex:"Raydium",tvl:13e8},{date:"2023-01-01",dex:"Orca",tvl:4e8},{date:"2023-02-01",dex:"Orca",tvl:425e6},{date:"2023-03-01",dex:"Orca",tvl:45e7},{date:"2023-04-01",dex:"Orca",tvl:475e6},{date:"2023-05-01",dex:"Orca",tvl:5e8},{date:"2023-06-01",dex:"Orca",tvl:525e6},{date:"2023-07-01",dex:"Orca",tvl:55e7},{date:"2023-08-01",dex:"Orca",tvl:575e6},{date:"2023-09-01",dex:"Orca",tvl:6e8},{date:"2023-10-01",dex:"Orca",tvl:625e6},{date:"2023-11-01",dex:"Orca",tvl:65e7},{date:"2023-12-01",dex:"Orca",tvl:675e6},{date:"2024-01-01",dex:"Orca",tvl:7e8},{date:"2024-02-01",dex:"Orca",tvl:725e6},{date:"2024-03-01",dex:"Orca",tvl:75e7},{date:"2024-04-01",dex:"Orca",tvl:775e6},{date:"2024-05-01",dex:"Orca",tvl:8e8},{date:"2023-01-01",dex:"Meteora",tvl:2e8},{date:"2023-02-01",dex:"Meteora",tvl:225e6},{date:"2023-03-01",dex:"Meteora",tvl:25e7},{date:"2023-04-01",dex:"Meteora",tvl:275e6},{date:"2023-05-01",dex:"Meteora",tvl:3e8},{date:"2023-06-01",dex:"Meteora",tvl:325e6},{date:"2023-07-01",dex:"Meteora",tvl:35e7},{date:"2023-08-01",dex:"Meteora",tvl:375e6},{date:"2023-09-01",dex:"Meteora",tvl:4e8},{date:"2023-10-01",dex:"Meteora",tvl:425e6},{date:"2023-11-01",dex:"Meteora",tvl:45e7},{date:"2023-12-01",dex:"Meteora",tvl:475e6},{date:"2024-01-01",dex:"Meteora",tvl:5e8},{date:"2024-02-01",dex:"Meteora",tvl:525e6},{date:"2024-03-01",dex:"Meteora",tvl:55e7},{date:"2024-04-01",dex:"Meteora",tvl:575e6},{date:"2024-05-01",dex:"Meteora",tvl:6e8}];async function E(){try{console.log("[TvlByDex] Attempting to fetch real data from API...");let e=await L();return console.log("[TvlByDex] Successfully fetched real data, returning",e.length,"points"),e}catch(t){console.error("[TvlByDex] Using fallback TVL by DEX data due to error:",t);let e=[...M].map(e=>({date:e.date,dex:e.dex,tvl:Math.round(e.tvl*(.98+.04*Math.random()))}));return console.log("[TvlByDex] Returning",e.length,"fallback data points"),console.log("[TvlByDex] Sample fallback data - first point:",e[0]),e}}var C=r(42028);let B=e=>{let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},R=e=>"$".concat((e/1e9).toFixed(1),"B"),F=e=>{try{let t=new Date(e);if(isNaN(t.getTime()))return e;return t.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}catch(t){return e}},O=(e,t)=>{let r;if(!e||0===e.length)return[];let a=new Date;switch(t){case"W":default:r=new Date(a.getTime()-6048e5);break;case"M":r=new Date(a.getFullYear(),a.getMonth()-1,a.getDate());break;case"Q":r=new Date(a.getFullYear(),a.getMonth()-3,a.getDate());break;case"Y":r=new Date(a.getFullYear()-1,a.getMonth(),a.getDate())}return console.log("[TvlHistoryChart] Filtering data with cutoff date:",r.toISOString()),e.filter(e=>{try{return new Date(e.date)>=r}catch(t){return console.error("[TvlHistoryChart] Error parsing date:",e.date,t),!1}})},H={axisLines:v.h5,tickLabels:v.Dc,tvlLine:v.Tj[0],grid:v.Vg},P=e=>{var t;let{timeFilter:r,isModalOpen:o=!1,onModalClose:i=()=>{}}=e,[c,d]=(0,l.useState)([]),[u,x]=(0,l.useState)(!0),[p,S]=(0,l.useState)(null),[D,L]=(0,l.useState)(v.Tj[0]),[M,E]=(0,l.useState)([]),[P,V]=(0,l.useState)(null),[q,_]=(0,l.useState)(!1),[I,z]=(0,l.useState)([]),[W,Y]=(0,l.useState)(null),[X,U]=(0,l.useState)(!1),$=(0,l.useRef)(null),J=(0,l.useRef)(!0),Q=(0,l.useRef)(null),Z=(0,l.useRef)(!0),G=(0,l.useRef)(null),K=(0,l.useRef)(null),[ee,et]=(0,l.useState)({visible:!1,dataPoint:null,left:0,top:0}),er=(0,l.useMemo)(()=>{if(!c||0===c.length)return[];let e=O(c,r);return console.log("[TvlHistoryChart] Filtered data for ".concat(r,": ").concat(e.length," points (from ").concat(c.length," total)")),e.length>0?e:c},[c,r]);(0,l.useEffect)(()=>{E(er),z(er)},[er]);let ea=(0,l.useCallback)(e=>e&&0!==e.length?e.map(e=>({date:e.date,tvl:e.tvl})).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()):[],[]),el=(0,l.useCallback)(e=>{if(!e){q&&(V(null),_(!1),E(er)),$.current&&(clearTimeout($.current),$.current=null,J.current=!0);return}let{x0:t,x1:r}=e,a=new Date(t),l=new Date(r);if(!(isNaN(a.getTime())||isNaN(l.getTime()))&&(V([a,l]),q||_(!0),J.current)){J.current=!1;let e=er.filter(e=>{let t=new Date(e.date);return t>=a&&t<=l});0===e.length?E(er):E(e),$.current=setTimeout(()=>{J.current=!0,$.current=null},100)}},[q,er]),en=(0,l.useCallback)(e=>{if(!e){X&&(Y(null),U(!1),z(er)),Q.current&&(clearTimeout(Q.current),Q.current=null,Z.current=!0);return}let{x0:t,x1:r}=e,a=new Date(t),l=new Date(r);if(!(isNaN(a.getTime())||isNaN(l.getTime()))&&(Y([a,l]),X||U(!0),Z.current)){Z.current=!1;let e=er.filter(e=>{let t=new Date(e.date);return t>=a&&t<=l});0===e.length?z(er):z(e),Q.current=setTimeout(()=>{Z.current=!0,Q.current=null},100)}},[X,er]),eo=(0,l.useCallback)(async()=>{console.log("[TvlHistoryChart] Fetching data with timeFilter:",r),x(!0),S(null);try{let e=await A();if(console.log("[TvlHistoryChart] Data fetch complete, data points:",e.length),!e||0===e.length){S("No data available."),d([]);return}d(e),L(v.Tj[0])}catch(t){console.error("[TvlHistoryChart] Error loading TVL history data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),S(e),d([])}finally{x(!1)}},[]);(0,l.useEffect)(()=>{eo()},[eo]);let es=(0,l.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!er||0===er.length)return;let r=t?K.current:G.current;if(!r)return;let a=r.getBoundingClientRect(),l=e.clientX-a.left,n=e.clientY-a.top,o={left:45},s=a.width-o.left-20;if(l<o.left||l>s+o.left){ee.visible&&et(e=>({...e,visible:!1}));return}try{var i,c,d;let e=t?X?I:er:q?M:er,r=(0,w.A)({domain:[new Date((null==(i=e[0])?void 0:i.date)||""),new Date((null==(c=e[e.length-1])?void 0:c.date)||"")],range:[0,s]}).invert(l-o.left),a=e[0],u=1/0;e.forEach(e=>{try{let t=new Date(e.date),l=Math.abs(t.getTime()-r.getTime());l<u&&(u=l,a=e)}catch(t){console.error("[TvlHistoryChart] Error processing date for tooltip:",e.date,t)}}),a&&(!ee.visible||(null==(d=ee.dataPoint)?void 0:d.date)!==a.date)&&et({visible:!0,dataPoint:a,left:l,top:n})}catch(e){console.error("[TvlHistoryChart] Error handling mouse move:",e)}},[er,ee.visible,null==(t=ee.dataPoint)?void 0:t.date,M,I,q,X]),ei=(0,l.useCallback)(()=>{ee.visible&&et(e=>({...e,visible:!1}))},[ee.visible]),ec=!u&&!p&&er&&er.length>0;(0,l.useEffect)(()=>{console.log("[TvlHistoryChart] Chart display state:",{loading:u,error:p,rawDataLength:(null==c?void 0:c.length)||0,filteredDataLength:(null==er?void 0:er.length)||0,shouldDisplay:ec,timeFilter:r})},[u,p,c,er,ec,r]),(0,l.useEffect)(()=>()=>{$.current&&clearTimeout($.current),Q.current&&clearTimeout(Q.current)},[]);let ed=(0,l.useCallback)(function(e){let{width:t,height:r}=e,l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t<=0||r<=0)return null;let n=l?X?I:er:q?M:er;if(!n||0===n.length)return null;let o={top:25,right:20,bottom:30,left:45},i=t-o.left-o.right,c=r-o.top-o.bottom;if(i<=0||c<=0)return null;try{let e=n.map(e=>new Date(e.date)),d=new Date(Math.min(...e.map(e=>e.getTime()))),u=new Date(Math.max(...e.map(e=>e.getTime()))),h=(0,w.A)({domain:[d,u],range:[0,i]}),f=Math.max(...n.map(e=>e.tvl)),g=(0,b.A)({domain:[0,1.1*f],range:[c,0],nice:!0});return(0,a.jsx)("svg",{width:t,height:r,className:"overflow-visible",children:(0,a.jsxs)(s.A,{left:o.left,top:o.top,children:[(l?X:q)&&(0,a.jsx)("text",{x:0,y:-8,fontSize:8,fill:D,textAnchor:"start",children:"Filtered: ".concat(n.length," item").concat(1!==n.length?"s":"")}),(0,a.jsx)(y.A,{scale:g,width:i,stroke:H.grid,strokeDasharray:"2,3",strokeOpacity:.5,numTicks:5}),(0,a.jsx)(N.A,{data:n,x:e=>{let t=new Date(e.date);return h(t)},y:e=>g(e.tvl),stroke:D,strokeWidth:2,curve:T.G}),(0,a.jsx)(j.A,{top:c,scale:h,stroke:H.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,numTicks:5,tickFormat:e=>e.toLocaleDateString("en-US",{month:"short",day:"numeric"}),tickLabelProps:()=>({fill:H.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"middle",dy:"0.5em"})}),(0,a.jsx)(k.A,{scale:g,stroke:H.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickFormat:e=>R(Number(e)),tickLabelProps:()=>({fill:H.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"end",dx:"-0.6em",dy:"0.25em"})})]})})}catch(e){return console.error("[TvlHistoryChart] Error rendering chart:",e),null}},[er,M,I,q,X,D]),eu=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,a.jsxs)("div",{className:"h-full w-full relative",ref:e?K:G,children:[u&&(0,a.jsx)("div",{className:"absolute inset-0 flex justify-center items-center",children:(0,a.jsx)(h.A,{size:"sm"})}),p&&!u&&(0,a.jsxs)("div",{className:"absolute inset-0 flex flex-col justify-center items-center",children:[(0,a.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:p}),(0,a.jsx)(m.A,{onClick:eo,children:(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(B,{className:"w-3.5 h-3.5"}),(0,a.jsx)("span",{children:"Refresh"})]})})]}),!u&&!p&&(!er||0===er.length)&&(0,a.jsx)("div",{className:"absolute inset-0 flex justify-center items-center",children:(0,a.jsx)("div",{className:"text-gray-400/80 text-xs",children:"No data available for selected time period."})}),ec&&(0,a.jsxs)("div",{className:"flex flex-col h-full w-full",children:[ee.visible&&ee.dataPoint&&(0,a.jsx)(g.A,{title:F(ee.dataPoint.date),items:[{color:D,label:"TVL",value:R(ee.dataPoint.tvl),shape:"circle"}],top:ee.top,left:ee.left,isModal:e}),(0,a.jsx)("div",{className:"h-[85%] w-full overflow-hidden relative",onMouseMove:t=>es(t,e),onMouseLeave:ei,children:(0,a.jsx)(n.A,{children:t=>ed(t,e)})}),(0,a.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,a.jsx)(C.A,{data:ea(er),isModal:e,activeBrushDomain:e?W:P,onBrushChange:e?en:el,onClearBrush:()=>{e?(Y(null),U(!1),z(er)):(V(null),_(!1),E(er))},getDate:e=>e.date,getValue:e=>e.tvl,lineColor:D,margin:{top:5,right:20,bottom:10,left:45}})})]})]})};return(0,a.jsxs)("div",{className:"h-full w-full relative",children:[eu(!1),(0,a.jsx)(f.A,{isOpen:o,onClose:i,title:"TVL History",subtitle:"Historical Total Value Locked (TVL) on Solana DEXs",children:(0,a.jsxs)("div",{className:"p-4 w-full h-full",children:[(0,a.jsx)("div",{className:"h-px bg-gray-900 w-full mb-3"}),(0,a.jsx)("div",{className:"h-[60vh]",children:(0,a.jsxs)("div",{className:"flex h-full",children:[(0,a.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:eu(!0)}),(0,a.jsxs)("div",{className:"w-[10%] h-full pl-3 flex flex-col justify-start items-start",children:[(0,a.jsx)("div",{className:"text-[10px] text-gray-400 mb-2",children:"METRICS"}),(0,a.jsxs)("div",{className:"flex items-center mb-1.5",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 rounded-sm mr-1.5",style:{backgroundColor:D}}),(0,a.jsx)("span",{className:"text-[11px] text-gray-300",children:"TVL"})]})]})]})})]})})]})};var V=r(4503),q=r(45191);let _=e=>{let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},I={grid:v.Vg,axisLines:v.h5,tickLabels:v.Dc},z=e=>{if(!e)return v.Tj[9];try{let t=Array.from(String(e)).reduce((e,t)=>e+t.charCodeAt(0),0);return(0,v.Vy)(t)}catch(e){return console.error("[TvlByDexChart] Error generating fallback color:",e),v.Tj[9]}};function W(e){let{timeFilter:t,isModalOpen:r,onModalClose:o,onDataUpdate:c=()=>{}}=e,[d,u]=(0,l.useState)([]),[x,p]=(0,l.useState)(!0),[w,T]=(0,l.useState)(null),[N,S]=(0,l.useState)([]),[D,A]=(0,l.useState)([]),[L,M]=(0,l.useState)({}),[B,R]=(0,l.useState)({}),[F,O]=(0,l.useState)([]),[H,P]=(0,l.useState)({}),[W,Y]=(0,l.useState)([]),[X,U]=(0,l.useState)([]),[$,J]=(0,l.useState)(null),[Q,Z]=(0,l.useState)(!1),[G,K]=(0,l.useState)([]),[ee,et]=(0,l.useState)(!0),[er,ea]=(0,l.useState)(null),[el,en]=(0,l.useState)(t),[eo,es]=(0,l.useState)(null),[ei,ec]=(0,l.useState)(!1),[ed,eu]=(0,l.useState)([]),[eh,ef]=(0,l.useState)({visible:!1,x:0,y:0,date:"",items:[]}),eg=(0,l.useRef)(null),em=(0,l.useRef)(!0),ev=(0,l.useRef)(null),ex=(0,l.useRef)(!0),ep=(0,l.useRef)(null),ey=(0,l.useRef)(null),ew=e=>e?B[e]||z(e):v.Tj[9];(0,l.useEffect)(()=>{if(ep.current){let{width:e,height:t}=ep.current.getBoundingClientRect();console.log("[TvlByDexChart] Container dimensions:",{width:e,height:t})}else console.warn("[TvlByDexChart] Container ref not available")},[]);let eb=(0,l.useCallback)(async()=>{console.log("[TvlByDexChart] Starting to fetch data with timeFilter:",t),p(!0),T(null);try{let e=await E();if(console.log("[TvlByDexChart] Fetched data:",e.length,"points"),!e||0===e.length){console.warn("[TvlByDexChart] No data returned from API or fallback"),T("No data available from API or fallback"),u([]),O([]),p(!1);return}let r=eT(e,t);console.log("[TvlByDexChart] After time filter:",r.length,"points"),0===r.length?(console.warn("[TvlByDexChart] No data after time filtering"),ek(e)):ek(r)}catch(e){console.error("[TvlByDexChart] Error fetching data:",e),T("Failed to load TVL by DEX data: "+(e instanceof Error?e.message:String(e))),u([]),O([])}finally{p(!1)}},[t]),ej=(0,l.useCallback)(async()=>{console.log("[TvlByDexChart] Starting to fetch modal data with timeFilter:",el),et(!0),ea(null);try{let e=await E();if(console.log("[TvlByDexChart] Fetched modal data:",e.length,"points"),!e||0===e.length){console.warn("[TvlByDexChart] No modal data returned from API or fallback"),ea("No data available from API or fallback"),K([]),eu([]),et(!1);return}let t=eT(e,el);console.log("[TvlByDexChart] After modal time filter:",t.length,"points"),0===t.length?(console.warn("[TvlByDexChart] No data after modal time filtering"),K(e),eu(e)):(K(t),eu(t)),ec(!0),es(null)}catch(e){console.error("[TvlByDexChart] Error fetching modal data:",e),ea("Failed to load TVL by DEX data: "+(e instanceof Error?e.message:String(e))),K([]),eu([])}finally{et(!1)}},[el]),ek=(0,l.useCallback)(e=>{if(!e||0===e.length){u([]),O([]),S([]),A([]),M({}),P({}),R({});return}u(e),O(e);let t=Array.from(new Set(e.map(e=>e.dex))).sort(),r=Array.from(new Set(e.map(e=>e.date))).sort();console.log("[TvlByDexChart] Unique DEXes:",t.length),console.log("[TvlByDexChart] Unique dates:",r.length),S(t),A(r),Y(t),U(r);let a={};r.forEach(e=>{a[e]={},t.forEach(t=>{a[e][t]=0})}),e.forEach(e=>{a[e.date][e.dex]=e.tvl}),M(a),P(a);let l={};e.forEach(e=>{l[e.dex]=(l[e.dex]||0)+e.tvl});let n=t.map(e=>({name:e,tvl:l[e]||0})).sort((e,t)=>t.tvl-e.tvl).map(e=>e.name),o={};if(n.forEach((e,t)=>{o[e]=v.Tj[t%v.Tj.length]}),R(o),Z(!0),J(null),c){let t=e.reduce((e,t)=>e+t.tvl,0),r={};e.forEach(e=>{r[e.dex]=(r[e.dex]||0)+e.tvl}),c(Object.entries(r).map(e=>{let[r,a]=e;return{dex:r,tvl:a,percentage:t>0?a/t*100:0}}).sort((e,t)=>t.tvl-e.tvl))}},[c]),eT=(e,t)=>{if(!e||0===e.length)return[];let r=[...e].sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),a=new Date,l=new Date;switch(t){case"W":default:l.setDate(a.getDate()-7);break;case"M":l.setMonth(a.getMonth()-1);break;case"Q":l.setMonth(a.getMonth()-3);break;case"Y":l.setFullYear(a.getFullYear()-1)}return console.log("[TvlByDexChart] Applying time filter:",t,"cutoff date:",l.toISOString().split("T")[0]),r.filter(e=>new Date(e.date)>=l)},eN=(0,l.useCallback)(e=>{if(!e||0===e.length)return[];let t={};return e.forEach(e=>{t[e.date]=(t[e.date]||0)+e.tvl}),Object.entries(t).map(e=>{let[t,r]=e;return{date:t,tvl:r}}).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime())},[]),eS=(0,l.useCallback)(e=>{if(!e){Q&&(J(null),Z(!1),O(d),U(D),Y(N),P(L)),eg.current&&(clearTimeout(eg.current),eg.current=null,em.current=!0);return}let{x0:t,x1:r}=e,a=new Date(t),l=new Date(r);if(!(isNaN(a.getTime())||isNaN(l.getTime()))&&(J([a,l]),Q||Z(!0),em.current)){em.current=!1;let e=d.filter(e=>{let t=new Date(e.date);return t>=a&&t<=l});if(0===e.length)O(d),U(D),Y(N),P(L);else{O(e);let t=Array.from(new Set(e.map(e=>e.date))).sort(),r=Array.from(new Set(e.map(e=>e.dex))).sort();U(t),Y(r);let a={};if(t.forEach(e=>{a[e]={},r.forEach(t=>{a[e][t]=0})}),e.forEach(e=>{a[e.date][e.dex]=e.tvl}),P(a),c){let t=e.reduce((e,t)=>e+t.tvl,0),r={};e.forEach(e=>{r[e.dex]=(r[e.dex]||0)+e.tvl}),c(Object.entries(r).map(e=>{let[r,a]=e;return{dex:r,tvl:a,percentage:t>0?a/t*100:0}}).sort((e,t)=>t.tvl-e.tvl))}}eg.current=setTimeout(()=>{em.current=!0,eg.current=null},100)}},[Q,d,D,N,L,c]),eD=(0,l.useCallback)(e=>{if(!e){ei&&(es(null),ec(!1),eu(G)),ev.current&&(clearTimeout(ev.current),ev.current=null,ex.current=!0);return}let{x0:t,x1:r}=e,a=new Date(t),l=new Date(r);if(!(isNaN(a.getTime())||isNaN(l.getTime()))&&(es([a,l]),ei||ec(!0),ex.current)){ex.current=!1;let e=G.filter(e=>{let t=new Date(e.date);return t>=a&&t<=l});0===e.length?eu(G):eu(e),ev.current=setTimeout(()=>{ex.current=!0,ev.current=null},100)}},[ei,G]),eA=(0,l.useCallback)(function(e,t,r,a){let l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=l?ey.current:ep.current;if(!n)return;let o=n.getBoundingClientRect();ef({visible:!0,x:e.clientX-o.left,y:e.clientY-o.top,date:t,items:[{dex:r,tvl:a,color:ew(r)}]})},[]);(0,l.useCallback)(function(e,t,r,a){let l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],n=l?ey.current:ep.current;if(!n)return;let o=n.getBoundingClientRect(),s=e.clientX-o.left,i=e.clientY-o.top,c=a.map(e=>{var a;return{dex:e,tvl:(null==(a=r[t])?void 0:a[e])||0,color:ew(e)}}).filter(e=>e.tvl>0).sort((e,t)=>t.tvl-e.tvl);ef({visible:!0,x:s,y:i,date:t,items:c})},[]);let eL=(0,l.useCallback)(()=>{eh.visible&&ef(e=>({...e,visible:!1}))},[eh.visible]);(0,l.useEffect)(()=>{eb()},[eb]),(0,l.useEffect)(()=>{r&&(console.log("Modal opened - initializing with data"),en(t),K(d),eu(F),es($),ec(Q),et(!1),0===d.length&&ej())},[r,t,d,F,$,Q,ej]),(0,l.useCallback)(e=>{console.log("Modal time filter changed to:",e),en(e)},[]),(0,l.useEffect)(()=>{r&&ej()},[el,r,ej]);let eM=e=>null==e||isNaN(e)?"$0":e>=1e9?"$".concat((e/1e9).toFixed(1),"B"):e>=1e6?"$".concat((e/1e6).toFixed(1),"M"):e>=1e3?"$".concat((e/1e3).toFixed(1),"K"):"$".concat(e.toFixed(0)),eE=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),eC=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];console.log("[TvlByDexChart] Rendering chart. Modal:",e);let t=e?ee:x,r=e?er:w,l=e?ei?ed:G:Q?F:d,o=e?[...new Set(l.map(e=>e.date))].sort():X,c=e?[...new Set(l.map(e=>e.dex))].sort():W,u=e?{}:H;if(t)return(0,a.jsx)(h.A,{size:"sm"});if(r||0===l.length)return(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,a.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:r||"No data available"}),(0,a.jsx)(m.A,{onClick:e?ej:eb,children:(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(_,{className:"w-3.5 h-3.5"}),(0,a.jsx)("span",{children:"Refresh"})]})})]});if(0===o.length||0===c.length)return(0,a.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,a.jsxs)("div",{className:"text-yellow-500 text-sm",children:["Unable to process data correctly. Dates: ",o.length,", DEXes: ",c.length]})});let f={};e&&(o.forEach(e=>{f[e]={},c.forEach(t=>{f[e][t]=0})}),l.forEach(e=>{f[e.date]&&(f[e.date][e.dex]=e.tvl)}));let p=e?f:u,T=o.map(e=>{let t={date:e};return c.forEach(r=>{var a;t[r]=(null==(a=p[e])?void 0:a[r])||0}),t});return(0,a.jsxs)("div",{className:"flex flex-col h-full w-full",ref:e?ey:ep,children:[eh.visible&&eh.items.length>0&&(0,a.jsx)(g.A,{title:eE(eh.date),items:eh.items.map(e=>({color:e.color,label:e.dex,value:eM(e.tvl),shape:"square"})),top:eh.y,left:eh.x,isModal:e}),(0,a.jsx)("div",{className:"h-[85%] w-full overflow-hidden relative",onMouseLeave:eL,onMouseMove:t=>{let r=e?ey.current:ep.current;if(!r)return;let a=r.getBoundingClientRect(),l=t.clientX-a.left,n=t.clientY-a.top,o=e?ei?ed:G:Q?F:d,s=e?[...new Set(o.map(e=>e.dex))].sort():W,i=e?[...new Set(o.map(e=>e.date))].sort():X;if(0===i.length)return;let c={left:60,right:20},u=a.width-c.left-c.right;if(l<c.left||l>u+c.left)return;let h=Math.min(i.length-1,Math.max(0,Math.floor((l-c.left)/(u/i.length)))),f=i[h],g={};e?s.forEach(e=>{let t=o.filter(t=>t.dex===e&&t.date===f);g[e]=t.reduce((e,t)=>e+t.tvl,0)}):g=H[f]||{},ef({visible:!0,x:l,y:n,date:f,items:s.map(e=>({dex:e,tvl:g[e]||0,color:ew(e)})).filter(e=>e.tvl>0).sort((e,t)=>t.tvl-e.tvl)})},children:(0,a.jsx)(n.A,{children:t=>{let{width:r,height:l}=t;if(r<=0||l<=0)return null;let n={top:20,right:20,bottom:40,left:60},d=r-n.left-n.right,u=l-n.top-n.bottom;if(d<=0||u<=0)return null;let h=(0,q.A)({domain:o,padding:.3,range:[0,d]}),f=0;o.forEach(e=>{let t=0;c.forEach(r=>{var a;t+=(null==(a=p[e])?void 0:a[r])||0}),f=Math.max(f,t)}),0===f&&(f=1);let g=(0,b.A)({domain:[0,1.1*f],range:[u,0],nice:!0}),m=(0,i.A)({domain:c,range:c.map(e=>ew(e))});return(0,a.jsx)("svg",{width:r,height:l,className:"overflow-visible",children:(0,a.jsxs)(s.A,{left:n.left,top:n.top,children:[(0,a.jsx)(y.A,{scale:g,width:d,stroke:I.grid,strokeDasharray:"2,3",strokeOpacity:.5,numTicks:5}),(0,a.jsx)(V.A,{data:T,keys:c,x:e=>e.date,xScale:h,yScale:g,color:m,children:t=>t.map(t=>t.bars.map(r=>(0,a.jsx)("rect",{x:r.x,y:r.y,height:r.height,width:r.width,fill:r.color,opacity:eh.visible&&eh.date===r.bar.data.date?.9:.7,rx:2,onMouseEnter:t=>eA(t,r.bar.data.date,c[r.index],r.bar.data[c[r.index]],e),onMouseMove:t=>{let r=e?ey.current:ep.current;if(!r)return;let a=r.getBoundingClientRect(),l=t.clientX-a.left,n=t.clientY-a.top;ef(e=>({...e,x:l,y:n}))}},"bar-stack-".concat(t.index,"-").concat(r.index))))}),(0,a.jsx)(j.A,{top:u,scale:h,stroke:I.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,tickLabelProps:()=>({fill:I.tickLabels,fontSize:10,textAnchor:"middle",dy:"0.5em"}),tickFormat:e=>eE(e.toString()),numTicks:Math.min(6,o.length)}),(0,a.jsx)(k.A,{scale:g,stroke:I.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickFormat:e=>eM(Number(e)),tickLabelProps:()=>({fill:I.tickLabels,fontSize:10,textAnchor:"end",dx:"-0.6em",dy:"0.25em"})})]})})}})}),(0,a.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,a.jsx)(C.A,{data:eN(e?G:d),isModal:e,activeBrushDomain:e?eo:$,onBrushChange:e?eD:eS,onClearBrush:()=>{e?(es(null),ec(!1),eu(G)):(J(null),Z(!1),O(d),U(D),Y(N),P(L))},getDate:e=>e.date,getValue:e=>e.tvl,lineColor:v.Tj[0],margin:{top:5,right:20,bottom:10,left:60}})})]})};return(0,a.jsxs)("div",{className:"h-full w-full relative",children:[eC(!1),(0,a.jsx)(f.A,{isOpen:r,onClose:o,title:"TVL by DEX",subtitle:"Analysis of total value locked across Solana DEXes",children:(()=>{let e=[...new Set((ei?ed:G).map(e=>e.dex))].sort();return(0,a.jsxs)("div",{className:"p-4 w-full h-full",children:[(0,a.jsx)("div",{className:"h-px bg-gray-900 w-full mb-3"}),(0,a.jsx)("div",{className:"h-[60vh]",children:(0,a.jsxs)("div",{className:"flex h-full",children:[(0,a.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:eC(!0)}),(0,a.jsx)("div",{className:"w-[10%] h-full pl-3 flex flex-col justify-start items-start",children:!ee&&ed.length>0?(0,a.jsx)("div",{className:"flex flex-col gap-2 max-h-[600px] w-[125px] overflow-y-auto [&::-webkit-scrollbar]:w-1.5  [&::-webkit-scrollbar-track]:bg-transparent  [&::-webkit-scrollbar-thumb]:bg-gray-700/40 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:hover:bg-gray-600/60 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-gray-700/40",children:e.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 mr-1.5 rounded-sm mt-0.5",style:{background:ew(e)}}),(0,a.jsx)("span",{className:"text-[11px] text-gray-300",children:e})]},"modal-legend-".concat(t)))}):(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 bg-purple-500 mr-2 rounded-sm mt-0.5 animate-pulse"}),(0,a.jsx)("span",{className:"text-[11px] text-gray-300",children:"Loading..."})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 bg-blue-400 mr-2 rounded-sm mt-0.5 animate-pulse"}),(0,a.jsx)("span",{className:"text-[11px] text-gray-300",children:"Loading..."})]})]})})]})})]})})()})]})}var Y=r(21903),X=r(96565);let U=["#a78bfa","#60a5fa","#34d399","#f97316","#f43f5e","#facc15","#14b8a6","#8b5cf6","#ec4899","#6b7280"];function $(){let[e,t]=(0,l.useState)("W"),[r,n]=(0,l.useState)(!1),[o,s]=(0,l.useState)(!1),[i,c]=(0,l.useState)(!1),[d,h]=(0,l.useState)(!1),[f,g]=(0,l.useState)(!1),[m,v]=(0,l.useState)(!1),[x,y]=(0,l.useState)([]),[w,b]=(0,l.useState)(!0),[j,k]=(0,l.useState)([]),[T,N]=(0,l.useState)(!0);(0,l.useEffect)(()=>{console.log("[DexTvlPage] Current timeFilter:",e),(async()=>{try{console.log("[DexTvlPage] Testing TVL history data fetch...");let e=await A();console.log("[DexTvlPage] TVL history test fetch result:",e.length,"data points")}catch(e){console.error("[DexTvlPage] Error in test fetch:",e)}})()},[e]),(0,l.useEffect)(()=>{(async()=>{b(!0);try{let e=await u();y(e)}catch(e){console.error("Error fetching TVL by Pool data:",e)}finally{b(!1)}})()},[]),(0,l.useEffect)(()=>{(async()=>{N(!0);try{let e=await E();if(e&&e.length>0){let t=e.reduce((e,t)=>e+t.tvl,0),r=e.map(e=>({dex:e.dex,tvl:e.tvl,percentage:e.tvl/t*100}));k(r)}}catch(e){console.error("Error fetching TVL by DEX data:",e)}finally{N(!1)}})()},[]);let S=async()=>{if(!d){h(!0);try{console.log("Downloading TVL data..."),await new Promise(e=>setTimeout(e,1e3)),alert("Download feature coming soon!")}catch(e){console.error("Error downloading TVL data:",e)}finally{h(!1)}}},D=async()=>{if(!f){g(!0);try{console.log("Downloading TVL by Pool data..."),await new Promise(e=>setTimeout(e,1e3)),alert("Download feature coming soon!")}catch(e){console.error("Error downloading TVL by Pool data:",e)}finally{g(!1)}}},L=async()=>{if(!m){v(!0);try{console.log("Downloading TVL by DEX data..."),await new Promise(e=>setTimeout(e,1e3)),alert("Download feature coming soon!")}catch(e){console.error("Error downloading TVL by DEX data:",e)}finally{v(!1)}}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4",children:[(0,a.jsx)(Y.A,{title:"TVL History",description:"Tracking total value locked across the Solana ecosystem",accentColor:"blue",onExpandClick:()=>n(!0),onDownloadClick:S,isDownloading:d,children:(0,a.jsx)(P,{timeFilter:e,isModalOpen:r,onModalClose:()=>n(!1)})}),(0,a.jsx)(Y.A,{title:"TVL by Pool",description:"Breakdown of TVL by liquidity pool",accentColor:"purple",onExpandClick:()=>s(!0),onDownloadClick:D,isDownloading:f,legendWidth:"1/4",legend:w?(0,a.jsx)(X.A,{label:"Loading...",color:"#a78bfa",isLoading:!0}):x.map((e,t)=>(0,a.jsx)(X.A,{label:"".concat(e.pool," (").concat(e.percentage.toFixed(1),"%)"),color:U[t%U.length],tooltipText:"".concat(e.pool,": $").concat(e.tvl.toLocaleString()," (").concat(e.percentage.toFixed(1),"%)")},"pool-legend-".concat(t))),children:(0,a.jsx)(p,{isModalOpen:o,onModalClose:()=>s(!1)})})]}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)(Y.A,{title:"TVL by DEX",description:"Distribution of value locked across decentralized exchanges",accentColor:"green",onExpandClick:()=>c(!0),onDownloadClick:L,isDownloading:m,legendWidth:"1/4",legend:T?(0,a.jsx)(X.A,{label:"Loading...",color:"#34d399",isLoading:!0}):j.map((e,t)=>(0,a.jsx)(X.A,{label:"".concat(e.dex," (").concat(e.percentage.toFixed(1),"%)"),color:U[t%U.length],tooltipText:"".concat(e.dex,": $").concat(e.tvl.toLocaleString()," (").concat(e.percentage.toFixed(1),"%)")},"dex-legend-".concat(t))),children:(0,a.jsx)(W,{timeFilter:e,isModalOpen:i,onModalClose:()=>c(!1)})})})]})}},60286:(e,t,r)=>{Promise.resolve().then(r.bind(r,60247))},78398:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(95442),l=(0,r(70222).A)("domain","range","reverse","unknown");function n(e){return l((0,a.A)(),e)}},81838:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(95155);r(12115);let l=e=>{let{type:t,color:r}=e;return"circle"===t?(0,a.jsx)("div",{className:"h-2 w-2 rounded-full mr-1.5",style:{backgroundColor:r}}):(0,a.jsx)("div",{className:"h-2 w-2 rounded-sm mr-1.5",style:{backgroundColor:r}})},n=(e,t)=>{if(/^\d{4}-\d{2}-\d{2}/.test(e)||/^\d{2}\/\d{2}\/\d{4}/.test(e)){let r=new Date(e);if(!isNaN(r.getTime())){if("W"===t)return"Week of ".concat(r.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"}));if("M"===t)return r.toLocaleDateString("en-US",{month:"short",year:"numeric"});if("Q"===t){let e=Math.floor(r.getMonth()/3)+1;return"Q".concat(e,", ").concat(r.getFullYear())}else if("Y"===t)return r.getFullYear().toString();return r.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})}}return/^[A-Za-z]{3}\s\d{4}$/.test(e)||/^Q[1-4]\s\d{4}$/.test(e)||/^\d{4}$/.test(e),e},o=(e,t)=>{if("string"==typeof e){if(t){let r={USD:"$",EUR:"€",GBP:"\xa3",JPY:"\xa5",CNY:"\xa5",SOL:"SOL"},a=r[t]||t;if("SOL"===t){if(e.includes("SOL"))return e;for(let[t,a]of Object.entries(r))if("SOL"!==t&&e.startsWith(a))return"".concat(e.substring(a.length)," SOL");return"".concat(e," SOL")}for(let[l,n]of Object.entries(r))if(e.startsWith(n)&&l!==t)return e.replace(n,a)}return e}if("number"==typeof e){if(t)switch(t){case"USD":return"$".concat(e.toLocaleString());case"EUR":return"€".concat(e.toLocaleString());case"GBP":return"\xa3".concat(e.toLocaleString());case"JPY":case"CNY":return"\xa5".concat(e.toLocaleString());case"SOL":return"".concat(e.toLocaleString()," SOL");default:return"".concat(t).concat(e.toLocaleString())}return e.toLocaleString()}return String(e)},s=e=>{let{title:t,items:r,top:s,left:i,isModal:c=!1,timeFilter:d,currencyFilter:u}=e,h=r.some(e=>e.axis),f=n(t,d);return(0,a.jsxs)("div",{className:"absolute z-10 pointer-events-none bg-gray-900/95 shadow-lg border border-gray-800 rounded-md p-2 text-xs min-w-[120px]",style:{top:"".concat(s,"px"),left:i>(c?500:250)?"".concat(i-160,"px"):"".concat(i+10,"px"),transform:"translateY(-100%)"},children:[(0,a.jsx)("div",{className:"text-gray-400 text-[10px] font-normal pb-1 mb-1 border-b border-gray-800",children:f}),(0,a.jsx)("div",{className:"space-y-1",children:r.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,a.jsx)(l,{type:e.shape||"circle",color:e.color}),(0,a.jsx)("span",{className:"text-gray-400 font-normal ml-2",children:e.label}),h&&e.axis&&(0,a.jsxs)("span",{className:"ml-1 text-[9px] text-gray-500",children:["(",e.axis," axis)"]})]}),(0,a.jsx)("span",{className:"text-gray-300 font-normal ml-4",children:o(e.value,u)})]},"tooltip-item-".concat(t)))})]})}},95442:(e,t,r)=>{"use strict";r.d(t,{A:()=>function e(){var t=new a,r=[],l=[],n=s;function i(e){let a=t.get(e);if(void 0===a){if(n!==s)return n;t.set(e,a=r.push(e)-1)}return l[a%l.length]}return i.domain=function(e){if(!arguments.length)return r.slice();for(let l of(r=[],t=new a,e))t.has(l)||t.set(l,r.push(l)-1);return i},i.range=function(e){return arguments.length?(l=Array.from(e),i):l.slice()},i.unknown=function(e){return arguments.length?(n=e,i):n},i.copy=function(){return e(r,l).unknown(n)},o.C.apply(i,arguments),i}});class a extends Map{constructor(e,t=n){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(let[t,r]of e)this.set(t,r)}get(e){return super.get(l(this,e))}has(e){return super.has(l(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},r){let a=t(r);return e.has(a)?e.get(a):(e.set(a,r),r)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},r){let a=t(r);return e.has(a)&&(r=e.get(a),e.delete(a)),r}(this,e))}}function l({_intern:e,_key:t},r){let a=t(r);return e.has(a)?e.get(a):r}function n(e){return null!==e&&"object"==typeof e?e.valueOf():e}var o=r(28749);let s=Symbol("implicit")},96565:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(95155);r(12115);let l=e=>{let{label:t,color:r,shape:l="square",isLoading:n=!1,tooltipText:o}=e;return(0,a.jsxs)("div",{className:"flex items-start whitespace-nowrap",children:[(0,a.jsx)("div",{className:"w-2 h-2 mr-2 ".concat("circle"===l?"rounded-full":"rounded-sm"," mt-0.5 ").concat(n?"animate-pulse":""),style:{background:r}}),(0,a.jsx)("span",{className:"text-xs text-gray-300 truncate",title:o||t,children:t.length>20&&!o?"".concat(t.substring(0,20),"..."):t})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[4410,5083,166,1182,5955,4685,8441,1684,7358],()=>t(60286)),_N_E=e.O()}]);