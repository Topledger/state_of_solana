(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1386],{23641:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ea});var r=a(95155),l=a(12115);async function s(){console.log("[TradersData] Starting to fetch traders data");try{let e="https://analytics.topledger.xyz/tl/api/queries/13181/results.json?api_key=fLzwXGF8j4St6XvrckEAe1gjQRHKveWvvCafx2Zz";console.log("[TradersData] Fetching from URL:",e);let t=null;for(let a=0;a<=2;a++){a>0&&(console.log("[TradersData] Retry attempt ".concat(a,"/").concat(2,"...")),await new Promise(e=>setTimeout(e,1e3*Math.pow(2,a-1))));let r=new AbortController,l=setTimeout(()=>r.abort(),2e4);try{let t=await fetch(e,{signal:r.signal,headers:{Accept:"application/json","Content-Type":"application/json"}});if(clearTimeout(l),console.log("[TradersData] Received response with status:",t.status),!t.ok)throw console.error("[TradersData] HTTP error with status:",t.status),Error("HTTP error! Status: ".concat(t.status));let a=await t.json();if(console.log("[TradersData] Successfully parsed JSON response, structure:",Object.keys(a).join(", ")),!a)throw console.error("[TradersData] No data received from API"),Error("No data received from API");if(!a.query_result)throw console.error("[TradersData] No query_result in response:",a),Error("Invalid API response format: missing query_result");if(!a.query_result.data)throw console.error("[TradersData] No data in query_result:",a.query_result),Error("Invalid API response format: missing query_result.data");if(!a.query_result.data.rows||!Array.isArray(a.query_result.data.rows))throw console.error("[TradersData] No rows array in data:",a.query_result.data),Error("Invalid API response format: missing rows array");console.log("[TradersData] Raw rows count:",a.query_result.data.rows.length),a.query_result.data.rows.length>0&&console.log("[TradersData] Sample raw row:",a.query_result.data.rows[0]);let s=a.query_result.data.rows.filter(e=>!!e.partition_0&&"number"==typeof e.active_signer&&"number"==typeof e.new_signer&&"number"==typeof e.new_traders_activation_ratio&&"number"==typeof e.cumulative_signer||(console.warn("[TradersData] Skipping row with missing data:",e),!1)).map(e=>({date:e.partition_0,active_signer:e.active_signer,new_signer:e.new_signer,new_traders_activation_ratio:parseFloat(e.new_traders_activation_ratio),cumulative_signer:e.cumulative_signer}));return s.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),console.log("[TradersData] Successfully processed ".concat(s.length," data points")),s.length>0&&(console.log("[TradersData] First data point:",s[0]),console.log("[TradersData] Last data point:",s[s.length-1])),s}catch(e){if(clearTimeout(l),"AbortError"===e.name){if(console.warn("[TradersData] Fetch request timed out after ".concat(20," seconds (attempt ").concat(a+1,"/").concat(3,")")),2===a)throw Error("API request timed out after ".concat(3," attempts"));t=e;continue}if(t=e,a<2){console.warn("[TradersData] Fetch error (attempt ".concat(a+1,"/").concat(3,"):"),e.message);continue}throw e}}throw t||Error("Failed to fetch traders data after all retries")}catch(e){if(console.error("[TradersData] Error fetching traders data after all attempts:",e),e instanceof TypeError&&e.message.includes("Failed to fetch"))throw console.error("[TradersData] Network error: Unable to connect to the API"),Error("Network connectivity issue: Unable to reach the API");throw e}}function n(e){return e>=1e9?"".concat((e/1e9).toFixed(2),"B"):e>=1e6?"".concat((e/1e6).toFixed(2),"M"):e>=1e3?"".concat((e/1e3).toFixed(2),"K"):e.toFixed(0)}var i=a(52594),o=a(79111),c=a(41995),d=a(71734),u=a(13600),m=a(50109),h=a(72630),g=a(58888),f=a(74537),x=a(45191),v=a(4904),p=a(51078),w=a(81838),b=a(42028),y=a(7545),T=a(76167),j=a(6828);let k=e=>{let{className:t="w-4 h-4"}=e;return(0,r.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},N={grid:j.Vg,axisLines:j.h5,tickLabels:j.Dc,activeTraders:j.Tj[0],newTraders:j.Tj[1],activationRatio:j.Tj[2]},S=e=>n(e),A=e=>n(e),D=e=>"".concat((100*e).toFixed(1),"%"),C=e=>new Date(e).toLocaleDateString("en-US",{month:"short",year:"numeric"});function E(e){var t;let a,{isModalOpen:E,onModalClose:_}=e,[L,M]=(0,l.useState)([]),[F,P]=(0,l.useState)(!0),[R,q]=(0,l.useState)(null),[B,I]=(0,l.useState)({activeTraders:j.Tj[0],newTraders:j.Tj[1],activationRatio:j.Tj[2]}),[O,z]=(0,l.useState)([]),[U,V]=(0,l.useState)(null),[W,X]=(0,l.useState)(!1),[Y,H]=(0,l.useState)([]),[K,G]=(0,l.useState)(!0),[Z,Q]=(0,l.useState)(null),[$,J]=(0,l.useState)(null),[ee,et]=(0,l.useState)(!1),[ea,er]=(0,l.useState)([]),[el,es]=(0,l.useState)({visible:!1,dataPoint:null,left:0,top:0}),en=(0,l.useRef)(null),ei=(0,l.useRef)(null),eo=(0,l.useRef)(null),ec=(0,l.useRef)(!0),ed=(0,l.useRef)(null),eu=(0,l.useRef)(!0),em=e=>{if(!e||0===e.length)return;let t=0,a=0,r=0;e.forEach(e=>{t+=e.active_signer,a+=e.new_signer,r+=e.new_traders_activation_ratio});let l=[{name:"activeTraders",total:t},{name:"newTraders",total:a},{name:"activationRatio",total:r}].sort((e,t)=>t.total-e.total),s={activeTraders:j.Tj[0],newTraders:j.Tj[1],activationRatio:j.Tj[2]};l.forEach((e,t)=>{s[e.name]=j.Tj[t]}),I(s)},eh=(0,l.useCallback)(async()=>{console.log("[TradersActivityChart] Starting to fetch data"),P(!0),q(null);try{let e=await s();console.log("[TradersActivityChart] Fetched data:",e.length,"points"),e&&0!==e.length?(M(e),z(e),X(!0),V(null),em(e)):(console.warn("[TradersActivityChart] No data returned from API"),q("No data available from API"),M([]),z([]))}catch(t){console.error("[TradersActivityChart] Error fetching data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),q(e),M([]),z([])}finally{P(!1)}},[]),eg=(0,l.useCallback)(async()=>{console.log("[TradersActivityChart] Starting to fetch modal data"),G(!0),Q(null);try{let e=await s();console.log("[TradersActivityChart] Fetched modal data:",e.length,"points"),e&&0!==e.length?(H(e),er(e),et(!0),J(null),em(e)):(console.warn("[TradersActivityChart] No modal data returned from API"),Q("No data available from API"),H([]),er([]))}catch(t){console.error("[TradersActivityChart] Error fetching modal data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),Q(e),H([]),er([])}finally{G(!1)}},[]),ef=(0,l.useCallback)(e=>{if(!e){W&&(V(null),X(!1)),eo.current&&(clearTimeout(eo.current),eo.current=null,ec.current=!0);return}let{x0:t,x1:a}=e,r=new Date(t),l=new Date(a);!(isNaN(r.getTime())||isNaN(l.getTime()))&&(V([r,l]),W||X(!0))},[W]),ex=(0,l.useCallback)(e=>{if(!e){ee&&(J(null),et(!1)),ed.current&&(clearTimeout(ed.current),ed.current=null,eu.current=!0);return}let{x0:t,x1:a}=e,r=new Date(t),l=new Date(a);!(isNaN(r.getTime())||isNaN(l.getTime()))&&(J([r,l]),ee||et(!0))},[ee]);(0,l.useEffect)(()=>{if(0===L.length){O.length>0&&z([]);return}if(!U&&W)return void z(L);if(!U||!W){O.length!==L.length&&z(L);return}if(!ec.current)return;let[e,t]=U,a=e.getTime(),r=t.getTime(),l=L.filter(e=>{let t=new Date(e.date).getTime();return t>=a&&t<=r});z(l.length>0?l:L),ec.current=!1,eo.current&&clearTimeout(eo.current),eo.current=setTimeout(()=>{ec.current=!0},100)},[U,L,W,O.length]),(0,l.useEffect)(()=>{if(0===Y.length){ea.length>0&&er([]);return}if(!$&&ee)return void er(Y);if(!$||!ee){ea.length!==Y.length&&er(Y);return}if(!eu.current)return;let[e,t]=$,a=e.getTime(),r=t.getTime(),l=Y.filter(e=>{let t=new Date(e.date).getTime();return t>=a&&t<=r});er(l.length>0?l:Y),eu.current=!1,ed.current&&clearTimeout(ed.current),ed.current=setTimeout(()=>{eu.current=!0},100)},[$,Y,ee,ea.length]);let ev=(0,l.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("TradersActivity - Mouse move event",{isModal:t,clientX:e.clientX,clientY:e.clientY});let a=t?ei.current:en.current;if(!a)return;let r=a.getBoundingClientRect(),l=e.clientX-r.left,s=e.clientY-r.top,n={left:60},i=r.width-n.left-60;if(l<n.left||l>i+n.left){el.visible&&(console.log("TradersActivity - Mouse outside chart area, hiding tooltip"),es(e=>({...e,visible:!1})));return}let o=[...t?ee?ea:Y:W?O:L].sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),c=Math.floor((l-n.left)/(i/o.length));if(c>=0&&c<o.length){var d;let e=o[c];el.visible&&(null==(d=el.dataPoint)?void 0:d.date)===e.date||(console.log("TradersActivity - Setting tooltip data",{dataPoint:e,left:l,top:s}),es({visible:!0,dataPoint:e,left:l,top:s}))}},[L,O,Y,ea,W,ee,el.visible,null==(t=el.dataPoint)?void 0:t.date]),ep=(0,l.useCallback)(()=>{el.visible&&(console.log("TradersActivity - Mouse leave, hiding tooltip"),es(e=>({...e,visible:!1})))},[el.visible]);(0,l.useEffect)(()=>{eh()},[eh]),(0,l.useEffect)(()=>()=>{eo.current&&clearTimeout(eo.current),ed.current&&clearTimeout(ed.current)},[]),(0,l.useEffect)(()=>{E&&(L.length>0?(H(L),er(O),G(!1),Q(null),et(!0),J(null)):eg())},[E,L,O,eg]);let ew=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=a?Y:L,s=a?ee?ea:Y:W?O:L,i=a?K:F,j=a?Z:R,E=a?$:U,_=a?ex:ef,M=a?()=>{J(null),et(!1)}:()=>{V(null),X(!1)};if(i)return(0,r.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,r.jsx)(p.A,{size:"sm"})});if(j||0===l.length)return(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,r.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:j||"No data available"}),(0,r.jsx)(y.A,{onClick:a?eg:eh,children:(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)(k,{className:"w-3.5 h-3.5"}),(0,r.jsx)("span",{children:"Refresh"})]})})]});let P=[...s].sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime());return(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[el.visible&&el.dataPoint&&(0,r.jsx)(w.A,{title:new Date(el.dataPoint.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),items:[{color:B.activeTraders,label:"Active Traders",value:S(el.dataPoint.active_signer),shape:"square"},{color:B.newTraders,label:"New Traders",value:A(el.dataPoint.new_signer),shape:"circle"},{color:B.activationRatio,label:"Activation Ratio",value:D(el.dataPoint.new_traders_activation_ratio),shape:"circle"}],top:el.top,left:el.left,isModal:a}),(0,r.jsx)("div",{className:"h-[85%] w-full overflow-hidden relative",onMouseMove:e=>ev(e,a),onMouseLeave:ep,ref:a?ei:en,children:(0,r.jsx)(o.A,{children:e=>{let{width:t,height:l}=e;if(t<=0||l<=0)return null;let s={top:20,right:60,bottom:40,left:60},i=t-s.left-s.right,o=l-s.top-s.bottom;if(i<=0||o<=0)return null;let p=1.1*Math.max(Math.max(...P.map(e=>e.active_signer),0),Math.max(...P.map(e=>e.new_signer),0)),w=P.map(e=>new Date(e.date)),b=(0,x.A)({domain:w,padding:.3,range:[0,i]}),y=(0,v.A)({domain:[0,p],range:[o,0],nice:!0}),j=(0,v.A)({domain:[0,1.1],range:[o,0],nice:!0});return(0,r.jsx)("svg",{width:t,height:l,className:"overflow-visible",children:(0,r.jsxs)(c.A,{left:s.left,top:s.top,children:[(0,r.jsx)(m.A,{scale:y,width:i,stroke:N.grid,strokeDasharray:"2,3",strokeOpacity:.5,numTicks:5}),P.map((e,t)=>{var a;let l=b(new Date(e.date)),s=b.bandwidth(),n=o-y(e.active_signer);return void 0===l||n<0?null:(0,r.jsx)(d.A,{x:l,y:o-n,width:s,height:n,fill:B.activeTraders,opacity:(null==(a=el.dataPoint)?void 0:a.date)===e.date?1:.7,rx:2},"bar-".concat(t))}),(0,r.jsx)(u.A,{data:P,x:e=>{var t;return(null!=(t=b(new Date(e.date)))?t:0)+b.bandwidth()/2},y:e=>y(e.new_signer),stroke:B.newTraders,strokeWidth:1.5,curve:T.G}),(0,r.jsx)(u.A,{data:P,x:e=>{var t;return(null!=(t=b(new Date(e.date)))?t:0)+b.bandwidth()/2},y:e=>j(e.new_traders_activation_ratio),stroke:B.activationRatio,strokeWidth:1.5,curve:T.G}),(0,r.jsx)(h.A,{top:o,scale:b,tickFormat:e=>C(e.toISOString()),stroke:N.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,tickLabelProps:(e,t)=>({fill:N.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:0===t?"start":"middle",dy:"0.5em",dx:0===t?"0.5em":0}),numTicks:a?6:4}),(0,r.jsx)(g.A,{scale:y,stroke:N.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickFormat:e=>n(Number(e)),tickLabelProps:()=>({fill:N.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"end",dx:"-0.6em",dy:"0.25em"})}),(0,r.jsx)(f.A,{left:i,scale:j,stroke:N.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickFormat:e=>"".concat((100*Number(e)).toFixed(0),"%"),tickLabelProps:()=>({fill:N.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"start",dx:"0.5em",dy:"0.25em"})})]})})}})}),(0,r.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,r.jsx)(b.A,{data:a?Y:L,isModal:a,activeBrushDomain:E,onBrushChange:_,onClearBrush:M,getDate:e=>e.date,getValue:e=>e.active_signer,lineColor:B.activeTraders,margin:{top:5,right:60,bottom:10,left:60}})})]})};return(0,r.jsxs)("div",{className:"h-full w-full relative",children:[ew(0,0),(0,r.jsx)(i.A,{isOpen:E,onClose:_,title:"Traders Activity",subtitle:"Analysis of active and new trader metrics on Solana DEXes",children:(0,r.jsxs)("div",{className:"p-4 w-full h-full",children:[(0,r.jsx)("div",{className:"h-px bg-gray-900 w-full mb-3"}),(0,r.jsx)("div",{className:"h-[60vh]",children:(0,r.jsxs)("div",{className:"flex h-full",children:[(0,r.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:ew(0,0,!0)}),(0,r.jsx)("div",{className:"w-[10%] pl-3",children:(0,r.jsx)("div",{className:"flex flex-col gap-4 pt-4",children:!K&&Y.length>0?(0,r.jsx)("div",{className:"flex flex-col gap-2",children:((a=Y)&&0!==a.length?[{key:"active_signer",displayName:"Active Traders",shape:"square",color:B.activeTraders},{key:"new_signer",displayName:"New Traders",shape:"circle",color:B.newTraders},{key:"new_traders_activation_ratio",displayName:"Activation Ratio",shape:"circle",color:B.activationRatio}]:[]).map(e=>(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 mr-2 ".concat("circle"===e.shape?"rounded-full":"rounded-sm"," mt-0.5"),style:{background:e.color}}),(0,r.jsx)("span",{className:"text-[11px] text-gray-300",children:e.displayName})]},e.key))}):(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 bg-blue-500 mr-2 rounded-sm mt-0.5 animate-pulse"}),(0,r.jsx)("span",{className:"text-[11px] text-gray-300",children:"Loading..."})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 bg-orange-500 mr-2 rounded-full mt-0.5 animate-pulse"}),(0,r.jsx)("span",{className:"text-[11px] text-gray-300",children:"Loading..."})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 bg-green-500 mr-2 rounded-full mt-0.5 animate-pulse"}),(0,r.jsx)("span",{className:"text-[11px] text-gray-300",children:"Loading..."})]})]})})})]})})]})})]})}let _=["1-3 transactions","4-5 transactions","6-10 transactions","11-100 transactions","101-1000 transactions",">1000 transactions"];async function L(){try{let e=await fetch("https://analytics.topledger.xyz/tl/api/queries/12392/results.json?api_key=aSgz8ztgBg46FAoarkY8JGS5K0jxqm9t60sF3CDQ");if(!e.ok)throw Error("API request failed with status ".concat(e.status));let t=(await e.json()).query_result.data.rows,a=t.map(e=>({month:e.month,date:new Date(e.month),category:e.monthly_transactions,volume:e.volume,signers:e.Signers})),r=M(a,"volume"),l=M(a,"signers");return{rawData:t,volumeData:r,signersData:l}}catch(e){throw console.error("Error fetching traders stacked data:",e),e}}function M(e,t){let a={},r=Array.from(new Set(e.map(e=>e.month))).sort();return r.forEach(e=>{a[e]={},_.forEach(t=>{a[e][t]=0})}),e.forEach(e=>{a[e.month][e.category]=e[t]}),r.map(e=>({month:e,date:new Date(e),...a[e]}))}function F(e){return null==e||isNaN(e)?"0":e>=1e9?"".concat((e/1e9).toFixed(1),"B"):e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"K"):e.toFixed(0)}function P(e){return"$".concat(F(e))}function R(e){return e.toLocaleDateString("en-US",{month:"short",year:"numeric"})}var q=a(4503),B=a(78398),I=a(80229);let O=e=>{let{className:t="w-4 h-4"}=e;return(0,r.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},z={...j.$C},U={grid:j.Vg,axisLines:j.h5,tickLabels:j.Dc};function V(e){let{dataType:t,onDataTypeChange:a,isModalOpen:s,onModalClose:n}=e,[d,u]=(0,l.useState)([]),[f,T]=(0,l.useState)([]),[k,N]=(0,l.useState)(!0),[S,A]=(0,l.useState)(null),[D,C]=(0,l.useState)({}),[E,M]=(0,l.useState)([]),[V,W]=(0,l.useState)([]),[X,Y]=(0,l.useState)(null),[H,K]=(0,l.useState)(!1),[G,Z]=(0,l.useState)([]),[Q,$]=(0,l.useState)(!0),[J,ee]=(0,l.useState)(null),[et,ea]=(0,l.useState)(null),[er,el]=(0,l.useState)(!1),[es,en]=(0,l.useState)([]),[ei,eo]=(0,l.useState)({visible:!1,dataPoint:null,category:"",value:0,left:0,top:0,items:[]}),ec=(0,l.useRef)(null),ed=(0,l.useRef)(!0),eu=(0,l.useRef)(null),em=(0,l.useRef)(!0),eh=(0,l.useRef)(null),eg=(0,l.useRef)(null);(0,l.useEffect)(()=>{if(eh.current){let{width:e,height:t}=eh.current.getBoundingClientRect();console.log("[TradersStackedBarChart] Container dimensions:",{width:e,height:t})}else console.warn("[TradersStackedBarChart] Container ref not available")},[]);let ef=e=>D[e]||z[e]||"#6b7280",ex=(0,l.useCallback)(async()=>{console.log("[TradersStackedBarChart] Starting to fetch data"),N(!0),A(null);try{let e=await L();if(console.log("[TradersStackedBarChart] Fetched data:",e),e.volumeData&&0!==e.volumeData.length&&e.signersData&&0!==e.signersData.length){let a=[...e.volumeData].sort((e,t)=>e.date.getTime()-t.date.getTime()),r=[...e.signersData].sort((e,t)=>e.date.getTime()-t.date.getTime());u(a),T(r),M(a),W(r),K(!0),Y(null),ev(a,r,t)}else console.warn("[TradersStackedBarChart] No data returned from API or fallback"),A("No data available from API or fallback"),u([]),T([]),M([]),W([])}catch(t){console.error("[TradersStackedBarChart] Error fetching data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),A("Failed to load traders data: "+e),u([]),T([]),M([]),W([])}finally{N(!1)}},[t]);(0,l.useEffect)(()=>{d.length>0&&f.length>0&&ev(d,f,t)},[t,d,f]);let ev=(e,t,a)=>{let r="volume"===a?e:t,l={};_.forEach(e=>{l[e]=0,r.forEach(t=>{l[e]+=t[e]||0})});let s=_.map(e=>({name:e,total:l[e]||0})).sort((e,t)=>t.total-e.total).map(e=>e.name),n={};s.forEach((e,t)=>{n[e]=j.Tj[t%j.Tj.length]}),C(n)},ep=(0,l.useCallback)(async()=>{console.log("[TradersStackedBarChart] Starting to fetch modal data"),$(!0),ee(null);try{let e=await L();if(console.log("[TradersStackedBarChart] Fetched modal data"),e.volumeData&&0!==e.volumeData.length&&e.signersData&&0!==e.signersData.length){let a=[..."volume"===t?e.volumeData:e.signersData].sort((e,t)=>e.date.getTime()-t.date.getTime());Z(a),en(a),el(!0),ea(null)}else console.warn("[TradersStackedBarChart] No modal data returned from API or fallback"),ee("No data available from API or fallback"),Z([]),en([])}catch(t){console.error("[TradersStackedBarChart] Error fetching modal data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),ee("Failed to load traders data: "+e),Z([]),en([])}finally{$(!1)}},[t]);(0,l.useEffect)(()=>{ex()},[ex]);let ew=(0,l.useCallback)(e=>{if(!e){H&&(Y(null),K(!1),M(d),W(f)),ec.current&&(clearTimeout(ec.current),ec.current=null,ed.current=!0);return}let{x0:t,x1:a}=e,r=new Date(t),l=new Date(a);if(!(isNaN(r.getTime())||isNaN(l.getTime()))&&(Y([r,l]),H||K(!0),ed.current)){ed.current=!1;let e=d.filter(e=>{let t=e.date.getTime();return t>=r.getTime()&&t<=l.getTime()}),t=f.filter(e=>{let t=e.date.getTime();return t>=r.getTime()&&t<=l.getTime()});0===e.length||0===t.length?(M(d),W(f)):(M(e),W(t)),ec.current=setTimeout(()=>{ed.current=!0,ec.current=null},100)}},[H,d,f]),eb=(0,l.useCallback)(e=>{if(!e){er&&(ea(null),el(!1),en(G)),eu.current&&(clearTimeout(eu.current),eu.current=null,em.current=!0);return}let{x0:t,x1:a}=e,r=new Date(t),l=new Date(a);if(!(isNaN(r.getTime())||isNaN(l.getTime()))&&(ea([r,l]),er||el(!0),em.current)){em.current=!1;let e=G.filter(e=>{let t=e.date.getTime();return t>=r.getTime()&&t<=l.getTime()});0===e.length?en(G):en(e),eu.current=setTimeout(()=>{em.current=!0,eu.current=null},100)}},[er,G]);(0,l.useEffect)(()=>{if(s){console.log("Modal opened - initializing with data");let e="volume"===t?E:V;Z(e),en(e),ea(X),el(H),$(!1),(0===d.length||0===f.length)&&ep()}},[s,t,E,V,X,H,d,f,ep]),(0,l.useEffect)(()=>{s&&ep()},[t,s,ep]);let ey=(0,l.useCallback)(function(e,t,a,r){let l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=l?eg.current:eh.current;if(!s)return;let n=s.getBoundingClientRect();eo({visible:!0,dataPoint:t,category:a,value:r,left:e.clientX-n.left,top:e.clientY-n.top,items:[]})},[]),eT=(0,l.useCallback)(()=>{ei.visible&&eo(e=>({...e,visible:!1}))},[ei.visible]);(0,l.useEffect)(()=>()=>{ec.current&&clearTimeout(ec.current),eu.current&&clearTimeout(eu.current)},[]);let ej=(0,l.useCallback)(e=>e&&0!==e.length?e.map(e=>{let t=0;return _.forEach(a=>{t+=e[a]||0}),{date:e.date.toISOString(),value:t}}).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()):[],[]),ek=e=>e&&0!==e.length?_.map(e=>({key:e,displayName:e,shape:"square",color:ef(e)})):[],eN=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];console.log("[TradersStackedBarChart] Rendering chart. Modal:",e);let a=e?Q:k,l=e?J:S,s=e?er?es:G:"volume"===t?E:V;return a?(0,r.jsx)(p.A,{size:"sm"}):l||0===s.length?(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,r.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:l||"No data available"}),(0,r.jsx)(y.A,{onClick:e?ep:ex,children:(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)(O,{className:"w-3.5 h-3.5"}),(0,r.jsx)("span",{children:"Refresh"})]})})]}):(0,r.jsxs)("div",{className:"flex flex-col h-full w-full",children:[ei.visible&&ei.dataPoint&&(0,r.jsx)(w.A,{title:R(ei.dataPoint.date),items:ei.items&&ei.items.length>0?ei.items:[{color:ef(ei.category),label:ei.category,value:"volume"===t?P(ei.value):F(ei.value),shape:"square"}],top:ei.top,left:ei.left,isModal:e}),(0,r.jsx)("div",{className:"h-[85%] w-full overflow-hidden relative",onMouseLeave:eT,ref:e?eg:eh,onMouseMove:a=>{let r=e?eg.current:eh.current;if(!r)return;let l=r.getBoundingClientRect(),s=a.clientX-l.left,n=a.clientY-l.top,i={right:20,left:60},o=l.width-i.left-i.right;if(s<i.left||s>o+i.left)return;let c=e?er?es:G:"volume"===t?E:V,d=Math.min(c.length-1,Math.max(0,Math.floor((s-i.left)/(o/c.length))));if(d>=0&&d<c.length){let e=c[d],a=_.map(a=>({color:ef(a),label:a,value:"volume"===t?P(e[a]||0):F(e[a]||0),rawValue:e[a]||0,shape:"square"})).filter(e=>e.rawValue>0).sort((e,t)=>t.rawValue-e.rawValue);eo({visible:!0,dataPoint:e,category:"",value:0,left:s,top:n,items:a})}},children:(0,r.jsx)(o.A,{children:a=>{let{width:l,height:n}=a;if(l<=0||n<=0)return null;let i={top:20,right:20,bottom:40,left:60},o=l-i.left-i.right,d=n-i.top-i.bottom;if(o<=0||d<=0)return null;let u=(0,x.A)({domain:s.map(e=>e.month),padding:.3,range:[0,o]}),f=0;s.forEach(e=>{let t=0;_.forEach(a=>{t+=e[a]||0}),f=Math.max(f,t)});let p=(0,v.A)({domain:[0,1.1*f],range:[d,0],nice:!0}),w=(0,B.A)({domain:_,range:_.map(e=>ef(e))});return(0,r.jsx)("svg",{width:l,height:n,className:"overflow-visible",children:(0,r.jsxs)(c.A,{left:i.left,top:i.top,children:[(e?er:H)&&(0,r.jsx)("text",{x:0,y:-8,fontSize:8,fill:w(_[0]),textAnchor:"start",children:"Filtered: ".concat(s.length," item").concat(1!==s.length?"s":"")}),(0,r.jsx)(m.A,{scale:p,width:o,stroke:U.grid,strokeDasharray:"2,3",strokeOpacity:.5,numTicks:5}),(0,r.jsx)(q.A,{data:s,keys:_,x:e=>e.month,xScale:u,yScale:p,color:w,children:t=>t.map(t=>t.bars.map(a=>{var l;return(0,r.jsx)("rect",{x:a.x,y:a.y,height:a.height,width:a.width,fill:a.color,opacity:ei.visible&&(null==(l=ei.dataPoint)?void 0:l.month)===a.bar.data.month&&ei.category===_[a.index]?.9:.7,rx:2,onMouseEnter:t=>ey(t,a.bar.data,_[a.index],a.bar.data[_[a.index]],e),onMouseMove:t=>{let a=e?eg.current:eh.current;if(!a)return;let r=a.getBoundingClientRect(),l=t.clientX-r.left,s=t.clientY-r.top;eo(e=>({...e,left:l,top:s}))}},"bar-stack-".concat(t.index,"-").concat(a.index))}))}),(0,r.jsx)(h.A,{top:d,scale:u,stroke:U.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,tickLabelProps:()=>({fill:U.tickLabels,fontSize:10,textAnchor:"middle",dy:"0.5em"}),tickFormat:e=>R(new Date(e)),numTicks:e?12:Math.min(6,s.length)}),(0,r.jsx)(g.A,{scale:p,stroke:U.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickFormat:e=>"volume"===t?P(Number(e)):F(Number(e)),tickLabelProps:()=>({fill:U.tickLabels,fontSize:10,textAnchor:"end",dx:"-0.6em",dy:"0.25em"})})]})})}})}),(0,r.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,r.jsx)(b.A,{data:ej(e?G:"volume"===t?d:f),isModal:e,activeBrushDomain:e?et:X,onBrushChange:e?eb:ew,onClearBrush:()=>{e?(ea(null),el(!1),en(G)):(Y(null),K(!1),M(d),W(f))},getDate:e=>e.date,getValue:e=>e.value,lineColor:"volume"===t?"#60a5fa":"#34d399",margin:{top:5,right:20,bottom:10,left:60}})})]})};return(0,r.jsxs)("div",{className:"h-full w-full relative",children:[(0,r.jsx)("div",{className:"h-[calc(100%)]",children:eN(!1)}),(0,r.jsx)(i.A,{isOpen:s,onClose:n,title:"volume"===t?"DEX Trading Volume by Transaction Frequency":"DEX Traders by Transaction Frequency",subtitle:"Analyzing trading patterns across different user activity levels",children:(()=>{let e=ek(G);return(0,r.jsxs)("div",{className:"p-4 w-full h-full",children:[(0,r.jsx)("div",{className:"flex justify-between items-center mb-3",children:(0,r.jsx)(I.A,{selectedDataType:t,onChange:a})}),(0,r.jsx)("div",{className:"h-px bg-gray-900 w-full mb-3"}),(0,r.jsx)("div",{className:"h-[60vh]",children:(0,r.jsxs)("div",{className:"flex h-full",children:[(0,r.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:eN(!0)}),(0,r.jsx)("div",{className:"w-[10%] h-full pl-3 flex flex-col justify-start items-start",children:!Q&&G.length>0?(0,r.jsx)("div",{className:"flex flex-col gap-2 max-h-[600px] w-[125px] overflow-y-auto [&::-webkit-scrollbar]:w-1.5  [&::-webkit-scrollbar-track]:bg-transparent  [&::-webkit-scrollbar-thumb]:bg-gray-700/40 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:hover:bg-gray-600/60 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-gray-700/40",children:e.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 mr-1.5 rounded-sm mt-0.5",style:{background:e.color}}),(0,r.jsx)("span",{className:"text-[11px] text-gray-300",children:e.displayName})]},"modal-legend-".concat(t)))}):(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 bg-blue-500 mr-2 rounded-sm mt-0.5 animate-pulse"}),(0,r.jsx)("span",{className:"text-[11px] text-gray-300",children:"Loading..."})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 bg-green-500 mr-2 rounded-sm mt-0.5 animate-pulse"}),(0,r.jsx)("span",{className:"text-[11px] text-gray-300",children:"Loading..."})]})]})})]})})]})})()})]})}let W=["<1k USD ","1k-10k USD","10k-50k USD","50k-500k USD","500k-2.5M USD",">2.5M USD"];async function X(){try{let e=await fetch("https://analytics.topledger.xyz/tl/api/queries/12422/results.json?api_key=pOuD9xaxsmquzZGOnUcR9disUQI3EeXNQKuKpO6l");if(!e.ok)throw Error("API request failed with status ".concat(e.status));let t=(await e.json()).query_result.data.rows,a=t.map(e=>({month:e.Month,date:new Date(e.Month),category:e.Signer_Lifetime_Trade_Vol,signers:e.active_wallet,volume:e.Volume})),r=Y(a,"volume"),l=Y(a,"signers");return{rawData:t,volumeData:r,signersData:l}}catch(e){throw console.error("Error fetching traders category data:",e),e}}function Y(e,t){let a={},r=Array.from(new Set(e.map(e=>e.month))).sort();return r.forEach(e=>{a[e]={},W.forEach(t=>{a[e][t]=0})}),e.forEach(e=>{a[e.month]&&(a[e.month][e.category]=e[t])}),r.map(e=>({month:e,date:new Date(e),...a[e]}))}function H(e){return null==e||isNaN(e)?"0":e>=1e9?"".concat((e/1e9).toFixed(1),"B"):e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"K"):e.toFixed(0)}function K(e){return"$".concat(H(e))}function G(e){return e.toLocaleDateString("en-US",{month:"short",year:"numeric"})}var Z=a(85204);let Q=e=>{let{className:t="w-4 h-4"}=e;return(0,r.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},$={"<1k USD ":j.Tj[0],"1k-10k USD":j.Tj[2],"10k-50k USD":j.Tj[1],"50k-500k USD":j.Tj[3],"500k-2.5M USD":j.Tj[4],">2.5M USD":j.Tj[5]},J={grid:j.Vg,axisLines:j.h5,tickLabels:j.Dc};function ee(e){let{dataType:t,displayMode:a,isModalOpen:s,onModalClose:n}=e,[d,u]=(0,l.useState)([]),[f,T]=(0,l.useState)([]),[k,N]=(0,l.useState)(!0),[S,A]=(0,l.useState)(null),[D,C]=(0,l.useState)({}),[E,_]=(0,l.useState)([]),[L,M]=(0,l.useState)([]),[F,P]=(0,l.useState)(null),[R,O]=(0,l.useState)(!1),[z,U]=(0,l.useState)([]),[V,Y]=(0,l.useState)(!0),[ee,et]=(0,l.useState)(null),[ea,er]=(0,l.useState)(null),[el,es]=(0,l.useState)(!1),[en,ei]=(0,l.useState)([]),[eo,ec]=(0,l.useState)(t),[ed,eu]=(0,l.useState)(a),[em,eh]=(0,l.useState)({visible:!1,dataPoint:null,category:"",value:0,left:0,top:0,items:[]}),eg=(0,l.useRef)(null),ef=(0,l.useRef)(!0),ex=(0,l.useRef)(null),ev=(0,l.useRef)(!0),ep=(0,l.useRef)(null),ew=(0,l.useRef)(null),eb=e=>D[e]||$[e]||"#6b7280",ey=(0,l.useCallback)(async()=>{console.log("[TradersCategoryChart] Starting to fetch data"),N(!0),A(null);try{let e=await X();if(console.log("[TradersCategoryChart] Fetched data:",e),e.volumeData&&0!==e.volumeData.length&&e.signersData&&0!==e.signersData.length){let a=[...e.volumeData].sort((e,t)=>e.date.getTime()-t.date.getTime()),r=[...e.signersData].sort((e,t)=>e.date.getTime()-t.date.getTime());u(a),T(r),_(a),M(r),O(!0),P(null),eT(a,r,t)}else console.warn("[TradersCategoryChart] No data returned from API"),A("No data available from API"),u([]),T([]),_([]),M([])}catch(t){console.error("[TradersCategoryChart] Error fetching data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),A("Failed to load traders data: "+e),u([]),T([]),_([]),M([])}finally{N(!1)}},[t]);(0,l.useEffect)(()=>{d.length>0&&f.length>0&&eT(d,f,t)},[t,d,f]);let eT=(e,t,a)=>{let r="volume"===a?e:t,l={};W.forEach(e=>{l[e]=0,r.forEach(t=>{l[e]+=t[e]||0})});let s=W.map(e=>({name:e,total:l[e]||0})).sort((e,t)=>t.total-e.total).map(e=>e.name),n={};s.forEach((e,t)=>{n[e]=j.Tj[t%j.Tj.length]}),C(n)},ej=(0,l.useCallback)(async()=>{console.log("[TradersCategoryChart] Starting to fetch modal data"),Y(!0),et(null);try{let e=await X();if(console.log("[TradersCategoryChart] Fetched modal data"),e.volumeData&&0!==e.volumeData.length&&e.signersData&&0!==e.signersData.length){let t=[..."volume"===eo?e.volumeData:e.signersData].sort((e,t)=>e.date.getTime()-t.date.getTime());U(t),ei(t),es(!0),er(null)}else console.warn("[TradersCategoryChart] No modal data returned from API"),et("No data available from API"),U([]),ei([])}catch(t){console.error("[TradersCategoryChart] Error fetching modal data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),et("Failed to load traders data: "+e),U([]),ei([])}finally{Y(!1)}},[eo]);(0,l.useEffect)(()=>{ey()},[ey]);let ek=(0,l.useCallback)(e=>{if(!e){R&&(P(null),O(!1),_(d),M(f)),eg.current&&(clearTimeout(eg.current),eg.current=null,ef.current=!0);return}let{x0:t,x1:a}=e,r=new Date(t),l=new Date(a);if(!(isNaN(r.getTime())||isNaN(l.getTime()))&&(P([r,l]),R||O(!0),ef.current)){ef.current=!1;let e=d.filter(e=>{let t=e.date.getTime();return t>=r.getTime()&&t<=l.getTime()}),t=f.filter(e=>{let t=e.date.getTime();return t>=r.getTime()&&t<=l.getTime()});0===e.length||0===t.length?(_(d),M(f)):(_(e),M(t)),eg.current=setTimeout(()=>{ef.current=!0,eg.current=null},100)}},[R,d,f]),eN=(0,l.useCallback)(e=>{if(!e){el&&(er(null),es(!1),ei(z)),ex.current&&(clearTimeout(ex.current),ex.current=null,ev.current=!0);return}let{x0:t,x1:a}=e,r=new Date(t),l=new Date(a);if(!(isNaN(r.getTime())||isNaN(l.getTime()))&&(er([r,l]),el||es(!0),ev.current)){ev.current=!1;let e=z.filter(e=>{let t=e.date.getTime();return t>=r.getTime()&&t<=l.getTime()});0===e.length?ei(z):ei(e),ex.current=setTimeout(()=>{ev.current=!0,ex.current=null},100)}},[el,z]),eS=(0,l.useCallback)(e=>{ec(e),ej()},[ej]),eA=(0,l.useCallback)(e=>{eu(e)},[]);(0,l.useEffect)(()=>{if(s&&z.length>0){let e="volume"===eo?d:f;U(e),ei(e)}},[eo,s,d,f]),(0,l.useEffect)(()=>{if(s){let e="volume"===t?d:f;ec(t),eu(a),e.length>0?(U(e),ei(e),Y(!1)):ej()}},[s,t,a,d,f,ej]);let eD=(0,l.useCallback)(function(e,t,a,r){let l=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=l?ew.current:ep.current;if(!s)return;let n=s.getBoundingClientRect();eh({visible:!0,dataPoint:t,category:a,value:r,left:e.clientX-n.left,top:e.clientY-n.top,items:[]})},[]),eC=(0,l.useCallback)(()=>{em.visible&&eh(e=>({...e,visible:!1}))},[em.visible]);(0,l.useEffect)(()=>()=>{eg.current&&clearTimeout(eg.current),ex.current&&clearTimeout(ex.current)},[]);let eE=(0,l.useCallback)(e=>e&&0!==e.length?e.map(e=>{let t=0;return W.forEach(a=>{t+=e[a]||0}),{date:e.date.toISOString(),value:t}}).sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()):[],[]),e_=e=>e&&0!==e.length?W.map(e=>({key:e,displayName:e,shape:"square",color:eb(e)})):[],eL=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];console.log("[TradersCategoryChart] Rendering chart. Modal:",e);let l=e?V:k,s=e?ee:S,n=e?eo:t,i=e?ed:a,u=e?el?en:z:"volume"===t?E:L;return l?(0,r.jsx)(p.A,{size:"sm"}):s||0===u.length?(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,r.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:s||"No data available"}),(0,r.jsx)(y.A,{onClick:e?ej:ey,children:(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)(Q,{className:"w-3.5 h-3.5"}),(0,r.jsx)("span",{children:"Refresh"})]})})]}):(0,r.jsxs)("div",{className:"flex flex-col h-full w-full",children:[em.visible&&em.dataPoint&&(0,r.jsx)(w.A,{title:G(em.dataPoint.date),items:em.items?em.items:[{color:eb(em.category),label:em.category,value:"volume"===n?K(em.value):H(em.value),shape:"square"}],top:em.top,left:em.left,isModal:e}),(0,r.jsx)("div",{className:"h-[85%] w-full overflow-hidden relative",onMouseLeave:eC,ref:e?ew:ep,onMouseMove:t=>{let a=e?ew.current:ep.current;if(!a)return;let r=a.getBoundingClientRect(),l=t.clientX-r.left,s=t.clientY-r.top,i={right:20,left:60},o=r.width-i.left-i.right;if(l<i.left||l>o+i.left)return;let c=e?el?en:z:"volume"===n?E:L,d=Math.min(c.length-1,Math.max(0,Math.floor((l-i.left)/(o/c.length))));if(d>=0&&d<c.length){let e=c[d],t=W.map(t=>({color:eb(t),label:t,value:"volume"===n?K(e[t]||0):H(e[t]||0),rawValue:e[t]||0,shape:"square"})).filter(e=>e.rawValue>0).sort((e,t)=>t.rawValue-e.rawValue);eh({visible:!0,dataPoint:e,category:"",value:0,left:l,top:s,items:t})}},children:(0,r.jsx)(o.A,{children:t=>{let{width:a,height:l}=t;if(a<=0||l<=0)return null;let s={top:20,right:20,bottom:40,left:60},o=a-s.left-s.right,d=l-s.top-s.bottom;if(o<=0||d<=0)return null;let f=(0,x.A)({domain:u.map(e=>G(e.date)),padding:.3,range:[0,o]}),p=0;"absolute"===i?u.forEach(e=>{let t=0;W.forEach(a=>{t+=e[a]||0}),p=Math.max(p,t)}):p=100;let w=(0,v.A)({domain:[0,1.1*p],range:[d,0],nice:!0}),b=(0,B.A)({domain:W,range:W.map(e=>eb(e))}),y=[...u];return"percent"===i&&(y=u.map(e=>{let t=0;W.forEach(a=>{t+=e[a]||0});let a={month:e.month,date:e.date};return W.forEach(r=>{t>0?a[r]=(e[r]||0)/t*100:a[r]=0}),a})),(0,r.jsx)("svg",{width:a,height:l,className:"overflow-visible",children:(0,r.jsxs)(c.A,{left:s.left,top:s.top,children:[(e?el:R)&&(0,r.jsx)("text",{x:0,y:-8,fontSize:8,fill:b(W[0]),textAnchor:"start",children:"Filtered: ".concat(u.length," item").concat(1!==u.length?"s":"")}),(0,r.jsx)(m.A,{scale:w,width:o,stroke:J.grid,strokeDasharray:"2,3",strokeOpacity:.5,numTicks:5}),(0,r.jsx)(q.A,{data:y,keys:W,x:e=>G(e.date),xScale:f,yScale:w,color:b,order:"reverse",children:t=>t.map(t=>t.bars.map(a=>{var l;return(0,r.jsx)("rect",{x:a.x,y:a.y,height:a.height,width:a.width,fill:a.color,opacity:em.visible&&(null==(l=em.dataPoint)?void 0:l.month)===a.bar.data.month&&em.category===W[a.index]?.9:.7,rx:2,onMouseEnter:t=>eD(t,a.bar.data,W[a.index],a.bar.data[W[a.index]],e),onMouseMove:t=>{let a=e?ew.current:ep.current;if(!a)return;let r=a.getBoundingClientRect(),l=t.clientX-r.left,s=t.clientY-r.top;eh(e=>({...e,left:l,top:s}))}},"bar-stack-".concat(t.index,"-").concat(a.index))}))}),(0,r.jsx)(h.A,{top:d,scale:f,stroke:J.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,tickLabelProps:()=>({fill:J.tickLabels,fontSize:10,textAnchor:"middle",dy:"0.5em"}),numTicks:e?12:Math.min(6,u.length)}),(0,r.jsx)(g.A,{scale:w,stroke:J.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickFormat:e=>"percent"===i?"".concat(Number(e).toFixed(0),"%"):"volume"===n?K(Number(e)):H(Number(e)),tickLabelProps:()=>({fill:J.tickLabels,fontSize:10,textAnchor:"end",dx:"-0.6em",dy:"0.25em"})})]})})}})}),(0,r.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,r.jsx)(b.A,{data:eE(e?z:"volume"===t?d:f),isModal:e,activeBrushDomain:e?ea:F,onBrushChange:e?eN:ek,onClearBrush:()=>{e?(er(null),es(!1),ei(z)):(P(null),O(!1),_(d),M(f))},getDate:e=>e.date,getValue:e=>e.value,lineColor:"volume"===t?"#60a5fa":"#34d399",margin:{top:5,right:20,bottom:10,left:60}})})]})};return(0,r.jsxs)("div",{className:"h-full w-full relative",children:[(0,r.jsx)("div",{className:"h-full",children:eL(!1)}),(0,r.jsx)(i.A,{isOpen:s,onClose:n,title:"volume"===t?"Trading Volume by Trader Category":"Traders by Category",subtitle:"Distribution of trading activity by trader lifetime volume",children:(()=>{let e=en.length>0?en:z,t=e_(e);return(0,r.jsxs)("div",{className:"p-4 w-full h-full",children:[(0,r.jsx)("div",{className:"flex items-center justify-between pl-1 py-0 mb-3",children:(0,r.jsxs)("div",{className:"flex space-x-4 items-center",children:[(0,r.jsx)(I.A,{selectedDataType:eo,onChange:eS,isCompact:!0}),(0,r.jsx)(Z.A,{mode:ed,onChange:eA})]})}),(0,r.jsx)("div",{className:"h-px bg-gray-900 w-full mb-3"}),(0,r.jsx)("div",{className:"h-[60vh]",children:(0,r.jsxs)("div",{className:"flex h-full",children:[(0,r.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:eL(!0)}),(0,r.jsxs)("div",{className:"w-[10%] h-full pl-3 flex flex-col justify-start items-start",children:[(0,r.jsx)("div",{className:"text-[10px] text-gray-400 mb-2",children:"TRADER CATEGORIES"}),!V&&e.length>0?(0,r.jsx)("div",{className:"flex flex-col gap-2 max-h-[600px] w-[125px] overflow-y-auto [&::-webkit-scrollbar]:w-1.5  [&::-webkit-scrollbar-track]:bg-transparent  [&::-webkit-scrollbar-thumb]:bg-gray-700/40 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:hover:bg-gray-600/60 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-gray-700/40",children:t.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 mr-1.5 rounded-sm mt-0.5",style:{background:e.color}}),(0,r.jsx)("span",{className:"text-[11px] text-gray-300",children:e.displayName})]},"modal-legend-".concat(t)))}):(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 bg-blue-500 mr-2 rounded-sm mt-0.5 animate-pulse"}),(0,r.jsx)("span",{className:"text-[11px] text-gray-300",children:"Loading..."})]}),(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 bg-green-500 mr-2 rounded-sm mt-0.5 animate-pulse"}),(0,r.jsx)("span",{className:"text-[11px] text-gray-300",children:"Loading..."})]})]})]})]})})]})})()})]})}var et=a(21903);function ea(){let[e,t]=(0,l.useState)(!1),[a,s]=(0,l.useState)(!1),[n,i]=(0,l.useState)(!1),[o,c]=(0,l.useState)("volume"),[d,u]=(0,l.useState)("volume"),[m,h]=(0,l.useState)("absolute"),g=e=>{u(e)};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4",children:[(0,r.jsx)(et.A,{title:"Traders Activity",description:"Tracking active and new traders with activation ratio metrics",accentColor:"blue",onExpandClick:()=>t(!0),children:(0,r.jsx)(E,{isModalOpen:e,onModalClose:()=>t(!1)})}),(0,r.jsx)(et.A,{title:"volume"===o?"Trading Volume by Trader Category":"Traders by Category",description:"Distribution of trading activity by trader lifetime volume",accentColor:"green",onExpandClick:()=>i(!0),filterBar:(0,r.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,r.jsx)(Z.A,{mode:m,onChange:e=>{h(e)}}),(0,r.jsx)(I.A,{selectedDataType:o,onChange:e=>{c(e)},isCompact:!0})]}),children:(0,r.jsx)(ee,{dataType:o,displayMode:m,isModalOpen:n,onModalClose:()=>i(!1)})})]}),(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)(et.A,{title:"volume"===d?"Trading Volume by Transaction Frequency":"Traders by Transaction Frequency",description:"Analyzing trading patterns across different user activity levels",accentColor:"orange",onExpandClick:()=>s(!0),filterBar:(0,r.jsx)("div",{className:"flex items-center justify-end w-full",children:(0,r.jsx)(I.A,{selectedDataType:d,onChange:g,isCompact:!0})}),children:(0,r.jsx)(V,{dataType:d,onDataTypeChange:g,isModalOpen:a,onModalClose:()=>s(!1)})})})]})}},30167:(e,t,a)=>{Promise.resolve().then(a.bind(a,23641))},74537:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var r=a(12115),l=a(29300),s=a.n(l),n=a(14945),i=a(2758),o=["axisClassName","labelOffset","tickLength","tickLabelProps"];function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e}).apply(this,arguments)}var d={dx:"0.25em",dy:"0.25em",fill:"#222",fontFamily:"Arial",fontSize:10,textAnchor:"start"};function u(e){var t=e.axisClassName,a=e.labelOffset,l=e.tickLength,u=e.tickLabelProps,m=function(e,t){if(null==e)return{};var a,r,l={},s=Object.keys(e);for(r=0;r<s.length;r++)a=s[r],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,o),h="function"==typeof u?u:c({},d,u);return r.createElement(n.A,c({axisClassName:s()("visx-axis-right",t),labelOffset:void 0===a?36:a,orientation:i.A.right,tickLabelProps:h,tickLength:void 0===l?8:l},m))}}},e=>{var t=t=>e(e.s=t);e.O(0,[4410,5083,166,1182,5955,4685,2897,8441,1684,7358],()=>t(30167)),_N_E=e.O()}]);