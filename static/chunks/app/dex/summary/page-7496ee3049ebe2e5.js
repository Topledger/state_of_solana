(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[987,4566],{4566:(e,t,r)=>{"use strict";r.d(t,{getLatestVolumeStats:()=>l});let a=async()=>{try{var e,t;let r=await fetch("https://analytics.topledger.xyz/tl/api/queries/12253/results.json?api_key=AhAqEtjP6gKfND9TLKPRzSbB2IYdXlAFcBa2vSoQ");if(!r.ok)throw Error("Failed to fetch: ".concat(r.status," ").concat(r.statusText));return((null==(t=(await r.json()).query_result)||null==(e=t.data)?void 0:e.rows)||[]).map(e=>({year:e.year,volume:e.volume,cumulative_volume:e.cumulative_volume})).sort((e,t)=>new Date(t.year).getTime()-new Date(e.year).getTime())}catch(e){throw console.error("Error fetching volume data:",e),Error("Failed to fetch volume data")}},l=async()=>{try{let e=await a();if(e.length<2)return{cumulativeVolume:0,percentChange:0,isPositive:!1};let t=e[0],r=e[1],l=t.cumulative_volume,n=(t.cumulative_volume-r.cumulative_volume)/r.cumulative_volume*100;return{cumulativeVolume:l,percentChange:n,isPositive:n>0}}catch(e){return console.error("Error calculating volume stats:",e),{cumulativeVolume:0,percentChange:0,isPositive:!1}}}},4588:(e,t,r)=>{Promise.resolve().then(r.bind(r,78590))},6828:(e,t,r)=>{"use strict";r.d(t,{$C:()=>p,Dc:()=>v,Tj:()=>a,Vg:()=>m,Vy:()=>x,Zp:()=>n,h5:()=>f,h8:()=>y,wL:()=>o,wv:()=>i,z1:()=>l});let a=["#60a5fa","#a78bfa","#34d399","#f97316","#f43f5e","#facc15","#10b981","#8b5cf6","#ec4899","#6b7280","#3b82f6","#059669","#93c5fd","#c4b5fd","#fb923c","#f87171","#fcd34d","#64748b","#0ea5e9","#1e40af","#4f46e5","#7c3aed","#be123c","#0891b2","#ea580c"],l=a[0],n=a[1],o=a[2],s=a[3],i=a[4],c=a[5],u=a[6],d=a[7],h=a[8],g=a[9];a[0],a[1],a[2],a[3];let m="#1f2937",f="#374151",v="#6b7280",x=e=>a[e%a.length],p={"1-3 transactions":l,"4-5 transactions":o,"6-10 transactions":n,"11-100 transactions":s,"101-1000 transactions":i,">1000 transactions":c},y=[l,n,o,s,i,c,h,d,u,g,a[10],a[11],a[12],a[13],a[14],a[15],a[16],a[17],a[18],a[19],a[20],a[21],a[22],a[23],a[24]]},21903:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(95155);r(12115);var l=r(30963),n=r(51078);let o=e=>{let{title:t,description:r,children:o,filterBar:s,legend:i,onExpandClick:c,onDownloadClick:u,isDownloading:d=!1,accentColor:h="blue",className:g="",legendWidth:m="1/5",isLoading:f=!1}=e,v={blue:{hover:"hover:shadow-blue-900/20",button:"bg-blue-500/10 text-blue-400 hover:bg-blue-500/20",border:"border-blue-400"},purple:{hover:"hover:shadow-purple-900/20",button:"bg-purple-500/10 text-purple-400 hover:bg-purple-500/20",border:"border-purple-400"},green:{hover:"hover:shadow-green-900/20",button:"bg-green-500/10 text-green-400 hover:bg-green-500/20",border:"border-green-400"},orange:{hover:"hover:shadow-orange-900/20",button:"bg-orange-500/10 text-orange-400 hover:bg-orange-500/20",border:"border-orange-400"},indigo:{hover:"hover:shadow-indigo-900/20",button:"bg-indigo-500/10 text-indigo-400 hover:bg-indigo-500/20",border:"border-indigo-400"}}[h];return(0,a.jsxs)("div",{className:"bg-black/80 backdrop-blur-sm p-4 rounded-xl border border-gray-900 shadow-lg ".concat(v.hover," transition-all duration-300 ").concat(g),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,a.jsxs)("div",{className:"-mt-1",children:[(0,a.jsx)("h2",{className:"text-[12px] font-normal text-gray-300 leading-tight mb-0.5",children:t}),r&&(0,a.jsx)("p",{className:"text-gray-500 text-[10px] tracking-wide",children:r})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[u&&(0,a.jsx)("button",{className:"p-1.5 ".concat(v.button," rounded-md transition-colors ").concat(d?"opacity-50 cursor-not-allowed":""),onClick:u,title:"Download CSV",disabled:d,children:d?(0,a.jsx)(n.A,{size:"xs",className:"w-4 h-4"}):(0,a.jsx)(l.s3,{className:"w-4 h-4"})}),c&&(0,a.jsx)("button",{className:"p-1.5 ".concat(v.button," rounded-md transition-colors"),onClick:c,title:"Expand Chart",children:(0,a.jsx)(l.mS,{className:"w-4 h-4"})})]})]}),(0,a.jsx)("div",{className:"h-px bg-gray-900 w-full"}),s&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex items-center justify-start pl-1 py-2 overflow-visible relative",children:s}),(0,a.jsx)("div",{className:"h-px bg-gray-900 w-full"})]}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row mt-3 h-[360px] lg:h-[380px]",children:[(0,a.jsxs)("div",{className:"flex-grow ".concat(i?"lg:pr-4 lg:border-r lg:border-gray-900":""," h-80 lg:h-auto relative"),children:[f&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 z-10 rounded-md",children:(0,a.jsx)(n.A,{size:"md"})}),o]}),i&&(0,a.jsx)("div",{className:"w-full ".concat({"1/4":"lg:w-1/4","1/5":"lg:w-1/5","1/6":"lg:w-1/6"}[m]," mt-2 lg:mt-0 lg:pl-4 flex flex-row lg:flex-col"),children:(0,a.jsx)("div",{className:"flex flex-row lg:flex-col gap-2 lg:gap-2 pt-1 pb-0 h-full w-full overflow-hidden",children:(0,a.jsx)("div",{className:"flex flex-row lg:flex-col gap-2 lg:gap-2 w-full h-full overflow-y-auto overflow-x-auto lg:overflow-x-hidden [&::-webkit-scrollbar]:w-1.5  [&::-webkit-scrollbar-track]:bg-transparent  [&::-webkit-scrollbar-thumb]:bg-gray-700/40 [&::-webkit-scrollbar-thumb]:rounded-full [&::-webkit-scrollbar-thumb]:hover:bg-gray-600/60 scrollbar-thin scrollbar-track-transparent scrollbar-thumb-gray-700/40",children:i})})})]})]})}},30963:(e,t,r)=>{"use strict";r.d(t,{Kx:()=>c,WH:()=>s,c2:()=>o,it:()=>l,mS:()=>u,s3:()=>d,vv:()=>i,wH:()=>n});var a=r(95155);function l(e){let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}function n(e){let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}function o(e){let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}function s(e){let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}function i(e){let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}function c(e){let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})})}r(12115);let u=e=>{let{className:t}=e;return(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,a.jsx)("path",{d:"M15 3h6v6"}),(0,a.jsx)("path",{d:"M9 21H3v-6"}),(0,a.jsx)("path",{d:"M21 3l-7 7"}),(0,a.jsx)("path",{d:"M3 21l7-7"})]})},d=e=>{let{className:t}=e;return(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,a.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,a.jsx)("polyline",{points:"7 10 12 15 17 10"}),(0,a.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}},37918:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(95155);r(12115);let l={D:"D",M:"M",Q:"Q",Y:"Y",W:"W"},n=function(e){let{value:t,onChange:r,options:n}=e,o=n||["D","M","Q","Y"].map(e=>({value:e,label:l[e]}));return(0,a.jsx)("div",{className:"inline-flex bg-gray-800/40 rounded-md p-0 shadow-inner",children:o.map(e=>(0,a.jsx)("button",{onClick:()=>r(e.value),className:"px-0 py-0.5 text-xs font-medium rounded transition-colors min-w-[25px] ".concat(t===e.value?"bg-gray-800 text-white shadow":"bg-transparent text-gray-400 hover:text-gray-200"),children:e.label},e.value))})}},45191:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var a=r(28749),l=r(95442),n=(0,r(70222).A)("domain","range","reverse","align","padding","round");function o(e){return n(function e(){var t,r,n=(0,l.A)().unknown(void 0),o=n.domain,s=n.range,i=0,c=1,u=!1,d=0,h=0,g=.5;function m(){var e=o().length,a=c<i,l=a?c:i,n=a?i:c;t=(n-l)/Math.max(1,e-d+2*h),u&&(t=Math.floor(t)),l+=(n-l-t*(e-d))*g,r=t*(1-d),u&&(l=Math.round(l),r=Math.round(r));var m=(function(e,t,r){e*=1,t*=1,r=(l=arguments.length)<2?(t=e,e=0,1):l<3?1:+r;for(var a=-1,l=0|Math.max(0,Math.ceil((t-e)/r)),n=Array(l);++a<l;)n[a]=e+a*r;return n})(e).map(function(e){return l+t*e});return s(a?m.reverse():m)}return delete n.unknown,n.domain=function(e){return arguments.length?(o(e),m()):o()},n.range=function(e){return arguments.length?([i,c]=e,i*=1,c*=1,m()):[i,c]},n.rangeRound=function(e){return[i,c]=e,i*=1,c*=1,u=!0,m()},n.bandwidth=function(){return r},n.step=function(){return t},n.round=function(e){return arguments.length?(u=!!e,m()):u},n.padding=function(e){return arguments.length?(d=Math.min(1,h=+e),m()):d},n.paddingInner=function(e){return arguments.length?(d=Math.min(1,e),m()):d},n.paddingOuter=function(e){return arguments.length?(h=+e,m()):h},n.align=function(e){return arguments.length?(g=Math.max(0,Math.min(1,e)),m()):g},n.copy=function(){return e(o(),[i,c]).round(u).paddingInner(d).paddingOuter(h).align(g)},a.C.apply(m(),arguments)}(),e)}},51078:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(95155);r(12115);let l=e=>{let{size:t="sm",className:r=""}=e;return(0,a.jsx)("div",{className:"flex justify-center items-center h-full ".concat(r),children:(0,a.jsx)("div",{className:"\n          animate-spin \n          ".concat({xs:"h-3 w-3 border-[1.5px]",sm:"h-4 w-4 border-[1.5px]",md:"h-5 w-5 border-2"}[t]," \n          border-gray-600/50 \n          rounded-full \n          border-t-transparent\n        ")})})}},74537:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var a=r(12115),l=r(29300),n=r.n(l),o=r(14945),s=r(2758),i=["axisClassName","labelOffset","tickLength","tickLabelProps"];function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e}).apply(this,arguments)}var u={dx:"0.25em",dy:"0.25em",fill:"#222",fontFamily:"Arial",fontSize:10,textAnchor:"start"};function d(e){var t=e.axisClassName,r=e.labelOffset,l=e.tickLength,d=e.tickLabelProps,h=function(e,t){if(null==e)return{};var r,a,l={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||(l[r]=e[r]);return l}(e,i),g="function"==typeof d?d:c({},u,d);return a.createElement(o.A,c({axisClassName:n()("visx-axis-right",t),labelOffset:void 0===r?36:r,orientation:s.A.right,tickLabelProps:g,tickLength:void 0===l?8:l},h))}},78398:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(95442),l=(0,r(70222).A)("domain","range","reverse","unknown");function n(e){return l((0,a.A)(),e)}},78590:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>K});var a=r(95155),l=r(12115),n=r(86009),o=r(30963),s=r(79111),i=r(41995),c=r(50109),u=r(45191),d=r(4904),h=r(72630),g=r(58888),m=r(74537),f=r(76167),v=r(71734),x=r(13600);async function p(e){try{var t,r;let a=await fetch("".concat("https://analytics.topledger.xyz/tl/api","/queries/12459/results?api_key=").concat("MwgPFDxoN9SCpEC6I6nhBH85dtNkXndNYcRtHLYA"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({parameters:{"Date Part":e}})});if(!a.ok)throw Error("API request failed: ".concat(a.status));return((null==(r=(await a.json()).query_result)||null==(t=r.data)?void 0:t.rows)||[]).map(e=>({date:e.block_date||"",tvl:parseFloat(e.TVL||0),velocity:parseFloat(e.Velocity||0)})).filter(e=>e.date)}catch(e){return console.error("Error fetching chart data:",e),[]}}var y=r(51078),b=r(81838),w=r(7545),j=r(52594),k=r(37918),N=r(42028),S=r(6828);let T=e=>{let{className:t="w-4 h-4"}=e;return(0,a.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},L=e=>"$".concat(Math.round(e/1e9),"B"),C=e=>Number.isInteger(e)?e.toString():e.toFixed(1),A=(e,t)=>{try{let r=new Date(e);if(isNaN(r.getTime()))return e;switch(t){case"Y":return r.getFullYear().toString();case"Q":return"Q".concat(Math.floor(r.getMonth()/3)+1," ").concat(r.getFullYear());case"M":return r.toLocaleDateString("en-US",{month:"short",year:"numeric"});default:return r.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}}catch(t){return e}},M=e=>{if(!e||0===e.length)return{tvl:S.Tj[0],velocity:S.Tj[1]};let t=[{name:"tvl",value:e.reduce((e,t)=>e+t.tvl,0)},{name:"velocity",value:e.reduce((e,t)=>e+t.velocity,0)}].sort((e,t)=>t.value-e.value),r={};return t.forEach((e,t)=>{r[e.name]=S.Tj[t%S.Tj.length]}),{tvl:r.tvl,velocity:r.velocity}},E={axisLines:S.h5,tickLabels:S.Dc,grid:S.Vg},D=(e,t)=>e&&0!==e.length?Object.keys(e[0]).filter(e=>"date"!==e).map(e=>{let r={tvl:"TVL",velocity:"Velocity"}[e]||e.charAt(0).toUpperCase()+e.slice(1),a="velocity"===e;return{key:e,displayName:r,shape:a?"circle":"square",color:a?t.velocity:t.tvl}}):[],F=e=>{var t;let{timeFilter:r,isModalOpen:n=!1,onModalClose:o=()=>{}}=e,[F,_]=(0,l.useState)([]),[V,P]=(0,l.useState)(!0),[B,O]=(0,l.useState)(null),[z,W]=(0,l.useState)([]),[Y,R]=(0,l.useState)(null),[X,q]=(0,l.useState)(!1),[U,I]=(0,l.useState)({tvl:S.Tj[0],velocity:S.Tj[1]}),[H,Q]=(0,l.useState)([]),[$,J]=(0,l.useState)(!0),[Z,G]=(0,l.useState)(null),[K,ee]=(0,l.useState)(r),[et,er]=(0,l.useState)(null),[ea,el]=(0,l.useState)(!1),[en,eo]=(0,l.useState)([]),[es,ei]=(0,l.useState)({tvl:S.Tj[0],velocity:S.Tj[1]}),[ec,eu]=(0,l.useState)({visible:!1,dataPoint:null,left:0,top:0}),ed=(0,l.useRef)(null),eh=(0,l.useRef)(null),eg=(0,l.useRef)(null),em=(0,l.useRef)(!0),ef=(0,l.useRef)(null),ev=(0,l.useRef)(!0),ex=(0,l.useCallback)(async()=>{P(!0),O(null);try{let e=await p(r);if(0===e.length)O("No data available for this period."),_([]);else{let t=M(e);I(t),_(e),W(e),q(!0),R(null)}}catch(t){console.error("[Chart] Error loading chart data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),O(e),_([]),W([])}finally{P(!1)}},[r]),ep=(0,l.useCallback)(async()=>{J(!0),G(null);try{let e=await p(K);if(0===e.length)G("No data available for this period."),Q([]),eo([]);else{let t=M(e);ei(t),Q(e),eo(e),el(!0),er(null)}}catch(t){console.error("[Chart] Error loading modal chart data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),G(e),Q([]),eo([])}finally{J(!1)}},[K]);(0,l.useEffect)(()=>{ex()},[ex]);let ey=(0,l.useCallback)(e=>{if(!e){X&&(R(null),q(!1)),eg.current&&(clearTimeout(eg.current),eg.current=null,em.current=!0);return}let{x0:t,x1:r}=e,a=new Date(t),l=new Date(r);!(isNaN(a.getTime())||isNaN(l.getTime()))&&(R([a,l]),X||q(!0))},[X]),eb=(0,l.useCallback)(e=>{if(!e){ea&&(er(null),el(!1)),ef.current&&(clearTimeout(ef.current),ef.current=null,ev.current=!0);return}let{x0:t,x1:r}=e,a=new Date(t),l=new Date(r);!(isNaN(a.getTime())||isNaN(l.getTime()))&&(er([a,l]),ea||el(!0))},[ea]);(0,l.useEffect)(()=>{if(0===F.length){z.length>0&&W([]);return}if(!Y&&X)return void W(F);if(!Y||!X){z.length!==F.length&&W(F);return}if(!em.current)return;let[e,t]=Y,r=e.getTime(),a=t.getTime(),l=F.filter(e=>{let t=new Date(e.date).getTime();return t>=r&&t<=a});W(l.length>0?l:F),em.current=!1,eg.current&&clearTimeout(eg.current),eg.current=setTimeout(()=>{em.current=!0},100)},[Y,F,X]),(0,l.useEffect)(()=>{if(0===H.length){en.length>0&&eo([]);return}if(!et&&ea)return void eo(H);if(!et||!ea){en.length!==H.length&&eo(H);return}if(!ev.current)return;let[e,t]=et,r=e.getTime(),a=t.getTime(),l=H.filter(e=>{let t=new Date(e.date).getTime();return t>=r&&t<=a});eo(l.length>0?l:H),ev.current=!1,ef.current&&clearTimeout(ef.current),ef.current=setTimeout(()=>{ev.current=!0},100)},[et,H,ea]);let ew=(0,l.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("TvlVelocity - Mouse move event",{isModal:t,clientX:e.clientX,clientY:e.clientY});let r=t?eh.current:ed.current;if(!r)return;let a=r.getBoundingClientRect(),l=e.clientX-a.left,n=e.clientY-a.top,o={left:45},s=a.width-o.left-20;if(l<o.left||l>s+o.left){ec.visible&&(console.log("TvlVelocity - Mouse outside chart area, hiding tooltip"),eu(e=>({...e,visible:!1})));return}let i=t?ea?en:H:X?z:F,c=Math.floor((l-o.left)/(s/i.length));if(c>=0&&c<i.length){var u;let e=i[c];ec.visible&&(null==(u=ec.dataPoint)?void 0:u.date)===e.date||(console.log("TvlVelocity - Setting tooltip data",{dataPoint:e,left:l,top:n}),eu({visible:!0,dataPoint:e,left:l,top:n}))}},[F,z,H,en,X,ea,ec.visible,null==(t=ec.dataPoint)?void 0:t.date]),ej=(0,l.useCallback)(()=>{ec.visible&&(console.log("TvlVelocity - Mouse leave, hiding tooltip"),eu(e=>({...e,visible:!1})))},[ec.visible]);(0,l.useEffect)(()=>()=>{eg.current&&clearTimeout(eg.current),ef.current&&clearTimeout(ef.current)},[]),(0,l.useEffect)(()=>{n||ee(r)},[r,n]),(0,l.useEffect)(()=>{n&&(ee(r),F.length>0?(Q(F),eo(F),J(!1),G(null),el(!0),er(null)):ep())},[n,r,F]),(0,l.useEffect)(()=>{n&&ep()},[K,n,ep]);let ek=(0,l.useCallback)(e=>{console.log("Time filter changed to:",e),ee(e)},[]),eN=function(e,t){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=l?K:r,o=l?H:F,p=l?ea?en:H:X?z:F,j=l?$:V,k=l?Z:B,S=l?ea:X,M=l?es:U;return j?(0,a.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,a.jsx)(y.A,{size:"sm"})}):k||0===o.length?(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,a.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:k||"No data available"}),(0,a.jsx)(w.A,{onClick:l?ep:()=>ex(),children:(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(T,{className:"w-3.5 h-3.5"}),(0,a.jsx)("span",{children:"Refresh"})]})})]}):(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[ec.visible&&ec.dataPoint&&(0,a.jsx)(b.A,{title:A(ec.dataPoint.date,n),items:[{color:M.tvl,label:"TVL",value:L(ec.dataPoint.tvl),shape:"square"},{color:M.velocity,label:"Velocity",value:C(ec.dataPoint.velocity),shape:"circle"}],top:ec.top,left:ec.left,isModal:l}),(0,a.jsx)("div",{className:"h-[85%] w-full overflow-hidden relative",onMouseMove:e=>ew(e,l),onMouseLeave:ej,ref:l?eh:ed,children:(0,a.jsx)(s.A,{children:e=>{let{width:t,height:r}=e;if(t<=0||r<=0)return null;let l={top:5,right:25,bottom:30,left:45},o=t-l.left-l.right,s=r-l.top-l.bottom;if(o<=0||s<=0)return null;let y=p.map(e=>new Date(e.date)),b=(0,u.A)({domain:y,range:[0,o],padding:.3}),w=(0,d.A)({domain:[0,1.1*Math.max(...p.map(e=>e.tvl))],range:[s,0],nice:!0}),j=(0,d.A)({domain:[0,1.1*Math.max(...p.map(e=>e.velocity))],range:[s,0],nice:!0});return(0,a.jsx)("svg",{width:t,height:r,className:"overflow-visible",children:(0,a.jsxs)(i.A,{left:l.left,top:l.top,children:[(0,a.jsx)(c.A,{scale:w,width:o,stroke:E.grid,strokeDasharray:"2,3",strokeOpacity:.5,numTicks:5}),S&&(0,a.jsx)("text",{x:0,y:-8,fontSize:8,fill:M.velocity,textAnchor:"start",children:"Filtered: ".concat(p.length," item").concat(1!==p.length?"s":"")}),p.map(e=>{var t;let r=b(new Date(e.date)),l=b.bandwidth(),n=Math.max(0,s-w(e.tvl));return void 0===r||n<0?null:(0,a.jsx)(v.A,{x:r,y:s-n,width:l,height:n,fill:M.tvl,opacity:(null==(t=ec.dataPoint)?void 0:t.date)===e.date?1:.7},"bar-".concat(e.date))}),(0,a.jsx)(x.A,{data:p,x:e=>{var t;return(null!=(t=b(new Date(e.date)))?t:0)+b.bandwidth()/2},y:e=>j(e.velocity),stroke:M.velocity,strokeWidth:1.5,curve:f.G}),(0,a.jsx)(h.A,{top:s,scale:b,tickFormat:e=>{switch(n){case"Y":return e.getFullYear().toString();case"Q":return"Q".concat(Math.floor(e.getMonth()/3)+1);case"M":return e.toLocaleDateString("en-US",{month:"short"});default:return e.toLocaleDateString("en-US",{month:"short",day:"numeric"})}},stroke:E.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,tickLabelProps:(e,t)=>({fill:E.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:0===t?"start":"middle",dy:"0.5em",dx:0===t?"0.5em":0}),numTicks:"Y"===n?F.length:Math.min(5,F.length)}),(0,a.jsx)(g.A,{scale:w,stroke:E.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickFormat:e=>L(Number(e)),tickLabelProps:()=>({fill:E.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"end",dx:"-0.6em",dy:"0.25em"})}),(0,a.jsx)(m.A,{left:o,scale:j,stroke:E.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickFormat:e=>C(Number(e)),tickLabelProps:()=>({fill:E.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"start",dx:"0.5em",dy:"0.25em"})})]})})}})}),(0,a.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,a.jsx)(N.A,{data:l?H:F,isModal:l,activeBrushDomain:l?et:Y,onBrushChange:l?eb:ey,onClearBrush:l?()=>{er(null),el(!1)}:()=>{R(null),q(!1)},getDate:e=>e.date,getValue:e=>e.tvl,lineColor:M.tvl,margin:{top:5,right:25,bottom:10,left:45}})})]})};return(0,a.jsxs)("div",{className:"h-full w-full relative",children:[eN(0,0),(0,a.jsxs)(j.A,{isOpen:n,onClose:o,title:"TVL and Velocity Trends",subtitle:"Tracking value locked and market velocity across the ecosystem",children:[(0,a.jsx)("div",{className:"flex items-center justify-start pl-1 py-0 mb-3",children:(0,a.jsx)(k.A,{value:K,onChange:ek})}),(0,a.jsx)("div",{className:"h-px bg-gray-900 w-full mb-3"}),(0,a.jsx)("div",{className:"h-[60vh]",children:(0,a.jsxs)("div",{className:"flex h-full",children:[(0,a.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:eN(0,0,!0)}),(0,a.jsx)("div",{className:"w-[10%] pl-3",children:(0,a.jsx)("div",{className:"flex flex-col gap-4 pt-4",children:!$&&H.length>0?(0,a.jsx)("div",{className:"flex flex-col gap-2",children:D(H,es).map(e=>(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 mr-2 ".concat("circle"===e.shape?"rounded-full":"rounded-sm"," mt-0.5"),style:{background:e.color}}),(0,a.jsx)("span",{className:"text-[11px] text-gray-300",children:e.displayName})]},e.key))}):(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 bg-blue-500 mr-2 rounded-sm mt-0.5 animate-pulse"}),(0,a.jsx)("span",{className:"text-[11px] text-gray-300",children:"Loading..."})]}),(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 bg-purple-500 mr-2 rounded-full mt-0.5 animate-pulse"}),(0,a.jsx)("span",{className:"text-[11px] text-gray-300",children:"Loading..."})]})]})})})]})})]})]})};var _=r(78398);async function V(e){try{var t,r;let a=await fetch("".concat("https://analytics.topledger.xyz/tl/api","/queries/12439/results?api_key=").concat("zFtRMSKAAC8nTdp6JX2NebxyP6YCct9poXLe5WfN"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({parameters:{"Date Part":e}})});if(!a.ok)throw Error("API request failed: ".concat(a.status));return((null==(r=(await a.json()).query_result)||null==(t=r.data)?void 0:t.rows)||[]).map(e=>({date:e.block_date||"",program_type:e.program_type||"",velocity:parseFloat(e.Velocity||0)})).filter(e=>e.date&&e.program_type)}catch(e){return console.error("Error fetching velocity by DEX data:",e),[]}}function P(e){let t=new Set;return e.forEach(e=>{e.program_type&&t.add(e.program_type)}),Array.from(t)}function B(e){let t=new Set;return e.forEach(e=>{e.date&&t.add(e.date)}),Array.from(t).sort()}let O=e=>{let{className:t="w-4 h-4"}=e;return(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[(0,a.jsx)("path",{d:"M21 2v6h-6"}),(0,a.jsx)("path",{d:"M3 12a9 9 0 0 1 15-6.7L21 8"}),(0,a.jsx)("path",{d:"M3 22v-6h6"}),(0,a.jsx)("path",{d:"M21 12a9 9 0 0 1-15 6.7L3 16"})]})},z=e=>Number.isInteger(e)?e.toString():e.toFixed(1),W=(e,t)=>{try{let r=new Date(e);if(isNaN(r.getTime()))return e;switch(t){case"Y":return r.getFullYear().toString();case"Q":return"Q".concat(Math.floor(r.getMonth()/3)+1," ").concat(r.getFullYear());case"M":return r.toLocaleDateString("en-US",{month:"short",year:"numeric"});default:return r.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}}catch(t){return e}},Y={axisLines:S.h5,tickLabels:S.Dc,grid:S.Vg},R=e=>{let{timeFilter:t,isModalOpen:r=!1,onModalClose:n=()=>{}}=e,[o,m]=(0,l.useState)([]),[v,p]=(0,l.useState)([]),[T,L]=(0,l.useState)(!0),[C,A]=(0,l.useState)(null),[M,E]=(0,l.useState)([]),[D,F]=(0,l.useState)(null),[R,X]=(0,l.useState)(!1),[q,U]=(0,l.useState)({}),[I,H]=(0,l.useState)([]),[Q,$]=(0,l.useState)([]),[J,Z]=(0,l.useState)(!0),[G,K]=(0,l.useState)(null),[ee,et]=(0,l.useState)(t),[er,ea]=(0,l.useState)(null),[el,en]=(0,l.useState)(!1),[eo,es]=(0,l.useState)([]),[ei,ec]=(0,l.useState)({}),[eu,ed]=(0,l.useState)({visible:!1,date:"",velocities:[],left:0,top:0}),eh=(0,l.useRef)(null),eg=(0,l.useRef)(!0),em=(0,l.useRef)(null),ef=(0,l.useRef)(!0),ev=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?(t?ei:q)[e]||(0,S.Vy)(0):S.Tj[9]},ex=(0,l.useCallback)(async()=>{L(!0),A(null);try{let e=await V(t);if(console.log("Fetched ".concat(e.length," data points for main chart with filter ").concat(t)),e.length>0){console.log("Sample data:",e.slice(0,2));let t=P(e);console.log("Program types: ".concat(t.join(", ")));let r={};e.forEach(e=>{r[e.program_type]=(r[e.program_type]||0)+e.velocity});let a=t.map(e=>({name:e,velocity:r[e]||0})).sort((e,t)=>t.velocity-e.velocity).map(e=>e.name),l={};a.forEach((e,t)=>{l[e]=S.Tj[t%S.Tj.length]}),U(l),p(a)}0===e.length?(A("No data available for this period."),m([]),p([])):(m(e),E(e),X(!0),F(null))}catch(t){console.error("[Chart] Error loading chart data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),A(e),m([]),E([]),p([])}finally{L(!1)}},[t]),ep=(0,l.useCallback)(async()=>{Z(!0),K(null);try{let e=await V(ee);if(0===e.length)K("No data available for this period."),H([]),es([]),$([]);else{let t=P(e),r={};e.forEach(e=>{r[e.program_type]=(r[e.program_type]||0)+e.velocity});let a=t.map(e=>({name:e,velocity:r[e]||0})).sort((e,t)=>t.velocity-e.velocity).map(e=>e.name),l={};a.forEach((e,t)=>{l[e]=S.Tj[t%S.Tj.length]}),ec(l),$(a),H(e),es(e),en(!0),ea(null)}}catch(t){console.error("[Chart] Error loading modal chart data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),K(e),H([]),es([]),$([])}finally{Z(!1)}},[ee]);(0,l.useEffect)(()=>{ex()},[ex]),(0,l.useEffect)(()=>{r||et(t)},[t,r]),(0,l.useEffect)(()=>{r&&(et(t),o.length>0?(H(o),es(o),$(v),Z(!1),K(null),en(!0),ea(null)):ep())},[r,t,o]),(0,l.useEffect)(()=>{r&&ep()},[ee,r,ep]);let ey=(0,l.useCallback)(e=>{if(!e){R&&(F(null),X(!1)),eh.current&&(clearTimeout(eh.current),eh.current=null,eg.current=!0);return}let{x0:t,x1:r}=e,a=new Date(t),l=new Date(r);!(isNaN(a.getTime())||isNaN(l.getTime()))&&(F([a,l]),R||X(!0))},[R]),eb=(0,l.useCallback)(e=>{if(!e){el&&(ea(null),en(!1)),em.current&&(clearTimeout(em.current),em.current=null,ef.current=!0);return}let{x0:t,x1:r}=e,a=new Date(t),l=new Date(r);!(isNaN(a.getTime())||isNaN(l.getTime()))&&(ea([a,l]),el||en(!0))},[el]);(0,l.useEffect)(()=>{if(0===o.length){M.length>0&&E([]);return}if(!D&&R)return void E(o);if(!D||!R){M.length!==o.length&&E(o);return}if(!eg.current)return;let[e,t]=D,r=e.getTime(),a=t.getTime(),l=o.filter(e=>{let t=new Date(e.date).getTime();return t>=r&&t<=a});E(l.length>0?l:o),eg.current=!1,eh.current&&clearTimeout(eh.current),eh.current=setTimeout(()=>{eg.current=!0},100)},[D,o,R]),(0,l.useEffect)(()=>{if(0===I.length){eo.length>0&&es([]);return}if(!er&&el)return void es(I);if(!er||!el){eo.length!==I.length&&es(I);return}if(!ef.current)return;let[e,t]=er,r=e.getTime(),a=t.getTime(),l=I.filter(e=>{let t=new Date(e.date).getTime();return t>=r&&t<=a});es(l.length>0?l:I),ef.current=!1,em.current&&clearTimeout(em.current),em.current=setTimeout(()=>{ef.current=!0},100)},[er,I,el]);let ew=(0,l.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("VelocityByDex - Mouse move event",{isModal:t,clientX:e.clientX,clientY:e.clientY});let r=e.currentTarget.getBoundingClientRect(),a=e.clientX-r.left,l=e.clientY-r.top,n={left:45},o=r.width-n.left-20;if(a<n.left||a>o+n.left){eu.visible&&(console.log("VelocityByDex - Mouse outside chart area, hiding tooltip"),ed(e=>({...e,visible:!1})));return}let s=t?eo:M,i=t?Q:v,c=B(s),u=Math.min(Math.floor((a-n.left)/(o/c.length)),c.length-1);if(u>=0&&u<c.length){let e=c[u],t=i.map(t=>{let r=s.find(r=>r.date===e&&r.program_type===t);return{programType:t,velocity:r?r.velocity:0}}).filter(e=>e.velocity>0);t.length>0&&(console.log("VelocityByDex - Setting tooltip data",{date:e,velocities:t,left:a,top:l}),ed({visible:!0,date:e,velocities:t,left:a,top:l}))}},[M,eo,v,Q,eu.visible]),ej=(0,l.useCallback)(()=>{eu.visible&&(console.log("VelocityByDex - Mouse leave, hiding tooltip"),ed(e=>({...e,visible:!1})))},[eu.visible]),ek=(0,l.useCallback)(e=>{console.log("Time filter changed to:",e),et(e)},[]);(0,l.useEffect)(()=>()=>{eh.current&&clearTimeout(eh.current),em.current&&clearTimeout(em.current)},[]);let eN=(0,l.useCallback)(e=>{if(!e||0===e.length)return[];let t=[...new Set(e.map(e=>e.date))].sort(),r=new Set;return e.forEach(e=>r.add(e.program_type)),Array.from(r),t.map(t=>{let r=e.filter(e=>e.date===t).reduce((e,t)=>e+t.velocity,0);return{date:t,value:r}})},[]),eS=function(e,r){let l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=l?ee:t,m=l?I:o,p=l?el?eo:I:R?M:o,j=l?Q:v,k=l?J:T,L=l?G:C,A=l?er:D,E=l?eb:ey,V=l?()=>{ea(null),en(!1)}:()=>{F(null),X(!1)};return k?(0,a.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,a.jsx)(y.A,{size:"sm"})}):L||0===m.length?(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,a.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:L||"No data available"}),(0,a.jsx)(w.A,{onClick:l?ep:()=>ex(),children:(0,a.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,a.jsx)(O,{className:"w-3.5 h-3.5"}),(0,a.jsx)("span",{children:"Refresh"})]})})]}):(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[eu.visible&&eu.date&&(0,a.jsx)(b.A,{title:W(eu.date,n),items:eu.velocities.map(e=>({color:ev(e.programType,l),label:e.programType,value:z(e.velocity),shape:"circle"})),top:eu.top,left:eu.left,isModal:l}),(0,a.jsx)("div",{className:"h-[85%] w-full overflow-hidden",onMouseMove:e=>ew(e,l),onMouseLeave:ej,children:(0,a.jsx)(s.A,{children:e=>{let{width:t,height:r}=e;if(t<=0||r<=0)return null;let o={top:10,right:25,bottom:30,left:45},s=t-o.left-o.right,m=r-o.top-o.bottom;if(s<=0||m<=0)return null;let v=B(p);if(0===v.length)return(0,a.jsx)("svg",{width:t,height:r,className:"overflow-visible",children:(0,a.jsx)("text",{x:t/2,y:r/2,textAnchor:"middle",fill:"#6b7280",fontSize:12,children:"No data available for selected time period"})});let y=v.map(e=>{try{return new Date(e)}catch(t){return console.error("Invalid date:",e),new Date}}),b=(0,u.A)({domain:y,range:[0,s],padding:.3}),w=Math.max(...p.map(e=>e.velocity),1),k=(0,d.A)({domain:[0,1.1*w],range:[m,0],nice:!0});return(0,_.A)({domain:j,range:j.map(e=>ev(e,l))}),(0,a.jsx)("svg",{width:t,height:r,className:"overflow-visible",children:(0,a.jsxs)(i.A,{left:o.left,top:o.top,children:[(0,a.jsx)(c.A,{scale:k,width:s,stroke:Y.grid,strokeDasharray:"2,3",strokeOpacity:.5,numTicks:5}),j.map(e=>{let t=p.filter(t=>t.program_type===e);if(0===t.length)return null;let r=v.map(e=>{let r=t.find(t=>t.date===e);return{date:e,velocity:r?r.velocity:0}});return(0,a.jsx)(x.A,{data:r,x:e=>{var t;return(null!=(t=b(new Date(e.date)))?t:0)+b.bandwidth()/2},y:e=>k(e.velocity),stroke:ev(e,l),strokeWidth:1.5,curve:f.G},"line-".concat(e))}),(0,a.jsx)(h.A,{top:m,scale:b,tickFormat:e=>{switch(n){case"Y":return e.getFullYear().toString();case"Q":return"Q".concat(Math.floor(e.getMonth()/3)+1);case"M":return e.toLocaleDateString("en-US",{month:"short"});default:return e.toLocaleDateString("en-US",{month:"short",day:"numeric"})}},stroke:Y.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,tickLabelProps:(e,t)=>({fill:Y.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:0===t?"start":"middle",dy:"0.5em",dx:0===t?"0.5em":0}),numTicks:Math.min(5,v.length)}),(0,a.jsx)(g.A,{scale:k,stroke:Y.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickFormat:e=>z(Number(e)),tickLabelProps:()=>({fill:Y.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"end",dx:"-0.6em",dy:"0.25em"})})]})})}})}),(0,a.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,a.jsx)(N.A,{data:eN(l?I:o),isModal:l,activeBrushDomain:A,onBrushChange:E,onClearBrush:V,getDate:e=>e.date,getValue:e=>{let t=0;return(l?Q:v).forEach(r=>{t+=e[r]||0}),t},lineColor:S.Tj[0],margin:{top:5,right:40,bottom:10,left:40}})})]})};return(0,a.jsxs)("div",{className:"h-full w-full relative",children:[eS(0,0),(0,a.jsxs)(j.A,{isOpen:r,onClose:n,title:"Velocity By DEX Program Category",subtitle:"Tracking velocity trends across different DEX program types",children:[(0,a.jsx)("div",{className:"flex items-center justify-start pl-1 py-0 mb-3",children:(0,a.jsx)(k.A,{value:ee,onChange:ek})}),(0,a.jsx)("div",{className:"h-px bg-gray-900 w-full mb-3"}),(0,a.jsx)("div",{className:"h-[60vh]",children:(0,a.jsxs)("div",{className:"flex h-full",children:[(0,a.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:eS(0,0,!0)}),(0,a.jsx)("div",{className:"w-[10%] pl-3",children:(0,a.jsx)("div",{className:"flex flex-col gap-5 pt-4",children:(0,a.jsx)("div",{className:"flex flex-col gap-2",children:Q.length>0&&Q.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"w-2.5 h-2.5 mr-2 rounded-sm mt-0.5",style:{background:ev(e,!0)}}),(0,a.jsx)("span",{className:"text-[11px] text-gray-300 truncate",title:e,children:e.length>10?"".concat(e.substring(0,10),"..."):e})]},e))})})})]})})]})]})};var X=r(4566);let q=async()=>{try{var e,t;let r=await fetch("https://analytics.topledger.xyz/tl/api/queries/12435/results.json?api_key=QoHzXXunvuLg0rrTWyFTNzmIjIoqY5MJhHo3ltZg");if(!r.ok)throw Error("Failed to fetch: ".concat(r.status," ").concat(r.statusText));let a=(null==(t=(await r.json()).query_result)||null==(e=t.data)?void 0:e.rows)||[],l=new Map;return a.forEach(e=>{let t=e.block_date;l.has(t)||l.set(t,{date:t,totalTvl:e.daily_total_tvl||e.daily_total_volume,programBreakdown:{}}),l.get(t).programBreakdown[e.program_type]=e.tvl}),Array.from(l.values()).sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())}catch(e){throw console.error("Error fetching TVL data:",e),Error("Failed to fetch TVL data")}},U=async()=>{try{let e=await q();if(e.length<2)return{currentTvl:0,percentChange:0,isPositive:!1};let t=e[0],r=new Date(t.date);r.setDate(r.getDate()-1);let a=e[1];for(let t=1;t<e.length;t++){let l=e[t];if(new Date(l.date)<=r){a=l;break}}let l=t.totalTvl/1e9,n=(t.totalTvl-a.totalTvl)/a.totalTvl*100;return{currentTvl:parseFloat(l.toFixed(2)),percentChange:parseFloat(n.toFixed(2)),isPositive:n>0}}catch(e){return console.error("Error calculating TVL stats:",e),{currentTvl:0,percentChange:0,isPositive:!1}}},I=async()=>{try{var e,t;let r=await fetch("https://analytics.topledger.xyz/tl/api/queries/13181/results.json?api_key=fLzwXGF8j4St6XvrckEAe1gjQRHKveWvvCafx2Zz");if(!r.ok)throw Error("Failed to fetch: ".concat(r.status," ").concat(r.statusText));return((null==(t=(await r.json()).query_result)||null==(e=t.data)?void 0:e.rows)||[]).map(e=>({partition_0:e.partition_0,active_signer:parseInt(e.active_signer),new_signer:parseInt(e.new_signer),new_traders_activation_ratio:parseFloat(e.new_traders_activation_ratio),cumulative_signer:parseInt(e.cumulative_signer)})).sort((e,t)=>new Date(t.partition_0).getTime()-new Date(e.partition_0).getTime())}catch(e){throw console.error("Error fetching traders data:",e),Error("Failed to fetch traders data")}},H=async()=>{try{let e=await I();if(e.length<2)return{cumulativeTraders:0,percentChange:0,isPositive:!1};let t=e[0],r=e[1],a=t.cumulative_signer/1e6,l=(t.cumulative_signer-r.cumulative_signer)/r.cumulative_signer*100;return{cumulativeTraders:a,percentChange:l,isPositive:l>0}}catch(e){return console.error("Error calculating traders stats:",e),{cumulativeTraders:0,percentChange:0,isPositive:!1}}};var Q=r(21903),$=r(96565);let J={tvl:S.Tj[0],velocity:S.Tj[1]},Z=(e,t)=>{let r=t.indexOf(e);return(0,S.Vy)(r)},G=e=>{if(!e||0===e.length)return[];let t=e[0],r={tvl:"TVL",velocity:"Velocity"};return Object.keys(t).filter(e=>"date"!==e).map(e=>{let t=r[e]||e.charAt(0).toUpperCase()+e.slice(1),a="velocity"===e;return{key:e,displayName:t,shape:a?"circle":"square",color:a?J.velocity:J.tvl}})};function K(){var e;let t,r,[s,i]=(0,l.useState)("M"),[c,u]=(0,l.useState)("M"),[d,h]=(0,l.useState)(!1),[g,m]=(0,l.useState)(!1),[f,v]=(0,l.useState)([]),[x,y]=(0,l.useState)(!0),[b,w]=(0,l.useState)([]),[j,N]=(0,l.useState)([]),[S,T]=(0,l.useState)(!0),[L,C]=(0,l.useState)({cumulativeVolume:0,percentChange:0,isPositive:!0}),[A,M]=(0,l.useState)(!0),[E,D]=(0,l.useState)({currentTvl:0,percentChange:0,isPositive:!1}),[_,O]=(0,l.useState)(!0),[z,W]=(0,l.useState)({cumulativeTraders:0,percentChange:0,isPositive:!0}),[Y,q]=(0,l.useState)(!0),[I,J]=(0,l.useState)(!1),[K,ee]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{T(!0);try{let e=await p(s);w(e)}catch(e){console.error("Error fetching TVL velocity data:",e)}finally{T(!1)}})()},[s]),(0,l.useEffect)(()=>{(async()=>{y(!0);try{let e=await V(c);v(P(e)),N(e)}catch(e){console.error("Error fetching DEX velocity data:",e)}finally{y(!1)}})()},[c]),(0,l.useEffect)(()=>{(async()=>{M(!0);try{let e=await (0,X.getLatestVolumeStats)();C(e)}catch(e){console.error("Error fetching volume data:",e)}finally{M(!1)}})()},[]),(0,l.useEffect)(()=>{(async()=>{O(!0);try{console.log("Fetching TVL stats from new implementation...");let e=await U();console.log("TVL stats received:",e),e&&"number"==typeof e.currentTvl?(D(e),console.log("TVL percent change:",e.percentChange)):(console.error("Invalid TVL stats format:",e),D({currentTvl:0,percentChange:0,isPositive:!1}))}catch(e){console.error("Error fetching TVL stats:",e),D({currentTvl:0,percentChange:0,isPositive:!1})}finally{O(!1)}})()},[]),(0,l.useEffect)(()=>{(async()=>{q(!0);try{let e=await H();W(e)}catch(e){console.error("Error fetching traders data:",e)}finally{q(!1)}})()},[]);let et=async()=>{if(!I){J(!0);try{if(0===b.length){console.error("No TVL velocity data available for download");let e=await p(s);if(0===e.length)return void console.error("Failed to fetch TVL velocity data for download");w(e)}let e=b.map(e=>"".concat(e.date,",").concat(e.tvl,",").concat(e.velocity)).join("\n"),t=encodeURI("data:text/csv;charset=utf-8,Date,TVL,Velocity\n"+e),r=document.createElement("a");r.setAttribute("href",t),r.setAttribute("download","tvl-velocity-".concat(s,"-").concat(new Date().toISOString().split("T")[0],".csv")),document.body.appendChild(r),r.click(),document.body.removeChild(r)}catch(e){console.error("Error downloading TVL velocity data:",e)}finally{J(!1)}}},er=async()=>{if(!K){ee(!0);try{if(0===j.length||0===f.length){console.error("No DEX velocity data available for download");let e=await V(c);if(0===e.length)return void console.error("Failed to fetch DEX velocity data for download");N(e),v(P(e))}let e=B(j),t="Date";f.forEach(e=>{t+=",".concat(e)});let r="data:text/csv;charset=utf-8,".concat(t,"\n"),a=e.map(e=>{let t=e;return f.forEach(r=>{let a=j.find(t=>t.date===e&&t.program_type===r);t+=",".concat(a?a.velocity:0)}),t}).join("\n"),l=encodeURI(r+a),n=document.createElement("a");n.setAttribute("href",l),n.setAttribute("download","dex-velocity-".concat(c,"-").concat(new Date().toISOString().split("T")[0],".csv")),document.body.appendChild(n),n.click(),document.body.removeChild(n)}catch(e){console.error("Error downloading DEX velocity data:",e)}finally{ee(!1)}}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,a.jsx)(n.A,{title:"All-time Volume",value:A?"0":(e=L.cumulativeVolume)>=1?"$".concat(e.toFixed(2),"T"):"$".concat((1e3*e).toFixed(2),"B"),trend:A?void 0:{value:parseFloat(L.percentChange.toFixed(1)),label:"vs last year"},icon:(0,a.jsx)(o.it,{}),variant:"indigo",isLoading:A}),(0,a.jsx)(n.A,{title:"Current TVL",value:_?"Loading...":E.currentTvl?(t=E.currentTvl,"$".concat(t.toFixed(2),"B")):"$0.00B",trend:_?void 0:{value:parseFloat(E.percentChange.toFixed(1)),label:"vs last day"},icon:(0,a.jsx)(o.wH,{}),variant:"blue",isLoading:_}),(0,a.jsx)(n.A,{title:"All-time Traders",value:Y?"0":(r=z.cumulativeTraders,"".concat(r.toFixed(1),"M")),trend:Y?void 0:{value:parseFloat(z.percentChange.toFixed(1)),label:"vs last day"},icon:(0,a.jsx)(o.c2,{}),variant:"purple",isLoading:Y})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-4",children:[(0,a.jsx)(Q.A,{title:"TVL and Velocity Trends",description:"Tracking value locked and market velocity across the ecosystem",accentColor:"blue",onExpandClick:()=>h(!0),onDownloadClick:et,isDownloading:I,filterBar:(0,a.jsx)(k.A,{value:s,onChange:i}),legend:!S&&b.length>0?(0,a.jsx)("div",{className:"flex flex-row lg:flex-col gap-4 lg:gap-3",children:G(b).map(e=>(0,a.jsx)($.A,{label:e.displayName,color:e.color,shape:"circle"===e.shape?"circle":"square"},e.key))}):(0,a.jsxs)("div",{className:"flex flex-row lg:flex-col gap-4 lg:gap-3",children:[(0,a.jsx)($.A,{label:"Loading...",color:"#60a5fa",isLoading:!0}),(0,a.jsx)($.A,{label:"Loading...",color:"#a78bfa",shape:"circle",isLoading:!0})]}),children:(0,a.jsx)(F,{timeFilter:s,isModalOpen:d,onModalClose:()=>h(!1)})}),(0,a.jsx)(Q.A,{title:"Velocity By DEX Program Category",description:"Tracking velocity trends across different DEX program types",accentColor:"purple",onExpandClick:()=>m(!0),onDownloadClick:er,isDownloading:K,filterBar:(0,a.jsx)(k.A,{value:c,onChange:u}),legend:!x&&f.length>0?(0,a.jsx)("div",{className:"flex flex-row lg:flex-col gap-4 lg:gap-3",children:f.map((e,t)=>(0,a.jsx)($.A,{label:e,color:Z(e,f),tooltipText:e},e))}):(0,a.jsxs)("div",{className:"flex flex-row lg:flex-col gap-4 lg:gap-3",children:[(0,a.jsx)($.A,{label:"Loading...",color:"#60a5fa",isLoading:!0}),(0,a.jsx)($.A,{label:"Loading...",color:"#a78bfa",isLoading:!0}),(0,a.jsx)($.A,{label:"Loading...",color:"#34d399",isLoading:!0})]}),children:(0,a.jsx)(R,{timeFilter:c,isModalOpen:g,onModalClose:()=>m(!1)})})]})]})}},81838:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(95155);r(12115);let l=e=>{let{type:t,color:r}=e;return"circle"===t?(0,a.jsx)("div",{className:"h-2 w-2 rounded-full mr-1.5",style:{backgroundColor:r}}):(0,a.jsx)("div",{className:"h-2 w-2 rounded-sm mr-1.5",style:{backgroundColor:r}})},n=(e,t)=>{if(/^\d{4}-\d{2}-\d{2}/.test(e)||/^\d{2}\/\d{2}\/\d{4}/.test(e)){let r=new Date(e);if(!isNaN(r.getTime())){if("W"===t)return"Week of ".concat(r.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"}));if("M"===t)return r.toLocaleDateString("en-US",{month:"short",year:"numeric"});if("Q"===t){let e=Math.floor(r.getMonth()/3)+1;return"Q".concat(e,", ").concat(r.getFullYear())}else if("Y"===t)return r.getFullYear().toString();return r.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})}}return/^[A-Za-z]{3}\s\d{4}$/.test(e)||/^Q[1-4]\s\d{4}$/.test(e)||/^\d{4}$/.test(e),e},o=(e,t)=>{if("string"==typeof e){if(t){let r={USD:"$",EUR:"€",GBP:"\xa3",JPY:"\xa5",CNY:"\xa5",SOL:"SOL"},a=r[t]||t;if("SOL"===t){if(e.includes("SOL"))return e;for(let[t,a]of Object.entries(r))if("SOL"!==t&&e.startsWith(a))return"".concat(e.substring(a.length)," SOL");return"".concat(e," SOL")}for(let[l,n]of Object.entries(r))if(e.startsWith(n)&&l!==t)return e.replace(n,a)}return e}if("number"==typeof e){if(t)switch(t){case"USD":return"$".concat(e.toLocaleString());case"EUR":return"€".concat(e.toLocaleString());case"GBP":return"\xa3".concat(e.toLocaleString());case"JPY":case"CNY":return"\xa5".concat(e.toLocaleString());case"SOL":return"".concat(e.toLocaleString()," SOL");default:return"".concat(t).concat(e.toLocaleString())}return e.toLocaleString()}return String(e)},s=e=>{let{title:t,items:r,top:s,left:i,isModal:c=!1,timeFilter:u,currencyFilter:d}=e,h=r.some(e=>e.axis),g=n(t,u);return(0,a.jsxs)("div",{className:"absolute z-10 pointer-events-none bg-gray-900/95 shadow-lg border border-gray-800 rounded-md p-2 text-xs min-w-[120px]",style:{top:"".concat(s,"px"),left:i>(c?500:250)?"".concat(i-160,"px"):"".concat(i+10,"px"),transform:"translateY(-100%)"},children:[(0,a.jsx)("div",{className:"text-gray-400 text-[10px] font-normal pb-1 mb-1 border-b border-gray-800",children:g}),(0,a.jsx)("div",{className:"space-y-1",children:r.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,a.jsx)(l,{type:e.shape||"circle",color:e.color}),(0,a.jsx)("span",{className:"text-gray-400 font-normal ml-2",children:e.label}),h&&e.axis&&(0,a.jsxs)("span",{className:"ml-1 text-[9px] text-gray-500",children:["(",e.axis," axis)"]})]}),(0,a.jsx)("span",{className:"text-gray-300 font-normal ml-4",children:o(e.value,d)})]},"tooltip-item-".concat(t)))})]})}},86009:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(95155),l=r(12115);let n={indigo:{bg:"bg-indigo-500/10",text:"text-indigo-400",shadow:"hover:shadow-indigo-900/20"},blue:{bg:"bg-blue-500/10",text:"text-blue-400",shadow:"hover:shadow-blue-900/20"},purple:{bg:"bg-purple-500/10",text:"text-purple-400",shadow:"hover:shadow-purple-900/20"},emerald:{bg:"bg-emerald-500/10",text:"text-emerald-400",shadow:"hover:shadow-emerald-900/20"},amber:{bg:"bg-amber-500/10",text:"text-amber-400",shadow:"hover:shadow-amber-900/20"},rose:{bg:"bg-rose-500/10",text:"text-rose-400",shadow:"hover:shadow-rose-900/20"}},o=e=>{if(!e)return 0;let t=e.replace(/,/g,"").match(/\$?([\d.]+)([BMT])?/);if(!t)return 0;let r=parseFloat(t[1]);switch(t[2]){case"T":return 1e6*r;case"B":return 1e3*r;default:return r}},s=(e,t)=>{if(t.includes(",")&&!t.includes("$"))return Math.round(e).toLocaleString("en-US");if(t.includes("T"))return"$".concat((e/1e6).toFixed(2),"T");if(t.includes("B"))return"$".concat((e/1e3).toFixed(2),"B");if(t.includes("M"))return"".concat(e.toFixed(1),"M");if(t.includes("%"))return"".concat(e.toFixed(1),"%");else if(!isNaN(Number(t)))return Math.round(e).toString();return e.toString()};function i(e){let{title:t,value:r,trend:i,icon:c,variant:u="indigo",isLoading:d=!1}=e,h=n[u],[g,m]=(0,l.useState)("0"),[f,v]=(0,l.useState)(!1),x=(0,l.useRef)(r),p=(0,l.useRef)(0);return(0,l.useEffect)(()=>{i&&console.log('Counter "'.concat(t,'" trend value:'),i.value,"isLoading:",d)},[t,i,d]),(0,l.useEffect)(()=>{if("Loading..."===r||r===g)return;x.current=r;let e=o(g),t=o(r);if(e===t)return;p.current&&cancelAnimationFrame(p.current),v(!0);let a=performance.now(),l=n=>{let o=Math.min((n-a)/300,1);m(s(e+o*(2-o)*(t-e),r)),o<1?p.current=requestAnimationFrame(l):(m(r),v(!1))};return p.current=requestAnimationFrame(l),()=>{p.current&&cancelAnimationFrame(p.current)}},[r,g]),(0,a.jsxs)("div",{className:"bg-black/80 backdrop-blur-sm p-4 md:p-5 rounded-xl border border-gray-900 shadow-lg ".concat(h.shadow," transition-all duration-300 min-h-[90px]"),children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsx)("h2",{className:"text-xs md:text-sm font-normal text-gray-500",children:t}),(0,a.jsx)("div",{className:"p-1 md:p-1.5 ".concat(h.bg," rounded-md"),children:(0,a.jsx)("div",{className:"".concat(h.text," w-4 h-4 md:w-5 md:h-5"),children:c})})]}),(0,a.jsxs)("div",{className:"mt-1",children:[(0,a.jsx)("div",{className:"text-xl md:text-2xl font-medium text-gray-300 leading-relaxed truncate",children:"Loading..."===r||f?g:r}),i&&(0,a.jsxs)("div",{className:"flex items-center mt-1 text-xs md:text-sm",children:[(0,a.jsxs)("span",{className:"".concat(i.value>=0?"text-green-400":"text-red-400"," flex items-center"),children:[(0,a.jsx)("svg",{className:"w-3 h-3 md:w-3.5 md:h-3.5 mr-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:i.value>=0?"M5 10l7-7m0 0l7 7m-7-7v18":"M19 14l-7 7m0 0l-7-7m7 7V3"})}),Math.abs(i.value),"%"]}),(0,a.jsx)("span",{className:"text-gray-500 ml-1 md:ml-1.5",children:i.label})]})]})]})}},95442:(e,t,r)=>{"use strict";r.d(t,{A:()=>function e(){var t=new a,r=[],l=[],n=s;function i(e){let a=t.get(e);if(void 0===a){if(n!==s)return n;t.set(e,a=r.push(e)-1)}return l[a%l.length]}return i.domain=function(e){if(!arguments.length)return r.slice();for(let l of(r=[],t=new a,e))t.has(l)||t.set(l,r.push(l)-1);return i},i.range=function(e){return arguments.length?(l=Array.from(e),i):l.slice()},i.unknown=function(e){return arguments.length?(n=e,i):n},i.copy=function(){return e(r,l).unknown(n)},o.C.apply(i,arguments),i}});class a extends Map{constructor(e,t=n){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(let[t,r]of e)this.set(t,r)}get(e){return super.get(l(this,e))}has(e){return super.has(l(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},r){let a=t(r);return e.has(a)?e.get(a):(e.set(a,r),r)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},r){let a=t(r);return e.has(a)&&(r=e.get(a),e.delete(a)),r}(this,e))}}function l({_intern:e,_key:t},r){let a=t(r);return e.has(a)?e.get(a):r}function n(e){return null!==e&&"object"==typeof e?e.valueOf():e}var o=r(28749);let s=Symbol("implicit")},96565:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});var a=r(95155);r(12115);let l=e=>{let{label:t,color:r,shape:l="square",isLoading:n=!1,tooltipText:o}=e;return(0,a.jsxs)("div",{className:"flex items-start whitespace-nowrap",children:[(0,a.jsx)("div",{className:"w-2 h-2 mr-2 ".concat("circle"===l?"rounded-full":"rounded-sm"," mt-0.5 ").concat(n?"animate-pulse":""),style:{background:r}}),(0,a.jsx)("span",{className:"text-xs text-gray-300 truncate",title:o||t,children:t.length>20&&!o?"".concat(t.substring(0,20),"..."):t})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[4410,5083,166,1182,5955,4685,8441,1684,7358],()=>t(4588)),_N_E=e.O()}]);