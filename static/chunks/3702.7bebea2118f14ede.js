"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3679,3702],{45191:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(28749),a=n(95442),l=(0,n(70222).A)("domain","range","reverse","align","padding","round");function i(e){return l(function e(){var t,n,l=(0,a.A)().unknown(void 0),i=l.domain,s=l.range,o=0,c=1,u=!1,f=0,h=0,m=.5;function d(){var e=i().length,r=c<o,a=r?c:o,l=r?o:c;t=(l-a)/Math.max(1,e-f+2*h),u&&(t=Math.floor(t)),a+=(l-a-t*(e-f))*m,n=t*(1-f),u&&(a=Math.round(a),n=Math.round(n));var d=(function(e,t,n){e*=1,t*=1,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),l=Array(a);++r<a;)l[r]=e+r*n;return l})(e).map(function(e){return a+t*e});return s(r?d.reverse():d)}return delete l.unknown,l.domain=function(e){return arguments.length?(i(e),d()):i()},l.range=function(e){return arguments.length?([o,c]=e,o*=1,c*=1,d()):[o,c]},l.rangeRound=function(e){return[o,c]=e,o*=1,c*=1,u=!0,d()},l.bandwidth=function(){return n},l.step=function(){return t},l.round=function(e){return arguments.length?(u=!!e,d()):u},l.padding=function(e){return arguments.length?(f=Math.min(1,h=+e),d()):f},l.paddingInner=function(e){return arguments.length?(f=Math.min(1,e),d()):f},l.paddingOuter=function(e){return arguments.length?(h=+e,d()):h},l.align=function(e){return arguments.length?(m=Math.max(0,Math.min(1,e)),d()):m},l.copy=function(){return e(i(),[o,c]).round(u).paddingInner(f).paddingOuter(h).align(m)},r.C.apply(d(),arguments)}(),e)}},81838:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(95155);n(12115);let a=e=>{let{type:t,color:n}=e;return"circle"===t?(0,r.jsx)("div",{className:"h-2 w-2 rounded-full mr-1.5",style:{backgroundColor:n}}):(0,r.jsx)("div",{className:"h-2 w-2 rounded-sm mr-1.5",style:{backgroundColor:n}})},l=(e,t)=>{if(/^\d{4}-\d{2}-\d{2}/.test(e)||/^\d{2}\/\d{2}\/\d{4}/.test(e)){let n=new Date(e);if(!isNaN(n.getTime())){if("W"===t)return"Week of ".concat(n.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"}));if("M"===t)return n.toLocaleDateString("en-US",{month:"short",year:"numeric"});if("Q"===t){let e=Math.floor(n.getMonth()/3)+1;return"Q".concat(e,", ").concat(n.getFullYear())}else if("Y"===t)return n.getFullYear().toString();return n.toLocaleDateString("en-US",{month:"short",day:"2-digit",year:"numeric"})}}return/^[A-Za-z]{3}\s\d{4}$/.test(e)||/^Q[1-4]\s\d{4}$/.test(e)||/^\d{4}$/.test(e),e},i=(e,t)=>{if("string"==typeof e){if(t){let n={USD:"$",EUR:"€",GBP:"\xa3",JPY:"\xa5",CNY:"\xa5",SOL:"SOL"},r=n[t]||t;if("SOL"===t){if(e.includes("SOL"))return e;for(let[t,r]of Object.entries(n))if("SOL"!==t&&e.startsWith(r))return"".concat(e.substring(r.length)," SOL");return"".concat(e," SOL")}for(let[a,l]of Object.entries(n))if(e.startsWith(l)&&a!==t)return e.replace(l,r)}return e}if("number"==typeof e){if(t)switch(t){case"USD":return"$".concat(e.toLocaleString());case"EUR":return"€".concat(e.toLocaleString());case"GBP":return"\xa3".concat(e.toLocaleString());case"JPY":case"CNY":return"\xa5".concat(e.toLocaleString());case"SOL":return"".concat(e.toLocaleString()," SOL");default:return"".concat(t).concat(e.toLocaleString())}return e.toLocaleString()}return String(e)},s=e=>{let{title:t,items:n,top:s,left:o,isModal:c=!1,timeFilter:u,currencyFilter:f}=e,h=n.some(e=>e.axis),m=l(t,u);return(0,r.jsxs)("div",{className:"absolute z-10 pointer-events-none bg-gray-900/95 shadow-lg border border-gray-800 rounded-md p-2 text-xs min-w-[120px]",style:{top:"".concat(s,"px"),left:o>(c?500:250)?"".concat(o-160,"px"):"".concat(o+10,"px"),transform:"translateY(-100%)"},children:[(0,r.jsx)("div",{className:"text-gray-400 text-[10px] font-normal pb-1 mb-1 border-b border-gray-800",children:m}),(0,r.jsx)("div",{className:"space-y-1",children:n.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,r.jsx)(a,{type:e.shape||"circle",color:e.color}),(0,r.jsx)("span",{className:"text-gray-400 font-normal ml-2",children:e.label}),h&&e.axis&&(0,r.jsxs)("span",{className:"ml-1 text-[9px] text-gray-500",children:["(",e.axis," axis)"]})]}),(0,r.jsx)("span",{className:"text-gray-300 font-normal ml-4",children:i(e.value,f)})]},"tooltip-item-".concat(t)))})]})}},83702:(e,t,n)=>{n.r(t),n.d(t,{default:()=>S});var r=n(95155),a=n(12115),l=n(79111),i=n(45191),s=n(4904),o=n(71734),c=n(41995),u=n(72630),f=n(58888),h=n(50109),m=n(51078),d=n(7545),p=n(81838),g=n(52594),x=n(96565),b=n(42028),v=n(93679);let y=e=>{let{className:t="w-4 h-4"}=e;return(0,r.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},S=e=>{let{isModalOpen:t=!1,onModalClose:n=()=>{},legendsChanged:S}=e,[j,w]=(0,a.useState)([]),[N,k]=(0,a.useState)([]),[_,D]=(0,a.useState)([]),[A,L]=(0,a.useState)(!0),[C,M]=(0,a.useState)(null),[U,O]=(0,a.useState)([]),E=(0,a.useRef)(null),P=(0,a.useRef)(null),[T,z]=(0,a.useState)(!1),[F,Y]=(0,a.useState)(null),[W,B]=(0,a.useState)(!1),[G,R]=(0,a.useState)(null),[I,$]=(0,a.useState)({visible:!1,month:"",items:[],left:0,top:0}),q=(0,a.useCallback)(e=>Object.values(e.reduce((e,t)=>(e[t.month]||(e[t.month]={month:t.month,date:t.date||new Date(t.month)}),e[t.month][t.mint_name]=t.p2p_transfers,e),{})).sort((e,t)=>e.date.getTime()-t.date.getTime()),[]),Q=(0,a.useCallback)(async()=>{L(!0),M(null);try{let e=await (0,v.fetchTransactionActivityData)();if(0===e.length)M("No data available for stablecoin P2P transfers."),w([]),k([]),D([]),O([]);else{let t={};e.forEach(e=>{t[e.mint_name]||(t[e.mint_name]=0),t[e.mint_name]+=e.p2p_transfers});let n=Object.entries(t).sort((e,t)=>t[1]-e[1]).map(e=>{let[t]=e;return t});O(n),w(e);let r=q(e);if(k(r),D(r),z(!1),Y(null),S){let e=n.map(e=>({label:e,color:(0,v.G)(e),value:t[e]}));S(e)}}}catch(e){M(e instanceof Error?e.message:"Failed to load data."),w([]),k([]),D([]),O([])}finally{L(!1)}},[S,q]);(0,a.useEffect)(()=>{Q()},[Q]),(0,a.useEffect)(()=>{if(0===N.length){_.length>0&&D([]);return}if(!F&&T)return void D(N);if(!F||!T){_.length!==N.length&&D(N);return}let[e,t]=F,n=N.filter(n=>{let r=n.date instanceof Date?n.date:new Date(n.month);return r>=e&&r<=t});D(n.length>0?n:N)},[F,N,T,_.length]),(0,a.useEffect)(()=>{t&&(R(F),B(T))},[t,F,T]);let Z=(0,a.useCallback)(e=>{if(!e||0===N.length)return N;let[t,n]=e,r=N.filter(e=>{let r=e.date instanceof Date?e.date:new Date(e.month);return r>=t&&r<=n});return r.length>0?r:N},[N]),H=(0,a.useCallback)(function(e){var t;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=null==(t=(n?P:E).current)?void 0:t.getBoundingClientRect();if(!r)return;let a=e.clientX-r.left,l=n?W:T,i=n?G:F,s=l?n?Z(i):_:N;if(0===s.length)return;let o={right:20,left:90},c=(r.width-o.left-o.right)/s.length,u=Math.floor((a-o.left)/c);if(u<0||u>=s.length){I.visible&&$(e=>({...e,visible:!1}));return}let f=s[u];if(!I.visible||I.month!==f.month){let t=U.filter(e=>f[e]>0).map(e=>({mint:e,value:f[e],color:(0,v.G)(e)})).sort((e,t)=>t.value-e.value);$({visible:!0,month:f.month,items:t,left:a,top:e.clientY-r.top})}},[N,_,T,I.visible,I.month,U,W,G,F,Z]),J=(0,a.useCallback)(()=>{I.visible&&$(e=>({...e,visible:!1}))},[I.visible]),V=e=>new Date(e).toLocaleDateString("en-US",{month:"short",year:"numeric"}),X=(0,a.useCallback)(e=>{if(!e){T&&(Y(null),z(!1));return}let{x0:t,x1:n}=e;Y([new Date(t),new Date(n)]),T||z(!0)},[T]),K=(0,a.useCallback)(e=>{if(!e){W&&(R(null),B(!1));return}let{x0:t,x1:n}=e;R([new Date(t),new Date(n)]),W||B(!0)},[W]),ee=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(A)return(0,r.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,r.jsx)(m.A,{size:"sm"})});if(C||0===N.length)return(0,r.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,r.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:C||"No data available"}),(0,r.jsx)(d.A,{onClick:Q,children:(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)(y,{className:"w-3.5 h-3.5"}),(0,r.jsx)("span",{children:"Refresh"})]})})]});let a=n?G:F,g=n?W:T;return(0,r.jsxs)("div",{className:"flex flex-col h-full",children:[I.visible&&I.items.length>0&&(0,r.jsx)(p.A,{title:V(I.month),items:I.items.map(e=>({color:e.color,label:e.mint,value:(0,v.formatNumber)(e.value),shape:"square"})),top:I.top,left:I.left,isModal:n}),(0,r.jsx)("div",{className:"h-[85%] w-full overflow-hidden relative",ref:n?P:E,onMouseMove:e=>H(e,n),onMouseLeave:J,children:(0,r.jsx)(l.A,{children:e=>{let{width:t,height:l}=e;if(t<=0||l<=0)return null;let m={top:10,right:20,bottom:50,left:90},d=t-m.left-m.right,p=l-m.top-m.bottom;if(d<=0||p<=0)return null;let x=g?n?Z(a):_:N,b=(0,i.A)({domain:x.map(e=>e.month),range:[0,d],padding:.2}),y=(()=>{let e=d<500?5:10;if(x.length<=e)return x.map(e=>e.month);{let t=Math.ceil(x.length/(e-1));return x.filter((e,n)=>n%t==0||n===x.length-1).map(e=>e.month)}})(),S=Math.max(...x.map(e=>U.reduce((t,n)=>t+(e[n]||0),0))),j=(0,s.A)({domain:[0,1.1*S],range:[p,0],nice:!0}),w=b.bandwidth();return(0,r.jsx)("svg",{width:t,height:l,children:(0,r.jsxs)(c.A,{left:m.left,top:m.top,children:[(0,r.jsx)(h.A,{scale:j,width:d,stroke:"#1f2937",strokeOpacity:.5,strokeDasharray:"2,3"}),x.map((e,t)=>{let n=b(e.month)||0,a=p,l=[];return U.filter(t=>e[t]>0).sort((t,n)=>e[t]-e[n]).forEach(i=>{let s=p-j(e[i]||0);a-=s,l.push((0,r.jsx)(o.A,{x:n,y:a,width:w,height:s,fill:(0,v.G)(i),opacity:I.month===e.month?1:.8,rx:2},"bar-".concat(t,"-").concat(i)))}),(0,r.jsx)(c.A,{children:l},"month-".concat(t))}),(0,r.jsx)(u.A,{top:p,scale:b,stroke:"#374151",strokeWidth:.5,tickStroke:"transparent",hideAxisLine:!1,tickLength:0,tickValues:y,tickLabelProps:()=>({fill:"#6b7280",fontSize:11,fontWeight:300,textAnchor:"middle",dy:"0.5em"}),tickFormat:e=>new Date(e).toLocaleDateString("en-US",{month:"numeric",year:"2-digit"})}),(0,r.jsx)(f.A,{scale:j,stroke:"#374151",strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,numTicks:5,tickFormat:e=>(0,v.formatNumber)(e),tickLabelProps:()=>({fill:"#6b7280",fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"end",dy:"0.33em",dx:"-0.5em"})})]})})}})}),(0,r.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,r.jsx)(l.A,{children:e=>{let{width:t,height:a}=e;return t<=0||a<=0?null:(0,r.jsx)(b.A,{data:j,isModal:n,activeBrushDomain:n?G:F,onBrushChange:n?K:X,onClearBrush:()=>{n?(R(null),B(!1)):(Y(null),z(!1))},getDate:e=>e.date?e.date.toISOString():e.month,getValue:e=>e.p2p_transfers,lineColor:"#2775ca",margin:{top:5,right:20,bottom:10,left:90}})}})})]})};return(0,r.jsxs)("div",{className:"h-full w-full relative",children:[ee(0,0),(0,r.jsx)(g.A,{isOpen:t,onClose:n,title:"Stablecoin P2P Transfers",subtitle:"Monthly peer-to-peer transfer count of stablecoins on Solana",children:(0,r.jsx)("div",{className:"h-[70vh]",children:(0,r.jsxs)("div",{className:"flex h-full",children:[(0,r.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:ee(0,0,!0)}),(0,r.jsxs)("div",{className:"w-[10%] h-full pl-3 flex flex-col justify-start items-start",children:[(0,r.jsx)("div",{className:"text-[10px] text-gray-400 mb-2",children:"STABLECOINS"}),A?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(x.A,{label:"Loading...",color:"#2775ca",isLoading:!0}),(0,r.jsx)(x.A,{label:"Loading...",color:"#26a17b",isLoading:!0}),(0,r.jsx)(x.A,{label:"Loading...",color:"#fa7a35",isLoading:!0})]}):(0,r.jsx)("div",{className:"flex flex-col gap-1 overflow-y-auto max-h-[500px] pr-1",children:U.map(e=>{let t=j.filter(t=>t.mint_name===e).reduce((e,t)=>e+t.p2p_transfers,0);return(0,r.jsx)(x.A,{label:e,color:(0,v.G)(e),shape:"square",tooltipText:(0,v.formatNumber)(t)},e)})})]})]})})})]})}},93679:(e,t,n)=>{n.d(t,{G:()=>a,fetchTransactionActivityData:()=>i,formatNumber:()=>l});let r={USDC:"#2775ca",USDT:"#26a17b",PYUSD:"#8a2be2",USDe:"#ffa500",EURC:"#4169e1",EUROe:"#007bff",USDY:"#20b2aa",FDUSD:"#ff6347",sUSD:"#ff69b4",USDS:"#4b0082",AUSD:"#8b4513",USDG:"#708090"};function a(e){return r[e]||"#999999"}function l(e){return new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",maximumFractionDigits:1}).format(e)}async function i(){try{let e=await fetch("https://analytics.topledger.xyz/tl/api/queries/12792/results.json?api_key=fD12Ml2PxWabxyFbBlzgubpIx91G20rkN6ADNZXs");if(!e.ok)throw Error("API responded with status: ".concat(e.status));return(await e.json()).query_result.data.rows.map(e=>({month:e.month,mint:e.mint||"",mint_name:e.mint_name||"Unknown",token_supply:Number(e.token_supply)||0,fee_payer:Number(e.fee_payer)||0,p2p_fee_payer:Number(e.p2p_fee_payer)||0,transfers:Number(e.transfers)||0,p2p_transfers:Number(e.p2p_transfers)||0,volume:Number(e.volume)||0,p2p_volume:Number(e.p2p_volume)||0,avg_transfer_size:Number(e.avg_transfer_size)||0,p2p_avg_transfer_size:Number(e.p2p_avg_transfer_size)||0,velocity:Number(e.velocity)||0,p2p_velocity:Number(e.p2p_velocity)||0,program_interacted:Number(e.program_interacted)||0,date:new Date(e.month)})).sort((e,t)=>{let n=new Date(e.month).getTime()-new Date(t.month).getTime();return 0!==n?n:e.mint_name.localeCompare(t.mint_name)})}catch(e){throw console.error("Error fetching transaction activity data:",e),Error("Failed to fetch stablecoin transaction activity data")}}},95442:(e,t,n)=>{n.d(t,{A:()=>function e(){var t=new r,n=[],a=[],l=s;function o(e){let r=t.get(e);if(void 0===r){if(l!==s)return l;t.set(e,r=n.push(e)-1)}return a[r%a.length]}return o.domain=function(e){if(!arguments.length)return n.slice();for(let a of(n=[],t=new r,e))t.has(a)||t.set(a,n.push(a)-1);return o},o.range=function(e){return arguments.length?(a=Array.from(e),o):a.slice()},o.unknown=function(e){return arguments.length?(l=e,o):l},o.copy=function(){return e(n,a).unknown(l)},i.C.apply(o,arguments),o}});class r extends Map{constructor(e,t=l){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(let[t,n]of e)this.set(t,n)}get(e){return super.get(a(this,e))}has(e){return super.has(a(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},n){let r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},n){let r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}(this,e))}}function a({_intern:e,_key:t},n){let r=t(n);return e.has(r)?e.get(r):n}function l(e){return null!==e&&"object"==typeof e?e.valueOf():e}var i=n(28749);let s=Symbol("implicit")}}]);