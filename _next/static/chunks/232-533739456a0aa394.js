"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[232],{1013:(e,t,a)=>{a.d(t,{A:()=>w,_:()=>N});var s=a(5155),n=a(2115),r=a(9111),l=a(1995),o=a(614),c=a(109),i=a(832),u=a(4904),_=a(8888),d=a(4537),h=a(2630),f=a(6167),m=a(1838),p=a(1078),v=a(7545),x=a(2594),g=a(2028);async function b(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"M";try{var t,a;console.log("Fetching transaction data with timeFilter:",e);let s=await fetch("".concat("https://analytics.topledger.xyz/tl/api/queries/13210/results.json","?api_key=").concat("YDy7XJllrBVuLP5gf1Tx5MclZNpS4euKeyli2Lz6"));if(!s.ok)throw Error("API request failed: ".concat(s.status));let n=(null==(a=(await s.json()).query_result)||null==(t=a.data)?void 0:t.rows)||[];if(!n||0===n.length)return console.warn("No transaction data returned from API"),[];let r=n.map(e=>({date:e.block_date,total_transactions:Number(e.Total_Transactions)||0,successful_transactions:Number(e.Succeessful_Transactions)||0,failed_transactions:Number(e.Failed_Transactions)||0,total_vote_transactions:Number(e.Total_Vote_Transactions)||0,total_non_vote_transactions:Number(e.Total_Non_Vote_Transactions)||0,successful_vote_transactions:Number(e.Successful_Vote_Transactions)||0,successful_non_vote_transactions:Number(e.Successful_Non_Vote_Transactions)||0,failed_vote_transactions:Number(e.Failed_Vote_Transactions)||0,failed_non_vote_transactions:Number(e.Failed_Non_Vote_Transactions)||0,successful_transactions_perc:parseFloat(e.Succeesful_Transactions_perc)||0,non_vote_transactions_perc:parseFloat(e.Non_Vote_Transactions_perc)||0,successful_non_vote_transactions_perc:parseFloat(e.Successful_Non_Vote_Transactiosn_perc)||0,total_tps:Number(e.Total_TPS)||0,success_tps:Number(e.Success_TPS)||0,failed_tps:Number(e.Failed_TPS)||0,real_tps:Number(e.Real_TPS)||0,total_fees:Number(e.Total_Fees)||0,non_vote_transactions_fees:Number(e.Non_Vote_Transactions_Fees)||0,vote_transactions_fees:Number(e.Vote_Transactions_Fees)||0,priority_fees:Number(e.Priority_Fees)||0}));return r.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),r}catch(e){return console.error("Error fetching transaction data:",e),[]}}let k=e=>{let{className:t="w-4 h-4"}=e;return(0,s.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},N={total_vote_transactions:"#60a5fa",total_non_vote_transactions:"#a78bfa",successful_transactions_perc:"#34d399",successful_non_vote_transactions_perc:"#f97316",grid:"#1f2937",axisLines:"#374151",tickLabels:"#6b7280"},w=e=>{let{timeFilter:t,displayMode:a="absolute",isModalOpen:w=!1,onModalClose:y=()=>{},onTimeFilterChange:j,onDisplayModeChange:S,chartType:T="all"}=e,[A,L]=(0,n.useState)([]),[C,D]=(0,n.useState)(!0),[F,M]=(0,n.useState)(null),[P,V]=(0,n.useState)([]),[W,E]=(0,n.useState)(null),[R,q]=(0,n.useState)(!1),[O,z]=(0,n.useState)(a),[B,G]=(0,n.useState)([]),[Y,U]=(0,n.useState)(!0),[X,H]=(0,n.useState)(null),[I,K]=(0,n.useState)(t),[Q,Z]=(0,n.useState)(null),[J,$]=(0,n.useState)(!1),[ee,et]=(0,n.useState)([]),[ea,es]=(0,n.useState)(O),[en,er]=(0,n.useState)({visible:!1,dataPoint:null,left:0,top:0}),el=(0,n.useRef)(null),eo=(0,n.useRef)(!0),ec=(0,n.useRef)(null),ei=(0,n.useRef)(!0),eu=(0,n.useCallback)(async()=>{D(!0),M(null);try{console.log("Calling fetchTransactionsData with:",t);let e=await b(t);0===e.length?(console.error("No data available for this period"),M("No data available for this period."),L([])):(console.log("Fetched transaction data:",e),L(e),V(e),q(!0),E(null))}catch(t){console.error("[Chart] Error loading chart data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),M(e),L([]),V([])}finally{D(!1)}},[t]),e_=(0,n.useCallback)(async()=>{U(!0),H(null);try{let e=await b(I);0===e.length?(H("No data available for this period."),G([]),et([])):(G(e),et(e),$(!0),Z(null))}catch(t){console.error("[Chart] Error loading modal chart data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),H(e),G([]),et([])}finally{U(!1)}},[I]);(0,n.useEffect)(()=>{eu()},[eu]),(0,n.useEffect)(()=>{z(a)},[a]),(0,n.useEffect)(()=>{w&&(K(t),es(O),G(A),et(P.length>0?P:A),Z(W),$(R),e_())},[w,t,O,A,P,W,R,e_]),(0,n.useEffect)(()=>{w&&e_()},[w,I,e_]);let ed=(0,n.useCallback)(e=>{if(!e){R&&(E(null),q(!1)),el.current&&(clearTimeout(el.current),el.current=null,eo.current=!0);return}let{x0:t,x1:a}=e,s=new Date(t),n=new Date(a);!(isNaN(s.getTime())||isNaN(n.getTime()))&&(E([s,n]),R||q(!0))},[R]),eh=(0,n.useCallback)(e=>{if(!e){J&&(Z(null),$(!1)),ec.current&&(clearTimeout(ec.current),ec.current=null,ei.current=!0);return}let{x0:t,x1:a}=e,s=new Date(t),n=new Date(a);!(isNaN(s.getTime())||isNaN(n.getTime()))&&(Z([s,n]),J||$(!0))},[J]);(0,n.useEffect)(()=>{if(0===A.length){P.length>0&&V([]);return}if(!W&&R)return void V(A);if(!W||!R){P.length!==A.length&&V(A);return}if(!eo.current)return;let[e,t]=W,a=e.getTime(),s=t.getTime(),n=A.filter(e=>{let t=new Date(e.date).getTime();return t>=a&&t<=s});V(n.length>0?n:A),eo.current=!1,el.current&&clearTimeout(el.current),el.current=setTimeout(()=>{eo.current=!0},100)},[W,A,R]),(0,n.useEffect)(()=>{if(0===B.length){ee.length>0&&et([]);return}if(!Q&&J)return void et(B);if(!Q||!J){ee.length!==B.length&&et(B);return}if(!ei.current)return;let[e,t]=Q,a=e.getTime(),s=t.getTime(),n=B.filter(e=>{let t=new Date(e.date).getTime();return t>=a&&t<=s});et(n.length>0?n:B),ei.current=!1,ec.current&&clearTimeout(ec.current),ec.current=setTimeout(()=>{ei.current=!0},100)},[Q,B,J]);let ef=(0,n.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=t?ee:P;if(!a||0===a.length)return;let s=e.currentTarget.querySelector("svg");if(!s)return;let n=s.getBoundingClientRect(),r={right:50,left:50},l=e.clientX-n.left-r.left,o=Math.min(Math.max(0,Math.floor(l/(n.width-r.left-r.right)*a.length)),a.length-1);er({visible:!0,dataPoint:a[o],left:e.clientX,top:e.clientY})},[P,ee]),em=(0,n.useCallback)(()=>{er(e=>({...e,visible:!1}))},[]);(0,n.useCallback)(e=>{K(e),j&&j(e)},[j]),(0,n.useCallback)(e=>{es(e)},[]);let ep=e=>e>=1e9?"".concat((e/1e9).toFixed(1),"B"):e>=1e6?"".concat((e/1e6).toFixed(1),"M"):e>=1e3?"".concat((e/1e3).toFixed(1),"K"):e.toFixed(0),ev=e=>"".concat(Math.round(e),"%"),ex=e=>new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),eg=function(e,a){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],x=n?I:t,b=n?B:A,w=n?J?ee:B:R?P:A,y=n?Y:C,j=n?X:F,S=n?Q:W,L=n?eh:ed,D=n?()=>{Z(null),$(!1)}:()=>{E(null),q(!1)};return y?(0,s.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,s.jsx)(p.A,{size:"sm"})}):j||0===b.length?(0,s.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,s.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:j||"No data available"}),(0,s.jsx)(v.A,{onClick:n?e_:()=>eu(),children:(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(k,{className:"w-3.5 h-3.5"}),(0,s.jsx)("span",{children:"Refresh"})]})})]}):(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[en.visible&&en.dataPoint&&(0,s.jsx)(m.A,{title:ex(en.dataPoint.date),items:eb(en.dataPoint),top:en.top-(n?50:240),left:en.left-(n?50:240),isModal:n}),(0,s.jsx)("div",{className:"h-[85%] w-full overflow-hidden",onMouseMove:e=>ef(e,n),onMouseLeave:em,children:(0,s.jsx)(r.A,{children:e=>{var t,a;let{width:n,height:r}=e;if(n<=0||r<=0)return null;let m={top:5,right:25,bottom:30,left:45},p=n-m.left-m.right,v=r-m.top-m.bottom;if(p<=0||v<=0)return null;console.log("Display data length:",w.length);let g=(0,i.A)({domain:[new Date((null==(t=w[0])?void 0:t.date)||new Date),new Date((null==(a=w[w.length-1])?void 0:a.date)||new Date)],range:[0,p]}),b="volume"===T||"all"===T||"success-volume"===T,k="success-rate"===T||"all"===T||"success-volume"===T,y="tps"===T,j=b?Math.max(...w.map(e=>Math.max(e.total_vote_transactions,e.total_non_vote_transactions))):0,S=(0,u.A)({domain:[0,1.1*j],range:[v,0],nice:!0,round:!1}),A=Array.from({length:8},(e,t)=>1.1*j*t/7),L=(0,u.A)({domain:[0,100],range:[v,0],nice:!0,round:!1}),C=Array.from({length:8},(e,t)=>100*t/7),D=y?Math.max(...w.map(e=>Math.max(e.total_tps,e.success_tps,e.failed_tps,e.real_tps))):0,F=(0,u.A)({domain:[0,1.1*D],range:[v,0],nice:!0,round:!1}),M=Array.from({length:8},(e,t)=>1.1*D*t/7);return(0,s.jsx)("svg",{width:n,height:r,children:(0,s.jsxs)(l.A,{left:m.left,top:m.top,children:[(0,s.jsx)(c.A,{scale:S,width:p,height:v,stroke:N.grid,strokeOpacity:.6,strokeDasharray:"2,3",tickValues:b?A:y?M:C}),b&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{data:w,x:e=>g(new Date(e.date)),y:e=>S(e.total_vote_transactions),stroke:N.total_vote_transactions,strokeWidth:1.5,curve:f.G}),(0,s.jsx)(o.A,{data:w,x:e=>g(new Date(e.date)),y:e=>S(e.total_non_vote_transactions),stroke:N.total_non_vote_transactions,strokeWidth:1.5,curve:f.G})]}),k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{data:w,x:e=>g(new Date(e.date)),y:e=>L(e.successful_transactions_perc),stroke:N.successful_transactions_perc,strokeWidth:1.5,curve:f.G}),(0,s.jsx)(o.A,{data:w,x:e=>g(new Date(e.date)),y:e=>L(e.successful_non_vote_transactions_perc),stroke:N.successful_non_vote_transactions_perc,strokeWidth:1.5,curve:f.G})]}),y&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.A,{data:w,x:e=>g(new Date(e.date)),y:e=>F(e.total_tps),stroke:"#60a5fa",strokeWidth:1.5,curve:f.G}),(0,s.jsx)(o.A,{data:w,x:e=>g(new Date(e.date)),y:e=>F(e.success_tps),stroke:"#34d399",strokeWidth:1.5,curve:f.G}),(0,s.jsx)(o.A,{data:w,x:e=>g(new Date(e.date)),y:e=>F(e.failed_tps),stroke:"#f43f5e",strokeWidth:1.5,curve:f.G}),(0,s.jsx)(o.A,{data:w,x:e=>g(new Date(e.date)),y:e=>F(e.real_tps),stroke:"#a78bfa",strokeWidth:1.5,curve:f.G})]}),b&&(0,s.jsx)(_.A,{scale:S,left:0,tickFormat:e=>ep(e),stroke:N.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickLabelProps:()=>({fill:N.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"end",dx:"-0.6em",dy:"0.25em"})}),k&&(0,s.jsx)(d.A,{scale:L,left:p,tickFormat:e=>"".concat(e,"%"),stroke:N.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickLabelProps:()=>({fill:N.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"start",dx:"0.5em",dy:"0.25em"})}),y&&(0,s.jsx)(_.A,{scale:F,left:0,tickFormat:e=>ep(e),stroke:N.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickLabelProps:()=>({fill:N.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"end",dx:"-0.6em",dy:"0.25em"})}),(0,s.jsx)(h.A,{top:v,scale:g,tickFormat:e=>{switch(x){case"Y":return e.getFullYear().toString();case"Q":return"Q".concat(Math.floor(e.getMonth()/3)+1);case"M":return e.toLocaleDateString("en-US",{month:"short"});default:return e.toLocaleDateString("en-US",{month:"short",day:"numeric"})}},stroke:N.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,numTicks:Math.min(5,w.length),tickLabelProps:(e,t)=>({fill:N.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"middle",dy:"0.7em"})})]})})}})}),(0,s.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,s.jsx)(g.A,{data:b,isModal:n,activeBrushDomain:S,onBrushChange:L,onClearBrush:D,getDate:e=>e.date,getValue:e=>"tps"===T?e.total_tps:"success-rate"===T?e.successful_transactions_perc:e.total_vote_transactions+e.total_non_vote_transactions,lineColor:N.total_vote_transactions,margin:{top:5,right:25,bottom:10,left:45}})})]})},eb=e=>{let t=[];return("volume"===T||"all"===T)&&t.push({color:N.total_vote_transactions,label:"Vote Transactions",value:ep(e.total_vote_transactions),shape:"square"},{color:N.total_non_vote_transactions,label:"Non-Vote Transactions",value:ep(e.total_non_vote_transactions),shape:"square"}),("success-rate"===T||"all"===T)&&t.push({color:N.successful_transactions_perc,label:"Success Rate",value:ev(e.successful_transactions_perc),shape:"circle"},{color:N.successful_non_vote_transactions_perc,label:"Non-Vote Success Rate",value:ev(e.successful_non_vote_transactions_perc),shape:"circle"}),"success-volume"===T&&t.push({color:N.successful_transactions_perc,label:"Success Rate",value:ev(e.successful_transactions_perc),shape:"circle"},{color:N.successful_non_vote_transactions_perc,label:"Non-Vote Success Rate",value:ev(e.successful_non_vote_transactions_perc),shape:"circle"},{color:N.total_vote_transactions,label:"Vote Transactions",value:ep(e.total_vote_transactions),shape:"square"},{color:N.total_non_vote_transactions,label:"Non-Vote Transactions",value:ep(e.total_non_vote_transactions),shape:"square"}),"tps"===T&&t.push({color:"#60a5fa",label:"Total TPS",value:ep(e.total_tps),shape:"square"},{color:"#34d399",label:"Success TPS",value:ep(e.success_tps),shape:"square"},{color:"#f43f5e",label:"Failed TPS",value:ep(e.failed_tps),shape:"square"},{color:"#a78bfa",label:"Real TPS",value:ep(e.real_tps),shape:"square"}),t};return(0,s.jsxs)("div",{className:"relative h-full",children:[eg(0,0),(0,s.jsx)(x.A,{isOpen:w,onClose:y,title:"Transaction Metrics",subtitle:"".concat("volume"===T?"Volume Metrics":"success-rate"===T?"Success Rate Metrics":"success-volume"===T?"Success Rate and Volume Metrics":"tps"===T?"TPS Metrics":"Transaction Metrics"),children:(0,s.jsx)("div",{className:"h-[60vh]",children:(0,s.jsxs)("div",{className:"flex h-full",children:[(0,s.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:eg(0,0,!0)}),(0,s.jsx)("div",{className:"w-[10%] h-full pl-3 flex flex-col justify-start items-start",children:eb({date:"",total_transactions:0,successful_transactions:0,failed_transactions:0,total_vote_transactions:0,total_non_vote_transactions:0,successful_vote_transactions:0,successful_non_vote_transactions:0,failed_vote_transactions:0,failed_non_vote_transactions:0,successful_transactions_perc:0,non_vote_transactions_perc:0,successful_non_vote_transactions_perc:0,total_tps:0,success_tps:0,failed_tps:0,real_tps:0,total_fees:0,non_vote_transactions_fees:0,vote_transactions_fees:0,priority_fees:0}).map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center mb-1.5",children:[(0,s.jsx)("div",{className:"w-2.5 h-2.5 mr-1.5 ".concat("circle"===e.shape?"rounded-full":"rounded-sm"),style:{backgroundColor:e.color}}),(0,s.jsx)("span",{className:"text-[11px] text-gray-300",children:e.label})]},t))})]})})})]})}},4537:(e,t,a)=>{a.d(t,{A:()=>_});var s=a(2115),n=a(9300),r=a.n(n),l=a(4945),o=a(2758),c=["axisClassName","labelOffset","tickLength","tickLabelProps"];function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e}).apply(this,arguments)}var u={dx:"0.25em",dy:"0.25em",fill:"#222",fontFamily:"Arial",fontSize:10,textAnchor:"start"};function _(e){var t=e.axisClassName,a=e.labelOffset,n=e.tickLength,_=e.tickLabelProps,d=function(e,t){if(null==e)return{};var a,s,n={},r=Object.keys(e);for(s=0;s<r.length;s++)a=r[s],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,c),h="function"==typeof _?_:i({},u,_);return s.createElement(l.A,i({axisClassName:r()("visx-axis-right",t),labelOffset:void 0===a?36:a,orientation:o.A.right,tickLabelProps:h,tickLength:void 0===n?8:n},d))}},5204:(e,t,a)=>{a.d(t,{A:()=>n});var s=a(5155);a(2115);let n=e=>{let{mode:t,onChange:a,isCompact:n=!1}=e;return(0,s.jsxs)("div",{className:"flex items-center",children:[!n&&(0,s.jsx)("span",{className:"text-xs text-gray-400 mr-2",children:"View:"}),(0,s.jsxs)("div",{className:"flex space-x-1 bg-gray-900/60 rounded-md p-0.5",children:[(0,s.jsx)("button",{className:"text-xs px-2 py-0.5 rounded ".concat("absolute"===t?"bg-gray-800 text-white shadow":"text-gray-400 hover:text-gray-300"),onClick:()=>a("absolute"),title:"Chart View",children:(0,s.jsxs)("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("rect",{x:"3",y:"3",width:"4",height:"18",rx:"1",fill:"currentColor"}),(0,s.jsx)("rect",{x:"10",y:"8",width:"4",height:"13",rx:"1",fill:"currentColor"}),(0,s.jsx)("rect",{x:"17",y:"5",width:"4",height:"16",rx:"1",fill:"currentColor"})]})}),(0,s.jsx)("button",{className:"text-xs px-2 py-0.5 rounded ".concat("percent"===t?"bg-gray-800 text-white shadow":"text-gray-400 hover:text-gray-300"),onClick:()=>a("percent"),title:"Percent View",children:"%"})]})]})}}}]);