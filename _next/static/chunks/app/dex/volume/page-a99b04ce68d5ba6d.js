(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[683],{1751:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>M});var n=l(5155),a=l(2115),r=l(9111),i=l(1995),s=l(109),o=l(5191),u=l(4904),c=l(2630),d=l(8888),h=l(1734);async function m(e){try{var t,l;console.log("fetchVolumeHistoryData called with timeFilter:",e);let n=await fetch("".concat("https://analytics.topledger.xyz/tl/api","/queries/").concat("13192","/results?api_key=").concat("PSDSE4K3HsoXJX8a3dgeps4GF1ilSejrVjmkF8Fe"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({parameters:{"Date Part":e}})});if(!n.ok)throw Error("API request failed: ".concat(n.status));let a=(null==(l=(await n.json()).query_result)||null==(t=l.data)?void 0:t.rows)||[];if(!a||0===a.length)return console.warn("No volume history rows returned from API for filter:",e),[];let r=a.map(e=>({date:e.period_start||e.dt||"",volume:parseFloat(e.Volume||e.volume||0)})).filter(e=>e.date);return r.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime()),console.log("Transformed ".concat(r.length," data points")),r}catch(e){return console.error("Error fetching volume history data:",e),[]}}function f(e){return e>=1e9?"$".concat((e/1e9).toFixed(1),"B"):e>=1e6?"$".concat((e/1e6).toFixed(1),"M"):e>=1e3?"$".concat((e/1e3).toFixed(1),"K"):"$".concat(e.toFixed(0))}function g(e,t){try{let l=new Date(e);if(isNaN(l.getTime()))return e;switch(t){case"Q":return"Q".concat(Math.floor(l.getUTCMonth()/3)+1," ").concat(l.getUTCFullYear());case"M":return l.toLocaleDateString("en-US",{month:"short",year:"numeric",timeZone:"UTC"});default:return l.toLocaleDateString("en-US",{month:"short",day:"numeric",timeZone:"UTC"})}}catch(t){return console.error("Error formatting date:",t),e}}var v=l(1078),x=l(1838),p=l(7545),b=l(2594),j=l(7918),y=l(2028);let w=e=>{let{className:t="w-4 h-4"}=e;return(0,n.jsx)("svg",{className:t,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})},k={volumeBar:"#60a5fa",grid:"#374151",axisLines:"#374151",tickLabels:"#9ca3af"},N=e=>{var t;let{timeFilter:l,isModalOpen:N=!1,onModalClose:S=()=>{}}=e,[M,C]=(0,a.useState)([]),[T,A]=(0,a.useState)(!0),[D,F]=(0,a.useState)(null),[P,E]=(0,a.useState)([]),[L,O]=(0,a.useState)(null),[B,V]=(0,a.useState)(!1),[_,H]=(0,a.useState)([]),[W,R]=(0,a.useState)(!0),[X,I]=(0,a.useState)(null),[Q,U]=(0,a.useState)(l),[z,Y]=(0,a.useState)(null),[q,$]=(0,a.useState)(!1),[Z,J]=(0,a.useState)([]),[K,G]=(0,a.useState)({visible:!1,dataPoint:null,left:0,top:0}),ee=(0,a.useRef)(null),et=(0,a.useRef)(!0),el=(0,a.useRef)(null),en=(0,a.useRef)(!0),ea=(0,a.useCallback)(async()=>{A(!0),F(null);try{let e=await m(l);0===e.length?(F("No data available for this period."),C([])):(C(e),E(e),V(!0),O(null))}catch(t){console.error("[Chart] Error loading chart data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),F(e),C([]),E([])}finally{A(!1)}},[l]),er=(0,a.useCallback)(async()=>{R(!0),I(null);try{let e=await m(Q);0===e.length?(I("No data available for this period."),H([]),J([])):(H(e),J(e),$(!0),Y(null))}catch(t){console.error("[Chart] Error loading modal chart data:",t);let e="Failed to load data.";t instanceof Error&&(e=t.message||e),I(e),H([]),J([])}finally{R(!1)}},[Q]);(0,a.useEffect)(()=>{ea()},[ea]),(0,a.useMemo)(()=>M.map(e=>({...e,dateObj:new Date(e.date)})),[M]);let ei=(0,a.useCallback)(e=>{if(!e){B&&(O(null),V(!1),E(M)),ee.current&&(clearTimeout(ee.current),ee.current=null,et.current=!0);return}let{x0:t,x1:l}=e,n=new Date(t),a=new Date(l);!(isNaN(n.getTime())||isNaN(a.getTime()))&&(O([n,a]),B||V(!0),et.current&&(et.current=!1,E(M.filter(e=>{let t=new Date(e.date);return t>=n&&t<=a})),ee.current=setTimeout(()=>{et.current=!0,ee.current=null},100)))},[B,M]),es=(0,a.useCallback)(e=>{if(!e){q&&(Y(null),$(!1),J(_)),el.current&&(clearTimeout(el.current),el.current=null,en.current=!0);return}let{x0:t,x1:l}=e,n=new Date(t),a=new Date(l);!(isNaN(n.getTime())||isNaN(a.getTime()))&&(Y([n,a]),q||$(!0),en.current&&(en.current=!1,J(_.filter(e=>{let t=new Date(e.date);return t>=n&&t<=a})),el.current=setTimeout(()=>{en.current=!0,el.current=null},100)))},[q,_]),eo=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("VolumeHistory - Mouse move event",{isModal:t,clientX:e.clientX,clientY:e.clientY});let l=e.currentTarget.getBoundingClientRect(),n=e.clientX-l.left,a={left:45},r=l.width-a.left-20;if(n<a.left||n>r+a.left){K.visible&&(console.log("VolumeHistory - Mouse outside chart area, hiding tooltip"),G(e=>({...e,visible:!1})));return}let i=t?q?Z:_:B?P:M,s=Math.floor((n-a.left)/(r/i.length));if(s>=0&&s<i.length){var o;let t=i[s];K.visible&&(null==(o=K.dataPoint)?void 0:o.date)===t.date||(console.log("VolumeHistory - Setting tooltip data",{dataPoint:t,left:e.clientX,top:e.clientY}),G({visible:!0,dataPoint:t,left:e.clientX,top:e.clientY}))}},[M,P,_,Z,B,q,K.visible,null==(t=K.dataPoint)?void 0:t.date]),eu=(0,a.useCallback)(()=>{K.visible&&(console.log("VolumeHistory - Mouse leave, hiding tooltip"),G(e=>({...e,visible:!1})))},[K.visible]);(0,a.useEffect)(()=>{N&&(U(l),H(M),J(P),Y(L),$(B),0===M.length&&er())},[N,l,M,P,L,B,er]);let ec=(0,a.useCallback)(e=>{console.log("Time filter changed to:",e),U(e)},[]),ed=function(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],m=a?Q:l,b=a?_:M,j=a?q?Z:_:B?P:M,N=a?W:T,S=a?X:D,C=a?q:B;return N?(0,n.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,n.jsx)(v.A,{size:"sm"})}):S||0===b.length?(0,n.jsxs)("div",{className:"flex flex-col justify-center items-center h-full",children:[(0,n.jsx)("div",{className:"text-gray-400/80 text-xs mb-2",children:S||"No data available"}),(0,n.jsx)(p.A,{onClick:a?er:()=>ea(),children:(0,n.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,n.jsx)(w,{className:"w-3.5 h-3.5"}),(0,n.jsx)("span",{children:"Refresh"})]})})]}):(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[K.visible&&K.dataPoint&&(0,n.jsx)(x.A,{title:g(K.dataPoint.date,m),items:[{color:k.volumeBar,label:"Volume",value:f(K.dataPoint.volume),shape:"square"}],top:K.top-(a?50:240),left:K.left-(a?50:240),isModal:a}),(0,n.jsx)("div",{className:"h-[85%] w-full overflow-hidden",onMouseMove:e=>eo(e,a),onMouseLeave:eu,children:(0,n.jsx)(r.A,{children:e=>{let{width:t,height:l}=e;if(t<=0||l<=0)return null;let a={top:5,right:25,bottom:30,left:45},r=t-a.left-a.right,v=l-a.top-a.bottom;if(r<=0||v<=0)return null;let x=j.map(e=>new Date(e.date)),p=(0,o.A)({domain:x,range:[0,r],padding:.3}),b=(0,u.A)({domain:[0,1.1*Math.max(...j.map(e=>e.volume))||1],range:[v,0],nice:!0});return(0,n.jsx)("svg",{width:t,height:l,className:"overflow-visible",children:(0,n.jsxs)(i.A,{left:a.left,top:a.top,children:[(0,n.jsx)(s.A,{scale:b,width:r,stroke:k.grid,strokeDasharray:"2,3",strokeOpacity:.5,numTicks:5}),C&&(0,n.jsx)("text",{x:0,y:-8,fontSize:8,fill:k.volumeBar,textAnchor:"start",children:"Filtered: ".concat(j.length," item").concat(1!==j.length?"s":"")}),j.map(e=>{var t;let l=p(new Date(e.date)),a=p.bandwidth(),r=Math.max(0,v-b(e.volume));return void 0===l||r<0?null:(0,n.jsx)(h.A,{x:l,y:v-r,width:a,height:r,fill:k.volumeBar,opacity:(null==(t=K.dataPoint)?void 0:t.date)===e.date?1:.7,rx:2},"bar-".concat(e.date))}),(0,n.jsx)(c.A,{top:v,scale:p,tickFormat:e=>g(e.toISOString(),m),stroke:k.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,hideZero:!0,tickLabelProps:(e,t)=>({fill:k.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:0===t?"start":"middle",dy:"0.5em",dx:0===t?"0.5em":0}),numTicks:Math.min(6,j.length)}),(0,n.jsx)(d.A,{scale:b,stroke:k.axisLines,strokeWidth:.5,tickStroke:"transparent",tickLength:0,numTicks:5,tickFormat:e=>f(e),tickLabelProps:()=>({fill:k.tickLabels,fontSize:11,fontWeight:300,letterSpacing:"0.05em",textAnchor:"end",dx:"-0.6em",dy:"0.25em"})})]})})}})}),(0,n.jsx)("div",{className:"h-[15%] w-full mt-1",children:(0,n.jsx)(y.A,{data:a?_:M,isModal:a,activeBrushDomain:a?z:L,onBrushChange:a?es:ei,onClearBrush:a?()=>{Y(null),$(!1)}:()=>{O(null),V(!1)},getDate:e=>e.date,getValue:e=>e.volume,lineColor:k.volumeBar,margin:{top:5,right:25,bottom:10,left:45}})})]})};return(0,n.jsxs)("div",{className:"h-full w-full relative",children:[ed(0,0),(0,n.jsxs)(b.A,{isOpen:N,onClose:S,title:"Trading Volume History",subtitle:"Tracking trading volume trends across the Solana ecosystem",children:[(0,n.jsx)("div",{className:"flex items-center justify-start pl-1 py-0 mb-3",children:(0,n.jsx)(j.A,{value:Q,onChange:e=>ec(e),options:[{value:"W",label:"W"},{value:"M",label:"M"},{value:"Q",label:"Q"}]})}),(0,n.jsx)("div",{className:"h-px bg-gray-900 w-full mb-3"}),(0,n.jsx)("div",{className:"h-[60vh]",children:(0,n.jsxs)("div",{className:"flex h-full",children:[(0,n.jsx)("div",{className:"w-[90%] h-full pr-3 border-r border-gray-900",children:ed(0,0,!0)}),(0,n.jsxs)("div",{className:"w-[10%] h-full pl-3 flex flex-col justify-start items-start",children:[(0,n.jsx)("div",{className:"text-[10px] text-gray-400 mb-2",children:"METRICS"}),(0,n.jsxs)("div",{className:"flex items-center mb-1.5",children:[(0,n.jsx)("div",{className:"w-2.5 h-2.5 rounded-sm mr-1.5",style:{backgroundColor:k.volumeBar}}),(0,n.jsx)("span",{className:"text-[11px] text-gray-300",children:"Volume"})]})]})]})})]})]})};var S=l(963);function M(){let[e,t]=(0,a.useState)("W"),[l,r]=(0,a.useState)(!1);return(0,n.jsx)("div",{className:"space-y-6",children:(0,n.jsxs)("div",{className:"bg-black/80 backdrop-blur-sm p-4 rounded-xl border border-gray-900 shadow-lg hover:shadow-blue-900/20 transition-all duration-300",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,n.jsxs)("div",{className:"-mt-1",children:[(0,n.jsx)("h2",{className:"text-[12px] font-normal text-gray-300 leading-tight mb-0.5",children:"Trading Volume History"}),(0,n.jsx)("p",{className:"text-gray-500 text-[10px] tracking-wide",children:"Tracking trading volume trends across the Solana ecosystem"})]}),(0,n.jsx)("div",{className:"flex space-x-2",children:(0,n.jsx)("button",{className:"p-1.5 bg-blue-500/10 rounded-md text-blue-400 hover:bg-blue-500/20 transition-colors",onClick:()=>r(!0),title:"Expand Chart",children:(0,n.jsx)(S.mS,{className:"w-4 h-4"})})})]}),(0,n.jsx)("div",{className:"h-px bg-gray-900 w-full"}),(0,n.jsx)("div",{className:"flex items-center justify-start pl-1 py-2 overflow-x-auto",children:(0,n.jsx)(j.A,{value:e,onChange:e=>t(e),options:[{value:"W",label:"W"},{value:"M",label:"M"},{value:"Q",label:"Q"}]})}),(0,n.jsx)("div",{className:"h-px bg-gray-900 w-full mb-3"}),(0,n.jsx)("div",{className:"h-80",children:(0,n.jsx)(N,{timeFilter:e,isModalOpen:l,onModalClose:()=>r(!1)})})]})})}},5165:(e,t,l)=>{Promise.resolve().then(l.bind(l,1751))},5191:(e,t,l)=>{"use strict";l.d(t,{A:()=>i});var n=l(8749),a=l(5442),r=(0,l(222).A)("domain","range","reverse","align","padding","round");function i(e){return r(function e(){var t,l,r=(0,a.A)().unknown(void 0),i=r.domain,s=r.range,o=0,u=1,c=!1,d=0,h=0,m=.5;function f(){var e=i().length,n=u<o,a=n?u:o,r=n?o:u;t=(r-a)/Math.max(1,e-d+2*h),c&&(t=Math.floor(t)),a+=(r-a-t*(e-d))*m,l=t*(1-d),c&&(a=Math.round(a),l=Math.round(l));var f=(function(e,t,l){e*=1,t*=1,l=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+l;for(var n=-1,a=0|Math.max(0,Math.ceil((t-e)/l)),r=Array(a);++n<a;)r[n]=e+n*l;return r})(e).map(function(e){return a+t*e});return s(n?f.reverse():f)}return delete r.unknown,r.domain=function(e){return arguments.length?(i(e),f()):i()},r.range=function(e){return arguments.length?([o,u]=e,o*=1,u*=1,f()):[o,u]},r.rangeRound=function(e){return[o,u]=e,o*=1,u*=1,c=!0,f()},r.bandwidth=function(){return l},r.step=function(){return t},r.round=function(e){return arguments.length?(c=!!e,f()):c},r.padding=function(e){return arguments.length?(d=Math.min(1,h=+e),f()):d},r.paddingInner=function(e){return arguments.length?(d=Math.min(1,e),f()):d},r.paddingOuter=function(e){return arguments.length?(h=+e,f()):h},r.align=function(e){return arguments.length?(m=Math.max(0,Math.min(1,e)),f()):m},r.copy=function(){return e(i(),[o,u]).round(c).paddingInner(d).paddingOuter(h).align(m)},n.C.apply(f(),arguments)}(),e)}},5442:(e,t,l)=>{"use strict";l.d(t,{A:()=>function e(){var t=new n,l=[],a=[],r=s;function o(e){let n=t.get(e);if(void 0===n){if(r!==s)return r;t.set(e,n=l.push(e)-1)}return a[n%a.length]}return o.domain=function(e){if(!arguments.length)return l.slice();for(let a of(l=[],t=new n,e))t.has(a)||t.set(a,l.push(a)-1);return o},o.range=function(e){return arguments.length?(a=Array.from(e),o):a.slice()},o.unknown=function(e){return arguments.length?(r=e,o):r},o.copy=function(){return e(l,a).unknown(r)},i.C.apply(o,arguments),o}});class n extends Map{constructor(e,t=r){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(let[t,l]of e)this.set(t,l)}get(e){return super.get(a(this,e))}has(e){return super.has(a(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},l){let n=t(l);return e.has(n)?e.get(n):(e.set(n,l),l)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},l){let n=t(l);return e.has(n)&&(l=e.get(n),e.delete(n)),l}(this,e))}}function a({_intern:e,_key:t},l){let n=t(l);return e.has(n)?e.get(n):l}function r(e){return null!==e&&"object"==typeof e?e.valueOf():e}var i=l(8749);let s=Symbol("implicit")}},e=>{var t=t=>e(e.s=t);e.O(0,[659,948,441,684,358],()=>t(5165)),_N_E=e.O()}]);